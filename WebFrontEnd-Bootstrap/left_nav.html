<script src="js/pwdwidget.js" type="text/javascript"></script>
<link rel="stylesheet" href="css/sweetalert2.css" >
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"> 
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header" style="border:0px solid red;">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="index.html"><span style="color:#0096d6"> <strong>Raxak Protect</strong> &trade;</span><br>
    </a>
  </div>
  <!-- Top Menu Items -->
  <ul class="nav navbar-right top-nav">
    <!--<li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-envelope"></i><b class="caret"></b></a>
    <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bell"></i><b class="caret"></b></a>
        <ul class="dropdown-menu alert-dropdown">
            <li> <a href="#">Alert Name <span class="label label-default">Alert Badge</span></a> </li>
            <li> <a href="#">Alert Name <span class="label label-primary">Alert Badge</span></a> </li>
            <li> <a href="#">Alert Name <span class="label label-success">Alert Badge</span></a> </li>
            <li> <a href="#">Alert Name <span class="label label-info">Alert Badge</span></a> </li>
            <li> <a href="#">Alert Name <span class="label label-warning">Alert Badge</span></a> </li>
            <li> <a href="#">Alert Name <span class="label label-danger">Alert Badge</span></a> </li>
            <li class="divider"></li>
            <li> <a href="#">View All</a> </li>
        </ul>
    </li>-->
    <li><a href="stepbystephelp.html"  class="fa fa-question-circle" target="_blank"> <span style="font-family: &quot;Open Sans&quot;,sans-serif;"> &nbsp;Help</span></a></li>
    <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span id="authenticator">Local</span> <span id="username"></span> <b class="caret"></b> </a>
      <ul class="dropdown-menu">
        <!--<li> <i class="fa fa-fw fa-key"></i><span id="authenticator">Local</span></li>-->
        <!--                <li> <a href="#"><i class="fa fa-fw fa-user"></i> Profile</a> </li>
                        <li> <a href="#"><i class="fa fa-fw fa-gear"></i> Settings</a> </li>
                        <li class="divider"></li>-->
        <li><a id="loginhistory" href="#" data-toggle="modal"><i class="fa fa-history"></i>Login History</a></li>
        <!--<li><a href="#customsetup" data-toggle="modal"><i class="fa fa-pencil"></i> Custom Setup</a></li>-->
        <li><a href="javascript:void(0);" onclick="customsetup();"><i class="fa fa-pencil"></i>Custom Setup</a></li>
        <li><a href="profile_details.html"><i class="fa fa-user"></i>Profile Details</a></li>
        <li id="reset_hide"><a href="#resetpassword" data-toggle="modal" onclick="onclickResetpasswordvalue();"><i class="fa fa-key"></i>Reset Password</a></li>
        <li><a href="#feedback" data-toggle="modal"><i class="fa fa-comment"></i>Feedback</a></li>
        <!--<li><a href="#createticket" data-toggle="modal"><i class="fa fa-ticket"></i>Create Ticket</a></li>-->
        <li><a href="../raxakapi/v1/logout/"><i class="fa fa-fw fa-power-off"></i>Log Out</a> </li>
      </ul>
    </li>
  </ul>
  <!-- Sidebar Menu Items - These collapse to the responsive navigation menu on small screens -->
  <div class="collapse navbar-collapse navbar-ex1-collapse">
    <ul class="nav navbar-nav side-nav" id="nav">
      <li id="home-button" class="button"> <a href="raxak.html" class="button"><i class="fa fa-fw fa-dashboard"></i> <div> Dashboard</div></a> </li>
      <li  id="select-button" class="button"> <a href="select_profile.html" class="button"><i class="fa fa-fw fa-cogs"></i>
          <div>Manage Profile</div></a> </li>
      <li  id="server-button" class="button"> <a href="enrolled_servers.html"  class="button"><i class="fa fa-fw fa-server"></i> <div>Manage Servers</div></a> </li>
      <li id="apply-button" class="button"> <a href="apply_profile.html"   class="button" ><i class="fa fa-fw fa-refresh fa-pin"></i><div> Apply Profile</div></a> </li>
      <li id="schedule-button" class="button"> <a href="Schedule.html"   class="button"><i class="fa fa-fw fa-clock-o"></i><div>Manage Schedule</div></a> </li>
      <li id="rules-button" class="button"> <a href="rules.html"   class="button"><i class="fa fa-fw fa-clone"></i><div> Server Status</div></a> </li>
      <li id="report-button" class="button"> <a href="report_log.html"   class="button"><img src="images/report.png" width="40" height="40" />
          <div>Reports</div></a> </li>
      <li id="graph-button" class="button"> <a href="graph.html"   class="button"><i class="fa fa-bar-chart-o"></i>&nbsp;<div>Graphs</div></a> </li>
      <li style="padding:14px 17px;"><i class="fa fa-fw fa-history"></i> <span style="margin-left: -15px ! important;">Version:<br> <span id="version">Release/build</span></span> </li>
      <li class="divider" style="width:100%;">
        <hr>
      </li>
      <li style="margin-top: -20px; margin-bottom:50px;"> <a href="http://www.cloudraxak.com" target="_blank"><img class="img-responsive" style="max-width:75%" src="images/crlogo-white.png"/></a> </li>
    </ul>
  </div>
  <!-- /.navbar-collapse --> 
</nav>
<div class="modal fade" id="customsetup" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"> <i class="fa fa-times fa-fw"></i> </button>
        <h4 class="modal-title" id="myModalLabel">Raxak Protect Setup Script</h4>
      </div>
      <div class="modal-body"> 
        
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="row">
              <div class="col-md-4"><label  for="name"> Username :<span class="redText">*</span> </label></div>
              <div class="col-md-7">
                <input class="form-control" type="text" id="customusername" name="customusername" maxlength="20">
                <span class="redText" id="custom_error_message"></span><div style="clear:both"></div>
                <!--<label for="enroll">(Username for the server to be provisioned/enrolled)</label>-->
                <span class="vmsetuptext">Username for the server to be provisioned/enrolled</span>
              </div>
              <div class="clear" style="height:20px;"></div>
              <div class="row"  style="padding-left: 10px;">
                <span style="position: absolute"><input type="checkbox" id="customenroll" name="customenroll"></span>
                <label for="enroll" style="padding-left: 23px;">Automatically Enroll Server (Only for servers with a public IP) </label>
              </div>
              <div class="clear" style="height:20px;"></div>
              <div class="row" id="customenrollcontent" style="display:none;">
                <div class="col-md-4"> <label for="df">Select Profile :<span class="redText">*</span></label></div>
                <div class="col-md-7">
                  <select style="display: flex;" id="customprofile" class="form-control">
                    <option value="None">Select</option>
                  </select>
                </div>
                <div class="clear" style="height:20px;"></div>
                <div id="cremedationcontent" style="display:none;">
                  <div class="col-md-4">  <label for="nickname">Remediation Mode :</label></div>
                  <div class="col-md-7">
                    <div class="form-group">
                      <label style="padding-left: 0px;"> 
                        <input type="radio" value="automatic" id="customremidiateautomatic" name="customsetupremediation">
                        <span class="label_span">Automatic</span>
                      </label>
                      <label style="padding-left:10px;">
                        <input type="radio" checked="checked" value="manual" id="customremidiatemanual" name="customsetupremediation">
                        <span class="label_span">Manual</span>
                      </label>
                    </div>
                  </div>
                  <div class="clearfix" style="height:10px;"></div>
                  <div class="col-md-4"> <label for="f">Compliance Frequency :</label></div>
                  <div class="col-md-7"> <select style="display: flex;" id="customcroninterval" class="form-control">
                      <option value="Once">&nbsp;One time</option>
                      <option value="Hourly">&nbsp;Hourly</option>
                      <option value="Daily">&nbsp;Daily</option>
                      <option value="Weekly">&nbsp;Weekly</option>
                      <option value="Monthly">&nbsp;Monthly</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="clearfix"></div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-default" title="Download" onclick="addCustomSetUp();">Download<i class="fa fa-download"></i></button>
        <button type="submit" class="btn btn-default" data-dismiss="modal" aria-hidden="true">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="loginmodal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"> <i class="fa fa-times fa-fw"></i> </button>
        <h4 class="modal-title" id="myModalLabel">Login History</h4>
      </div>
      <div class="modal-body">
        <div id="loginmodalcontent"></div>
      </div>
    </div>
  </div>
</div>
<!--Reset password model box-->

<div class="modal fade" id="resetpassword" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header" Onclick="onclickResetpasswordvalue();">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"> <i class="fa fa-times fa-fw"></i> </button>
        <h4 class="modal-title" id="myModalLabel">Reset Password</h4>
      </div>
      <div class="modal-body"><span class="redText" id="reset_error_message" style="margin-left:22px;"></span>
        <div class="col-lg-12 text-left">
          <div class="form-group" style="margin-bottom:0px !important">
            <!--<p  style="font-size: 12px; line-height: 15px; margin-bottom:18px;">You may now reset your new password.</p>-->
            <div class="col-lg-12">
              <label>Old Password</label>
              <input type="password" class="form-control" placeholder="Old Password" id="old_password"><br/>
		      <div id="old_msg" class="redText" style="margin-top: -22px;"></div>
            </div>
            <div class="col-lg-12">
              <div class='para'>
            <div style="clear:both"></div>
              <div colass="col-md-4"> <label for='regpwd'>New Password: <div style="position: relative; float: right; margin: -5px 0px 0px 10px;">
                                                        <span style="cursor: pointer; font-size: 18px;">
                                                            <i id="blah" title="• At least eight characters long.
• Does not contain your user name, real name, or company name.
• Should contain 1 lower case + 1 upper case + 1 number + 1 special character." rel="tooltip" class="fa fa-question-circle"></i>
                                                        </span>
                                                    </div></label></Div>
                <div class='pwdwidgetdiv' id='thepwddiv'></div>
                <script  type="text/javascript" >
                  var pwdwidget = new PasswordWidget('thepwddiv', 'regpwd');
                  pwdwidget.MakePWDWidget();
                </script>
                <noscript>
                <div>
                  <input type='password' id='newpassword' name='regpwd'  class="form-control"/>
                </div>
                </noscript>
              </div>
              <div style="clear:both"></div>
		      <div id="new_msg" class="redText" style="position:relative;"></div>
            </div>
            <div class="col-lg-12">
              <label>Re-enter Password</label>
              <input type="password" class="form-control" placeholder="Re-enter Password" id="reenterpassword">
		      <div id="reenter_msg" class="redText"></div>
            </div>
            <div class="clear" style="height: 10px ! important;" ></div>
          </div>
        </div>
        <div class="clear" style="height: 2px ! important;" ></div>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-default" Onclick="ResetPassword();mask_hide();">Submit</button>
        <button type="submit" class="btn btn-default" data-dismiss="modal" aria-hidden="true" Onclick="onclickResetpasswordvalue();">Close</button>
      </div>
    </div>
  </div>
</div>
<div aria-hidden="false" aria-labelledby="basicModal" role="dialog" tabindex="-1" id="createticket" class="modal fade in">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header" onclick="CancelHideTicket();">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"><i class="fa fa-times fa-fw"></i></button>
        <h4 id="myModalLabel" class="modal-title">Create Ticket</h4>
      </div>

      <div class="modal-body"><span class="redText" id="ticket_error_message" style="margin-left:200px;"></span>
        <div class="form-group">
          <div class="col-lg-4">
            <label>Issue type <span class="redText">*</span></label>
          </div>
          <div class="col-lg-8">
            <select class="form-control" id="issueid" style="display: flex;">
              <option  value="">Select issue</option>
              <option  value="1">Issue 1</option>
              <option  value="2">Issue 2</option>
            </select>
          </div>
          <div class="clear"></div>
          <div class="col-lg-4">
            <label>Issue title <span class="redText">*</span></label>
          </div>
          <div class="col-lg-8">
            <input type="text" placeholder="Issue title"  class="form-control" id="titleid">
          </div>
          <div class="clear"></div>
          <div class="col-lg-4">
            <label>Specific VM / group <span class="redText">*</span></label>
          </div>
          <div class="col-lg-8">
            <input type="text" placeholder="Specific VM or group"  class="form-control" id="vmid">
          </div>
          <div class="clear"></div>
          <div class="col-lg-4">
            <label>Issue description <span class="redText">*</span></label>
          </div>
          <div class="col-lg-8">
            <textarea rows="3" class="form-control" id="descid" placeholder="Description"></textarea>
          </div>

          <div class="clearfix"></div>

        </div>
      </div>
      <div class="modal-footer">
        <button title="Add User" class="btn btn-default" type="submit" id="createticketid" onclick="CreateTicket();">Submit</button>
        <button class="btn btn-default" type="reset" onclick="CancelHideTicket();">Close</button>
      </div>

    </div>
  </div>
</div>
<div aria-hidden="false" aria-labelledby="basicModal" role="dialog" tabindex="-1" id="feedback" class="modal fade in">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header" onclick="CancelHide();">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"><i class="fa fa-times fa-fw"></i></button>
        <h4 id="myModalLabel" class="modal-title">Feedback</h4>
      </div>
      <div class="modal-body">
        <div class="form-group"> 
          <div class="col-lg-2">
            <label>Feedback :</label>
          </div>
          <div class="col-lg-10">
            <input type="hidden" name="hidden_value" id="username1" />
            <textarea rows="10" class="form-control" placeholder="Your Feedback" name="feedback" id="feedbackmsg"></textarea><span class="redText" id="feedback_error_message" ></span>
          </div>

          <div class="clearfix"></div>

        </div>
      </div>
      <div class="modal-footer">
        <button title="Add User" class="btn btn-default" type="submit" onclick="feedback();">Submit</button>
        <button class="btn btn-default" type="reset" onclick="CancelHide();">Close</button>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript" src="js/sweetalert2.min.js"></script>
<script type="text/javascript">
  var email;
  var regExp = /\((.+?)\)/;

  $(document).on("click", "#loginhistory", function () {
      try {
          email = JSON.parse(sessionStorage.getItem("logged_user"))["email"];
      } catch (e) {
          email = $("#username").html().toString();
      }
      var url = "../raxakapi/v1/getLoginHistory/" + email;
      $.ajax({
          method: "GET",
          url: url,
          success: function (data) {
              $("#loginmodalcontent").html(data);
              var platform = regExp.exec(navigator.userAgent)[1].toString().split(";")[1].trim();
              var browser = getBrowser();

              $(".datetime").each(function (idx) {
                  if (platform == $(this).siblings(".platform").text()
                          && browser == $(this).siblings(".browser").text()) {
                      $(this).html("<font color='green'>Current</font>");
                      var curhtml = $(this).parent('.history-row').clone();
                      $(this).parent('.history-row').remove();
                      $("#loginmodalcontent tbody").prepend(curhtml);
                      platform = browser = null;
                  } else {
                      $(this).replaceWith(new Date($(this).text().trim()).toLocaleString());
                  }
              });
              $("loginmodalcontent");
              $("#loginmodal").modal("show");
          },
          error: function () {
              console.log("History error");
          }
      });
  });

  $(function () {
      getUserDetail();
      var strHref = window.location.href;
      var strQueryString = strHref.split(".html");
      var aQueryString = strQueryString[0].split("/");
      var curpage = unescape(aQueryString[aQueryString.length - 1]).toLowerCase();
      $("#nav").children(function () {
          if ($(this).hasClass("active")) {
              $(this).removeClass("active");
          }
      });

      if (curpage == "raxak" || curpage == "") {
          $("#home-button").addClass("active");
      }

      if (curpage == "enrolled_servers") {
          $("#server-button").addClass("active");
      }

      if (curpage == "select_profile") {
          $("#select-button").addClass("active");
      }

      if (curpage == "apply_profile") {
          $("#apply-button").addClass("active");
      }

      if (curpage == "report_log") {
          $("#report-button").addClass("active");
      }

      if (curpage == "command_line_interface") {
          $("#cli-button").addClass("active");
      }

      if (curpage == "schedule") {
          $("#schedule-button").addClass("active");
      }

      if (curpage == "rules") {
          $("#rules-button").addClass("active");
      }
      if (curpage == "graph") {
          $("#graph-button").addClass("active");
      }

      $('#customremidiateautomatic').click(function () {
          if ($(this).is(':checked')) {
              $("#customcroninterval").prop("disabled", false);
          }
      });

      $('#customremidiatemanual').on('click', function () {
          if ($(this).is(':checked')) {
              $("#customcroninterval").prop('selectedIndex', 0);
              $("#customcroninterval").prop("disabled", true);
          }
      });
  });
</script>
