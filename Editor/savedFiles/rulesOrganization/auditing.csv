"Auditing (36 rules)","","","","","","","","","","",""
"Audit Attempts to Alter Time:","","","","","","","","","","",""
"V-38522","low","The audit system must be configured to audit all attempts to alter system time through settimeofday.","Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.","None","SV-50323r3_rule","F-43470r2_fix","On a 32-bit system, add the following to ""/etc/audit/audit.rules"": 

# audit_time_rules
-a always,exit -F arch=b32 -S settimeofday -k audit_time_rules

On a 64-bit system, add the following to ""/etc/audit/audit.rules"": 

# audit_time_rules
-a always,exit -F arch=b64 -S settimeofday -k audit_time_rules

The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls: 

-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules","C-46080r2_chk","To determine if the system is configured to audit calls to the ""settimeofday"" system call, run the following command:

$ sudo grep -w ""settimeofday"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line. 

If the system is not configured to audit time changes, this is a finding. ","all five can be parameterized into one rule",""
"V-38525","low","The audit system must be configured to audit all attempts to alter system time through stime.","Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.","None","SV-50326r4_rule","F-43473r4_fix","On a 32-bit system, add the following to ""/etc/audit/audit.rules"": 

# audit_time_rules
-a always,exit -F arch=b32 -S stime -k audit_time_rules

On a 64-bit system, the ""-S stime"" is not necessary. The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls: 

-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules","C-46083r3_chk","If the system is 64-bit only, this is not applicable.

To determine if the system is configured to audit calls to the ""stime"" system call, run the following command:

$ sudo grep -w ""stime"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line. 

If the system is not configured to audit time changes, this is a finding. ","",""
"V-38527","low","The audit system must be configured to audit all attempts to alter system time through clock_settime.","Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.","None","SV-50328r3_rule","F-43475r2_fix","On a 32-bit system, add the following to ""/etc/audit/audit.rules"": 

# audit_time_rules
-a always,exit -F arch=b32 -S clock_settime -k audit_time_rules

On a 64-bit system, add the following to ""/etc/audit/audit.rules"": 

# audit_time_rules
-a always,exit -F arch=b64 -S clock_settime -k audit_time_rules

The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls: 

-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules","C-46085r2_chk","To determine if the system is configured to audit calls to the ""clock_settime"" system call, run the following command:

$ sudo grep -w ""clock_settime"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line. 

If the system is not configured to audit time changes, this is a finding. ","",""
"V-38530","low","The audit system must be configured to audit all attempts to alter system time through /etc/localtime.","Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.","None","SV-50331r1_rule","F-43477r1_fix","Add the following to ""/etc/audit/audit.rules"": 

-w /etc/localtime -p wa -k audit_time_rules

The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport and should always be used.","C-46087r1_chk","To determine if the system is configured to audit attempts to alter time via the /etc/localtime file, run the following command: 

# auditctl -l | grep ""watch=/etc/localtime""

If the system is configured to audit this activity, it will return a line. 
If the system is not configured to audit time changes, this is a finding.","",""
"V-38635","low","The audit system must be configured to audit all attempts to alter system time through adjtimex.","Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.","None","SV-50436r3_rule","F-43584r2_fix","On a 32-bit system, add the following to ""/etc/audit/audit.rules"": 

# audit_time_rules
-a always,exit -F arch=b32 -S adjtimex -k audit_time_rules

On a 64-bit system, add the following to ""/etc/audit/audit.rules"": 

# audit_time_rules
-a always,exit -F arch=b64 -S adjtimex -k audit_time_rules

The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls: 

-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules","C-46194r2_chk","To determine if the system is configured to audit calls to the ""adjtimex"" system call, run the following command:

$ sudo grep -w ""adjtimex"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line. 

If the system is not configured to audit time changes, this is a finding.","",""
"File System","","","","","","","","","","",""
"V-38566","low","The audit system must be configured to audit failed attempts to access files and programs.","Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.","None","SV-50367r2_rule","F-43514r2_fix","At a minimum, the audit system should collect unauthorized file accesses for all users and root. Add the following to ""/etc/audit/audit.rules"", setting ARCH to either b32 or b64 as appropriate for your system: 

-a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
-S ftruncate -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access
-a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
-S ftruncate -F exit=-EPERM -F auid>=500 -F auid!=4294967295 -k access
-a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
-S ftruncate -F exit=-EACCES -F auid=0 -k access
-a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \
-S ftruncate -F exit=-EPERM -F auid=0 -k access","C-46124r1_chk","To verify that the audit system collects unauthorized file accesses, run the following commands: 

# grep EACCES /etc/audit/audit.rules



# grep EPERM /etc/audit/audit.rules


If either command lacks output, this is a finding.","",""
"V-38567","low","The audit system must be configured to audit all use of setuid and setgid programs.","Privileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.","None","SV-50368r4_rule","F-43515r6_fix","At a minimum, the audit system should collect the execution of privileged commands for all users and root. To find the relevant setuid / setgid programs, run the following command for each local partition [PART]:

$ sudo find [PART] -xdev -type f -perm /6000 2>/dev/null

Then, for each setuid / setgid program on the system, add a line of the following form to ""/etc/audit/audit.rules"", where [SETUID_PROG_PATH] is the full path to each setuid / setgid program in the list:

-a always,exit -F path=[SETUID_PROG_PATH] -F perm=x -F auid>=500 -F auid!=4294967295 -k privileged","C-46125r7_chk","To verify that auditing of privileged command use is configured, run the following command once for each local partition [PART] to find relevant setuid / setgid programs:

$ sudo find [PART] -xdev -type f -perm /6000 2>/dev/null

Run the following command to verify entries in the audit rules for all programs found with the previous command:

$ sudo grep path /etc/audit/audit.rules

It should be the case that all relevant setuid / setgid programs have a line in the audit rules. If that is not the case, this is a finding. ","",""
"V-38568","low","The audit system must be configured to audit successful file system mounts.","The unauthorized exportation of data to external media could result in an information leak where classified information, Privacy Act information, and intellectual property could be lost. An audit trail should be created each time a filesystem is mounted to help identify and guard against information loss.","None","SV-50369r3_rule","F-43516r2_fix","At a minimum, the audit system should collect media exportation events for all users and root. Add the following to ""/etc/audit/audit.rules"", setting ARCH to either b32 or b64 as appropriate for your system: 

-a always,exit -F arch=ARCH -S mount -F auid>=500 -F auid!=4294967295 -k export
-a always,exit -F arch=ARCH -S mount -F auid=0 -k export","C-46126r2_chk","To verify that auditing is configured for all media exportation events, run the following command: 

$ sudo grep -w ""mount"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"V-38575","low","The audit system must be configured to audit user deletions of files and programs.","Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as detecting malicious processes that attempt to delete log files to conceal their presence.","None","SV-50376r4_rule","F-43523r4_fix","At a minimum, the audit system should collect file deletion events for all users and root. Add the following (or equivalent) to ""/etc/audit/audit.rules"", setting ARCH to either b32 or b64 as appropriate for your system: 

-a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid>=500 -F auid!=4294967295 -k delete
-a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid=0 -k delete

","C-46133r3_chk","To determine if the system is configured to audit calls to the ""rmdir"" system call, run the following command:

$ sudo grep -w ""rmdir"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the ""unlink"" system call, run the following command:

$ sudo grep -w ""unlink"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the ""unlinkat"" system call, run the following command:

$ sudo grep -w ""unlinkat"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the ""rename"" system call, run the following command:

$ sudo grep -w ""rename"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the ""renameat"" system call, run the following command:

$ sudo grep -w ""renameat"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line.

If no line is returned, this is a finding. ","",""
"V-38578","low","The audit system must be configured to audit changes to the /etc/sudoers file.","The actions taken by system administrators should be audited to keep a record of what was executed on the system, as well as, for accountability purposes.","None","SV-50379r1_rule","F-43526r1_fix","At a minimum, the audit system should collect administrator actions for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-w /etc/sudoers -p wa -k actions","C-46136r1_chk","To verify that auditing is configured for system administrator actions, run the following command: 

# auditctl -l | grep ""watch=/etc/sudoers""


If there is no output, this is a finding.","",""
"File Permissions","","","","","","","","","","",""
"V-38543","low","The audit system must be configured to audit all discretionary access control permission modifications using chmod.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50344r3_rule","F-43491r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S chmod -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S chmod -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S chmod -F auid=0 -k perm_mod","C-46101r2_chk","To determine if the system is configured to audit calls to the ""chmod"" system call, run the following command:

$ sudo grep -w ""chmod"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If the system is not configured to audit permission changes, this is a finding. ","","note: can organize this by own and mod"
"V-38545","low","The audit system must be configured to audit all discretionary access control permission modifications using chown.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50346r3_rule","F-43493r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S chown -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S chown -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S chown -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S chown -F auid=0 -k perm_mod","C-46103r2_chk","To determine if the system is configured to audit calls to the ""chown"" system call, run the following command:

$ sudo grep -w ""chown"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines.

If no line is returned, this is a finding. ","",""
"V-38547","low","The audit system must be configured to audit all discretionary access control permission modifications using fchmod.The audit system must be configured to audit all discretionary access control permission modifications using fchmod.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50348r3_rule","F-43495r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fchmod -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fchmod -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fchmod -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fchmod -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fchmod -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fchmod -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fchmod -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fchmod -F auid=0 -k perm_mod","C-46105r2_chk","To determine if the system is configured to audit calls to the ""fchmod"" system call, run the following command:

$ sudo grep -w ""fchmod"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. To determine if the system is configured to audit calls to the ""fchmod"" system call, run the following command:

$ sudo grep -w ""fchmod"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"V-38550","low","The audit system must be configured to audit all discretionary access control permission modifications using fchmodat.The audit system must be configured to audit all discretionary access control permission modifications using fchmodat.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50351r3_rule","F-43498r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fchmodat -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fchmodat -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fchmodat -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fchmodat -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fchmodat -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fchmodat -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fchmodat -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fchmodat -F auid=0 -k perm_mod","C-46108r2_chk","To determine if the system is configured to audit calls to the ""fchmodat"" system call, run the following command:

$ sudo grep -w ""fchmodat"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. To determine if the system is configured to audit calls to the ""fchmodat"" system call, run the following command:

$ sudo grep -w ""fchmodat"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"V-38552","low","The audit system must be configured to audit all discretionary access control permission modifications using fchown.The audit system must be configured to audit all discretionary access control permission modifications using fchown.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50353r3_rule","F-43500r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fchown -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fchown -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fchown -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fchown -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fchown -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fchown -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fchown -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fchown -F auid=0 -k perm_mod","C-46110r2_chk","To determine if the system is configured to audit calls to the ""fchown"" system call, run the following command:

$ sudo grep -w ""fchown"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. To determine if the system is configured to audit calls to the ""fchown"" system call, run the following command:

$ sudo grep -w ""fchown"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"V-38554","low","The audit system must be configured to audit all discretionary access control permission modifications using fchownat.The audit system must be configured to audit all discretionary access control permission modifications using fchownat.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50355r3_rule","F-43502r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fchownat -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fchownat -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fchownat -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fchownat -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fchownat -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fchownat -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fchownat -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fchownat -F auid=0 -k perm_mod","C-46112r2_chk","To determine if the system is configured to audit calls to the ""fchownat"" system call, run the following command:

$ sudo grep -w ""fchownat"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. To determine if the system is configured to audit calls to the ""fchownat"" system call, run the following command:

$ sudo grep -w ""fchownat"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"V-38556","low","The audit system must be configured to audit all discretionary access control permission modifications using fremovexattr.The audit system must be configured to audit all discretionary access control permission modifications using fremovexattr.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50357r3_rule","F-43504r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fremovexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fremovexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fremovexattr -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fremovexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fremovexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fremovexattr -F auid=0 -k perm_mod","C-46114r2_chk","To determine if the system is configured to audit calls to the ""fremovexattr"" system call, run the following command:

$ sudo grep -w ""fremovexattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. To determine if the system is configured to audit calls to the ""fremovexattr"" system call, run the following command:

$ sudo grep -w ""fremovexattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"V-38557","low","The audit system must be configured to audit all discretionary access control permission modifications using fsetxattr.The audit system must be configured to audit all discretionary access control permission modifications using fsetxattr.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50358r3_rule","F-43505r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fsetxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fsetxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fsetxattr -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S fsetxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S fsetxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S fsetxattr -F auid=0 -k perm_mod","C-46115r2_chk","To determine if the system is configured to audit calls to the ""fsetxattr"" system call, run the following command:

$ sudo grep -w ""fsetxattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. To determine if the system is configured to audit calls to the ""fsetxattr"" system call, run the following command:

$ sudo grep -w ""fsetxattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"V-38558","low","The audit system must be configured to audit all discretionary access control permission modifications using lchown.The audit system must be configured to audit all discretionary access control permission modifications using lchown.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50359r3_rule","F-43506r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S lchown -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S lchown -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S lchown -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S lchown -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S lchown -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S lchown -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S lchown -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S lchown -F auid=0 -k perm_mod","C-46116r2_chk","To determine if the system is configured to audit calls to the ""lchown"" system call, run the following command:

$ sudo grep -w ""lchown"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. To determine if the system is configured to audit calls to the ""lchown"" system call, run the following command:

$ sudo grep -w ""lchown"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"V-38559","low","The audit system must be configured to audit all discretionary access control permission modifications using lremovexattr.The audit system must be configured to audit all discretionary access control permission modifications using lremovexattr.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50360r3_rule","F-43507r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S lremovexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S lremovexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S lremovexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S lremovexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k perm_mod","C-46117r2_chk","To determine if the system is configured to audit calls to the ""lremovexattr"" system call, run the following command:

$ sudo grep -w ""lremovexattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. To determine if the system is configured to audit calls to the ""lremovexattr"" system call, run the following command:

$ sudo grep -w ""lremovexattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"V-38561","low","The audit system must be configured to audit all discretionary access control permission modifications using lsetxattr.The audit system must be configured to audit all discretionary access control permission modifications using lsetxattr.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50362r3_rule","F-43509r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S lsetxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S lsetxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S lsetxattr -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S lsetxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S lsetxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S lsetxattr -F auid=0 -k perm_mod","C-46119r2_chk","To determine if the system is configured to audit calls to the ""lsetxattr"" system call, run the following command:

$ sudo grep -w ""lsetxattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. To determine if the system is configured to audit calls to the ""lsetxattr"" system call, run the following command:

$ sudo grep -w ""lsetxattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"V-38563","low","The audit system must be configured to audit all discretionary access control permission modifications using removexattr.The audit system must be configured to audit all discretionary access control permission modifications using removexattr.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50364r3_rule","F-43511r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S removexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S removexattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S removexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S removexattr -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S removexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S removexattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S removexattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S removexattr -F auid=0 -k perm_mod","C-46121r2_chk","To determine if the system is configured to audit calls to the ""removexattr"" system call, run the following command:

$ sudo grep -w ""removexattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding.To determine if the system is configured to audit calls to the ""removexattr"" system call, run the following command:

$ sudo grep -w ""removexattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding.","",""
"V-38565","low","The audit system must be configured to audit all discretionary access control permission modifications using setxattr.The audit system must be configured to audit all discretionary access control permission modifications using setxattr.","The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.","None","SV-50366r3_rule","F-43513r2_fix","At a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S setxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S setxattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S setxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S setxattr -F auid=0 -k perm_modAt a minimum, the audit system should collect file permission changes for all users and root. Add the following to ""/etc/audit/audit.rules"": 

-a always,exit -F arch=b32 -S setxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b32 -S setxattr -F auid=0 -k perm_mod

If the system is 64-bit, then also add the following: 

-a always,exit -F arch=b64 -S setxattr -F auid>=500 -F auid!=4294967295 \
-k perm_mod
-a always,exit -F arch=b64 -S setxattr -F auid=0 -k perm_mod","C-46123r2_chk","To determine if the system is configured to audit calls to the ""setxattr"" system call, run the following command:

$ sudo grep -w ""setxattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. To determine if the system is configured to audit calls to the ""setxattr"" system call, run the following command:

$ sudo grep -w ""setxattr"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return several lines. 

If no line is returned, this is a finding. ","",""
"Take Appropriate Action When:","","","","","","","","","","",""
"V-38468","medium","The audit system must take appropriate action when there are disk errors on the audit storage volume.The audit system must take appropriate action when there are disk errors on the audit storage volume.","Taking appropriate action in case of disk errors will minimize the possibility of losing audit records.","None","SV-50264r1_rule","F-43410r1_fix","Edit the file ""/etc/audit/auditd.conf"". Modify the following line, substituting [ACTION] appropriately: 

disk_error_action = [ACTION]

Possible values for [ACTION] are described in the ""auditd.conf"" man page. These include: 

""ignore""
""syslog""
""exec""
""suspend""
""single""
""halt""


Set this to ""syslog"", ""exec"", ""single"", or ""halt"".Edit the file ""/etc/audit/auditd.conf"". Modify the following line, substituting [ACTION] appropriately: 

disk_error_action = [ACTION]

Possible values for [ACTION] are described in the ""auditd.conf"" man page. These include: 

""ignore""
""syslog""
""exec""
""suspend""
""single""
""halt""


Set this to ""syslog"", ""exec"", ""single"", or ""halt"".","C-46020r1_chk","Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine if the system is configured to take appropriate action when disk errors occur:

# grep disk_error_action /etc/audit/auditd.conf
disk_error_action = [ACTION]


If the system is configured to ""suspend"" when disk errors occur or ""ignore"" them, this is a finding.Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine if the system is configured to take appropriate action when disk errors occur:

# grep disk_error_action /etc/audit/auditd.conf
disk_error_action = [ACTION]


If the system is configured to ""suspend"" when disk errors occur or ""ignore"" them, this is a finding.","storage volume",""
"V-38470","medium","The audit system must take appropriate action when the audit storage volume is full.The audit system must take appropriate action when the audit storage volume is full.","Taking appropriate action in case of a filled audit storage volume will minimize the possibility of losing audit records.","None","SV-50268r1_rule","F-43413r1_fix","The ""auditd"" service can be configured to take an action when disk space starts to run low. Edit the file ""/etc/audit/auditd.conf"". Modify the following line, substituting [ACTION] appropriately: 

disk_full_action = [ACTION]

Possible values for [ACTION] are described in the ""auditd.conf"" man page. These include: 

""ignore""
""syslog""
""exec""
""suspend""
""single""
""halt""


Set this to ""syslog"", ""exec"", ""single"", or ""halt"".The ""auditd"" service can be configured to take an action when disk space starts to run low. Edit the file ""/etc/audit/auditd.conf"". Modify the following line, substituting [ACTION] appropriately: 

disk_full_action = [ACTION]

Possible values for [ACTION] are described in the ""auditd.conf"" man page. These include: 

""ignore""
""syslog""
""exec""
""suspend""
""single""
""halt""


Set this to ""syslog"", ""exec"", ""single"", or ""halt"".","C-46023r1_chk","Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine if the system is configured to take appropriate action when the audit storage volume is full:

# grep disk_full_action /etc/audit/auditd.conf
disk_full_action = [ACTION]


If the system is configured to ""suspend"" when the volume is full or ""ignore"" that it is full, this is a finding.Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine if the system is configured to take appropriate action when the audit storage volume is full:

# grep disk_full_action /etc/audit/auditd.conf
disk_full_action = [ACTION]


If the system is configured to ""suspend"" when the volume is full or ""ignore"" that it is full, this is a finding.","",""
"V-38471","medium","The audit system must alert designated staff members when the audit storage volume approaches capacity.The audit system must alert designated staff members when the audit storage volume approaches capacity.","Notifying administrators of an impending disk space problem may allow them to take corrective action prior to any disruption.","None","SV-50270r2_rule","F-43415r2_fix","The ""auditd"" service can be configured to take an action when disk space starts to run low. Edit the file ""/etc/audit/auditd.conf"". Modify the following line, substituting [ACTION] appropriately: 

space_left_action = [ACTION]

Possible values for [ACTION] are described in the ""auditd.conf"" man page. These include: 

""ignore""
""syslog""
""email""
""exec""
""suspend""
""single""
""halt""


Set this to ""email"" (instead of the default, which is ""suspend"") as it is more likely to get prompt attention.  The ""syslog"" option is acceptable, provided the local log management infrastructure notifies an appropriate administrator in a timely manner.

RHEL-06-000521 ensures that the email generated through the operation ""space_left_action"" will be sent to an administrator.The ""auditd"" service can be configured to take an action when disk space starts to run low. Edit the file ""/etc/audit/auditd.conf"". Modify the following line, substituting [ACTION] appropriately: 

space_left_action = [ACTION]

Possible values for [ACTION] are described in the ""auditd.conf"" man page. These include: 

""ignore""
""syslog""
""email""
""exec""
""suspend""
""single""
""halt""


Set this to ""email"" (instead of the default, which is ""suspend"") as it is more likely to get prompt attention.  The ""syslog"" option is acceptable, provided the local log management infrastructure notifies an appropriate administrator in a timely manner.

RHEL-06-000521 ensures that the email generated through the operation ""space_left_action"" will be sent to an administrator.","C-46025r3_chk","Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine if the system is configured to email the administrator when disk space is starting to run low: 

# grep space_left_action /etc/audit/auditd.conf
space_left_action = email


If the system is not configured to send an email to the system administrator when disk space is starting to run low, this is a finding.  The ""syslog"" option is acceptable when it can be demonstrated that the local log management infrastructure notifies an appropriate administrator in a timely manner.Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine if the system is configured to email the administrator when disk space is starting to run low: 

# grep space_left_action /etc/audit/auditd.conf
space_left_action = email


If the system is not configured to send an email to the system administrator when disk space is starting to run low, this is a finding.  The ""syslog"" option is acceptable when it can be demonstrated that the local log management infrastructure notifies an appropriate administrator in a timely manner.","",""
"V-38678","medium","The audit system must switch the system to single-user mode when available audit storage volume becomes dangerously low.The audit system must switch the system to single-user mode when available audit storage volume becomes dangerously low.","Administrators should be made aware of an inability to record audit records. If a separate partition or logical volume of adequate size is used, running low on space for audit records should never occur. ","None","SV-68627r1_rule","F-59235r2_fix","The ""auditd"" service can be configured to take an action when disk space is running low but prior to running out of space completely. Edit the file ""/etc/audit/auditd.conf"". Add or modify the following line, substituting [ACTION] appropriately:

admin_space_left_action = [ACTION]

Set this value to ""single"" to cause the system to switch to single-user mode for corrective action. Acceptable values also include ""suspend"" and ""halt"". For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. Details regarding all possible values for [ACTION] are described in the ""auditd.conf"" man page. The ""auditd"" service can be configured to take an action when disk space is running low but prior to running out of space completely. Edit the file ""/etc/audit/auditd.conf"". Add or modify the following line, substituting [ACTION] appropriately:

admin_space_left_action = [ACTION]

Set this value to ""single"" to cause the system to switch to single-user mode for corrective action. Acceptable values also include ""suspend"" and ""halt"". For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. Details regarding all possible values for [ACTION] are described in the ""auditd.conf"" man page. ","C-54997r2_chk","Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine if the system is configured to either suspend, switch to single-user mode, or halt when disk space has run low:

admin_space_left_action single

If the system is not configured to switch to single-user mode for corrective action, this is a finding. Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine if the system is configured to either suspend, switch to single-user mode, or halt when disk space has run low:

admin_space_left_action single

If the system is not configured to switch to single-user mode for corrective action, this is a finding. ","",""
"V-38680","medium","The audit system must provide a warning when allocated audit record storage volume reaches a documented percentage of maximum audit record storage capacity.","Notifying administrators of an impending disk space problem may allow them to take corrective action prior to any disruption.","None","SV-50479r2_rule","F-43627r2_fix","The ""auditd"" service can be configured to take an action when disk space starts to run low. Edit the file ""/etc/audit/auditd.conf"". Modify the following line, substituting [num_megabytes] appropriately: 

space_left = [num_megabytes]

The ""num_megabytes"" value should be set to a fraction of the total audit storage capacity available that will allow a system administrator to be notified with enough time to respond to the situation causing the capacity issues.  This value must also be documented locally.","C-46240r1_chk","Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine whether the system is configured to email the administrator when disk space is starting to run low: 

# grep space_left /etc/audit/auditd.conf 

space_left = [num_megabytes]


If the ""num_megabytes"" value does not correspond to a documented value for remaining audit partition capacity or if there is no locally documented value for remaining audit partition capacity, this is a finding.","",""
"V-54381","medium","The audit system must identify staff members to receive notifications of audit log storage volume capacity issues.","Email sent to the root account is typically aliased to the administrators of the system, who can take appropriate action.","None","SV-50481r1_rule","F-43629r1_fix","The ""auditd"" service can be configured to send email to a designated account in certain situations. Add or correct the following line in ""/etc/audit/auditd.conf"" to ensure that administrators are notified via email for those situations: 

action_mail_acct = root","C-46241r1_chk","Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine if the system is configured to send email to an account when it needs to notify an administrator: 

action_mail_acct = root


If auditd is not configured to send emails per identified actions, this is a finding.","",""
"V-38633","medium","The system must set a maximum audit log file size.","The total storage for audit log files must be large enough to retain log information over the period required. This is a function of the maximum log file size and the number of logs retained.","None","SV-50434r1_rule","F-43582r1_fix","Determine the amount of audit data (in megabytes) which should be retained in each log file. Edit the file ""/etc/audit/auditd.conf"". Add or modify the following line, substituting the correct value for [STOREMB]: 

max_log_file = [STOREMB]

Set the value to ""6"" (MB) or higher for general-purpose systems. Larger values, of course, support retention of even more audit data.","C-46192r1_chk","Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine how much data the system will retain in each audit log file: ""# grep max_log_file /etc/audit/auditd.conf"" 

max_log_file = 6


If the system audit data threshold hasn't been properly set up, this is a finding.","audit log file size and rotation",""
"V-38634","medium","The system must rotate audit log files that reach the maximum file size.","Automatically rotating logs (by setting this to ""rotate"") minimizes the chances of the system unexpectedly running out of disk space by being overwhelmed with log data. However, for systems that must never discard log data, or which use external processes to transfer it and reclaim space, ""keep_logs"" can be employed.","None","SV-50435r1_rule","F-43583r1_fix","The default action to take when the logs reach their maximum size is to rotate the log files, discarding the oldest one. To configure the action taken by ""auditd"", add or correct the line in ""/etc/audit/auditd.conf"": 

max_log_file_action = [ACTION]

Possible values for [ACTION] are described in the ""auditd.conf"" man page. These include: 

""ignore""
""syslog""
""suspend""
""rotate""
""keep_logs""


Set the ""[ACTION]"" to ""rotate"" to ensure log rotation occurs. This is the default. The setting is case-insensitive.","C-46193r1_chk","Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine if the system is configured to rotate logs when they reach their maximum size: ""# grep max_log_file_action /etc/audit/auditd.conf"" 

max_log_file_action ""rotate""


If the system has not been properly set up to rotate audit logs, this is a finding.","",""
"V-38636","medium","The system must retain enough rotated audit logs to cover the required log retention period.","The total storage for audit log files must be large enough to retain log information over the period required. This is a function of the maximum log file size and the number of logs retained.","None","SV-50437r1_rule","F-43585r1_fix","Determine how many log files ""auditd"" should retain when it rotates logs. Edit the file ""/etc/audit/auditd.conf"". Add or modify the following line, substituting [NUMLOGS] with the correct value: 

num_logs = [NUMLOGS]

Set the value to 5 for general-purpose systems. Note that values less than 2 result in no log rotation.","C-46195r1_chk","Inspect ""/etc/audit/auditd.conf"" and locate the following line to determine how many logs the system is configured to retain after rotation: ""# grep num_logs /etc/audit/auditd.conf"" 

num_logs = 5


If the overall system log file(s) retention hasn't been properly set up, this is a finding.","",""
"V-38522","low","The system must forward audit records to the syslog service.","The auditd service does not include the ability to send audit records to a centralized server for management directly.  It does, however, include an audit event multiplexor plugin (audispd) to pass audit records to the local syslog server.","None","SV-50271r1_rule","F-43416r1_fix","Set the ""active"" line in ""/etc/audisp/plugins.d/syslog.conf"" to ""yes"".  Restart the auditd process.

# service auditd restart","C-46026r1_chk","Verify the audispd plugin is active:

# grep active /etc/audisp/plugins.d/syslog.conf

If the ""active"" setting is missing or set to ""no"", this is a finding.","",""
"Configuration:","","","","","","","","","","",""
"V-38580","medium","The audit system must be configured to audit the loading and unloading of dynamic kernel modules.","The addition/removal of kernel modules can be used to alter the behavior of the kernel and potentially introduce malicious code into kernel space. It is important to have an audit trail of modules that have been introduced into the kernel.","None","SV-50381r2_rule","F-43528r2_fix","Add the following to ""/etc/audit/audit.rules"" in order to capture kernel module loading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system: 

-w /sbin/insmod -p x -k modules
-w /sbin/rmmod -p x -k modules
-w /sbin/modprobe -p x -k modules
-a always,exit -F arch=[ARCH] -S init_module -S delete_module -k modules","C-46138r3_chk","To determine if the system is configured to audit execution of module management programs, run the following commands:

$ sudo egrep -e ""(-w |-F path=)/sbin/insmod"" /etc/audit/audit.rules
$ sudo egrep -e ""(-w |-F path=)/sbin/rmmod"" /etc/audit/audit.rules
$ sudo egrep -e ""(-w |-F path=)/sbin/modprobe"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line.

To determine if the system is configured to audit calls to the ""init_module"" system call, run the following command:

$ sudo grep -w ""init_module"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line. 

To determine if the system is configured to audit calls to the ""delete_module"" system call, run the following command:

$ sudo grep -w ""delete_module"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line. 

If no line is returned for any of these commands, this is a finding. ","",""
"V-38464","low","The audit system must be configured to audit modifications to the systems Mandatory Access Control (MAC) configuration (SELinux).","The system's mandatory access policy (SELinux) should not be arbitrarily changed by anything other than administrator action. All changes to MAC policy should be audited.","None","SV-50342r1_rule","F-43489r1_fix","Add the following to ""/etc/audit/audit.rules"": 

-w /etc/selinux/ -p wa -k MAC-policy","C-46099r1_chk","To determine if the system is configured to audit changes to its SELinux configuration files, run the following command: 

# auditctl -l | grep ""dir=/etc/selinux""

If the system is configured to watch for changes to its SELinux configuration, a line should be returned (including ""perm=wa"" indicating permissions that are watched). 
If the system is not configured to audit attempts to change the MAC policy, this is a finding.","",""
"V-38541","low","The audit system must be configured to audit modifications to the systems network configuration.","The network environment should not be modified by anything other than administrator action. Any change to network parameters should be audited.","None","SV-50341r2_rule","F-43488r2_fix","Add the following to ""/etc/audit/audit.rules"", setting ARCH to either b32 or b64 as appropriate for your system: 

# audit_network_modifications
-a always,exit -F arch=ARCH -S sethostname -S setdomainname -k audit_network_modifications
-w /etc/issue -p wa -k audit_network_modifications
-w /etc/issue.net -p wa -k audit_network_modifications
-w /etc/hosts -p wa -k audit_network_modifications
-w /etc/sysconfig/network -p wa -k audit_network_modifications","C-46098r1_chk","To determine if the system is configured to audit changes to its network configuration, run the following command: 

auditctl -l | egrep '(sethostname|setdomainname|/etc/issue|/etc/issue.net|/etc/hosts|/etc/sysconfig/network)'

If the system is configured to watch for network configuration changes, a line should be returned for each file specified (and ""perm=wa"" should be indicated for each). 
If the system is not configured to audit changes of the network configuration, this is a finding.","",""
"V-38540","low","The audit system must be configured to audit modifications to the systems network configuration.","The network environment should not be modified by anything other than administrator action. Any change to network parameters should be audited.","None","SV-50341r2_rule","F-43488r2_fix","Add the following to ""/etc/audit/audit.rules"", setting ARCH to either b32 or b64 as appropriate for your system: 

# audit_network_modifications
-a always,exit -F arch=ARCH -S sethostname -S setdomainname -k audit_network_modifications
-w /etc/issue -p wa -k audit_network_modifications
-w /etc/issue.net -p wa -k audit_network_modifications
-w /etc/hosts -p wa -k audit_network_modifications
-w /etc/sysconfig/network -p wa -k audit_network_modifications","C-46098r1_chk","To determine if the system is configured to audit changes to its network configuration, run the following command: 

auditctl -l | egrep '(sethostname|setdomainname|/etc/issue|/etc/issue.net|/etc/hosts|/etc/sysconfig/network)'

If the system is configured to watch for network configuration changes, a line should be returned for each file specified (and ""perm=wa"" should be indicated for each). 
If the system is not configured to audit changes of the network configuration, this is a finding.","",""
