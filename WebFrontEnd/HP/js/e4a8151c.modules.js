function mpp$ServiceSvc(a){var b=a("api/service/:serviceId",{},{query:{method:"GET",isArray:!0,tracker:"service$query"},get:{method:"GET",params:{serviceId:"@serviceId",catalog:"@catalog",category:"@category"},tracker:"service$get"},post:{method:"POST",params:{serviceId:"@serviceId",catalog:"@catalog",basedOn:"@basedOn"},headers:{"Content-Type":void 0},transformRequest:function(a){if(window.FormData){var b=new FormData;if(b.append("model",angular.toJson(a.model)),a.files)for(var c=0;c<a.files.length;c++)b.append("file"+c,a.files[c]);return b}},tracker:"service$post"},postWithoutAttachments:{method:"POST",params:{serviceId:"@serviceId",catalog:"@catalog",basedOn:"@basedOn"},headers:{"Content-Type":"application/json"},transformRequest:function(a){return angular.toJson(a)},tracker:"service$post"}});return b}function mpp$OfferingSvc(a){var b=a("api/offering/:id",{},{totalCount:{method:"GET",params:{id:"total-count"},tracker:"offering$totalcount"}});return b}function mpp$ServicePropertySvc(a){var b=a("api/service/property/:id",{},{post:{method:"POST",isArray:!0,params:{id:"@id"},tracker:"service.property$post"}});return b}function mpp$SingleServiceCheckout(a,b,c){function d(a){this.item=a,this.state="detail"}return d.prototype.checkout=function(a){return this.options=a,this.state="checkout",this},d.prototype.submit=function(d){var e=this,f=Object.extended();e.options.each(function(a){f[a.id]=a.value});var g={};c.setStartDate(d.startDate),c.setEndDate(d.endDate,d.startDate),g.model={categoryName:e.item.category.name,subscriptionName:d.name,subscriptionDescription:d.description,groupOwnership:d.userGroup,startDate:d.startDate,endDate:d.endDate,fields:f,action:"ORDER"},g.files=d.files;var h,i={serviceId:e.item.id,catalog:e.item.catalogId};return this.item.basedOn&&(i.basedOn=this.item.basedOn),h=window.FormData?b.post(i,g):b.postWithoutAttachments(i,g),h.$promise.then(function(b){e.confirmation=b,b.requestedBy=a.get("user").name,b.createdOn=Date.create(),e.state="confirmation"}),h.$promise},d.prototype.reset=function(){return delete this.options,delete this.confirmation,this.state="detail",this},d.prototype.makeChanges=function(){return this.state="detail",this},d.prototype.reOrder=function(){return delete this.confirmation,this.state="detail",this},d}function mpp$ModifySubscriptionCheckout(a,b,c,d,e){function f(a){this.item=a,this.state="detail"}return f.prototype=new d,f.prototype.submit=function(d){var f=this,g=Object.extended();f.options.each(function(a){g[a.id]=a.value}),e.setStartDate(d.startDate),e.setEndDate(d.endDate,d.startDate);var h=Object.extended({serviceId:f.item.serviceId,categoryName:f.item.category.name,subscriptionName:d.subsName,subscriptionDescription:d.subsDesc,startDate:d.startDate,endDate:d.endDate,fields:g,action:"MODIFY_SUBSCRIPTION"});"recurring"===d.subscriptionPeriod&&(h.endDate=null),d.groupOwned&&d.group&&h.merge({groupOwnership:d.group.name});var i=c.modify({id:f.item.id,catalog:f.item.catalogId},h);return i.$promise.then(function(a){f.confirmation=a,a.requestedBy=b.get("user").name,a.createdOn=Date.create(),f.state="confirmation"},function(){a.messageBox("subscription.modify.checkout.error.title","subscription.modify.checkout.error.message",[{label:"common.ok",cssClass:"btn-info",id:"errorButton"}]).open()}),this},f}function mpp$MyserviceSvc(a){var b=a("api/myservice/:id",{},{query:{method:"GET",isArray:!0,tracker:"myservice$query"},get:{method:"GET",tracker:"myservice$get",params:{catalog:"@catalog"}},count:{method:"GET",params:{id:"count",state:"@state"},tracker:"myservice$count"},post:{method:"POST",params:{id:"@id",catalog:"@catalogId"},tracker:"myservice$post"}});return b}function mpp$MyserviceActionSvc(a){var b=a("api/myservice/action/:id/:cid",{},{post:{method:"POST",params:{id:"@id",cid:"@componentId"},tracker:"myserviceAction$post"}});return b}function mpp$approvalSvc(a){return a("api/approval/:id",{},{query:{method:"GET",isArray:!0,tracker:"approval$query"},get:{method:"GET",tracker:"approval$get"},modify:{method:"PUT",tracker:"approval$modify",params:{id:"@id",catalogID:"@catalogID",action:"@action",comment:"@comment"}},count:{method:"GET",params:{id:"count",state:"@state"},tracker:"approval$count"}})}function mpp$approvalAction(a,b,c,d){return{deny:function(b,c,e,f){a.commentBox("approvals.confirmation.deny.title","approvals.confirmation.deny.subtitle",[{label:"common.yes",cssClass:"btn-primary",result:"deny",id:"deny-"+b,focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok",id:"ok-"+b}],"approvals.confirmation.deny.placeholder","common.validation.requiredField",255).open().result.then(function(a){if("deny"===a.type){d.modify({id:b,catalogID:c,action:"REJECTED",comment:a.comment}).$promise.then(function(){e("REJECTED")},function(a){f(a)})}})},approve:function(b,c,e,f){a.messageBox("approvals.confirmation.approve.title","approvals.confirmation.approve.subtitle",[{label:"common.yes",cssClass:"btn-primary",result:"approve",id:"approve-"+b,focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok",id:"ok-"+b}]).open().result.then(function(a){if("approve"===a){d.modify({id:b,catalogID:c,action:"APPROVED",comment:""}).$promise.then(function(){e("APPROVED")},function(a){f(a)})}})}}}function mpp$orderSvc(a){return a("api/order/:id",{},{get:{method:"GET",tracker:"order$get"}})}function mpp$requestSvc(a){return a("api/request/:id",{},{query:{method:"GET",isArray:!0,tracker:"request$query"},get:{method:"GET",tracker:"request$get"},count:{method:"GET",params:{id:"count",state:"@state"},tracker:"request$count"},"delete":{method:"POST",tracker:"request$delete"},multiDelete:{method:"POST",tracker:"request$multiDelete"},cancel:{method:"PUT",params:{id:"@id"},tracker:"request$cancel"},multiCancel:{method:"PUT",params:{id:"@id"},tracker:"request$multiCancel"},totalCount:{method:"GET",params:{id:"total-count"},tracker:"request$totalcount"},resubmitModifyRequest:{method:"POST",params:{id:"@id"},tracker:"request$resubmitModifyRequest"}})}function mpp$reqAction(a,b){var c,d,e=0;return{iconForRequestType:function(a){var b,c,d={ORDER:"icon-delivery",MODIFY_SUBSCRIPTION:"icon-edit",CANCEL_SUBSCRIPTION:"icon-halt-option",DEFAULT:"icon-tools"};return a?(c=a.requestedAction,b=Object.has(d,c)?d[c]:d.DEFAULT):d.DEFAULT},iconForRequestStatus:function(a){var b,c,d={APPROVED:"icon-validation-approve",CANCELED:"icon-delete-circle",DENIED:"icon-validation-denied",IN_PROGRESS:"icon-ellipses",DEFAULT:"icon-pending"};return a?(c=a.status,b=Object.has(d,c)?d[c]:d.DEFAULT):d.DEFAULT},setListActionsInstance:function(a){d=a},setRemainingCount:function(a){e=a},getRemainingCount:function(){return e},getDataAnalysis:function(){return c},setDataAnalysis:function(a){var b,d=[],e=[],f=0,g=function(a){a.processing&&(f+=1),a.pending||a.inProgress||e.push(a.id),a.pending&&d.push(a.id)};0!==a.length&&(b=a[0].catalogId),a.forEach(function(a){g(a)}),c={total:a.length,catalogId:b,isAllCancelable:0===d.length,cancelableList:d,isAllDeletable:0===e.length,deletableList:e,processingListCounter:f}},singleCancel:function(c,d,e){a.messageBox("request.modal.cancel.title","request.modal.cancel.message",[{label:"common.yes",cssClass:"btn-danger",result:"cancel",id:"confirm-"+c,focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok",id:"ok-"+c}]).open().result.then(function(a){if("cancel"===a){b.cancel({id:c},{ids:[c]}).$promise.then(function(){d&&d(c)},e)}})},multiCancel:function(d,e){var f;a.messageBox("request.modal.multiple_cancel.title","request.modal.multiple_cancel.message",[{label:"common.yes",cssClass:"btn-danger",result:"cancelAll",focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok"}]).open().result.then(function(a){"cancelAll"===a&&(f=c.cancelableList,b.multiCancel({id:f[0]},{ids:f}).$promise.then(function(){d(f)},e))})},singleDelete:function(c,d,e){a.messageBox("request.modal.delete.title","request.modal.delete.message",[{label:"common.yes",cssClass:"btn-primary",result:"delete",id:"confirm-"+c,focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok",id:"ok-"+c}]).open().result.then(function(a){if("delete"===a){b.delete({ids:[c]}).$promise.then(d,e)}})},multiDelete:function(a,f){var g=this;b.multiDelete({ids:c.deletableList}).$promise.then(function(){a.removeDeletedItems(c.deletableList),e>0?(d.showReDeleteModal(c),e-=1):g.noMoreToBeDeleted(c.deletableList.length)},f)},confirmMultiDelete:function(b,d){var e=this;a.messageBox("request.modal.multiple_delete.title","request.modal.multiple_delete.message",[{label:"common.yes",cssClass:"btn-primary",result:"deleteAll",focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok"}]).open().result.then(function(a){"deleteAll"===a&&(d?b.deleteAgainCallback(c.total-c.deletableList.length):e.multiDelete(b))})},noMoreToBeDeleted:function(b){a.ListActionsMessageBox("request.modal.end.title","request.modal.end.message","",b,[{label:"common.ok",cssClass:"btn-primary",result:"ok",focus:!0}]).open()}}}function mpp$SubscriptionSvc(a){return a("api/subscription/:id",{},{query:{method:"GET",isArray:!0,tracker:"subscription$query"},get:{method:"GET",tracker:"subscription$get",params:{id:"@id"}},count:{method:"GET",params:{id:"count",state:"@state"},tracker:"subscription$count"},modify:{method:"PUT",tracker:"subscription$modify",params:{id:"@id",catalog:"@catalog",action:"MODIFY"}},cancel:{method:"PUT",params:{id:"@id",catalog:"@catalog",action:"CANCEL"},tracker:"subscription$cancel"},multiCancel:{method:"PUT",params:{id:"@id",catalog:"@catalog",action:"CANCEL"},tracker:"subscription$multiCancel"},"delete":{method:"POST",tracker:"subscription$delete"},multiDelete:{method:"POST",tracker:"subscription$multiDelete"}})}function mpp$WizardSvc(a){var b=a("api/wizard/:id",{},{list:{method:"GET",tracker:"wizard$list"},get:{method:"GET",params:{id:"@id",catalog:"@catalog",category:"@category"},tracker:"wizard$get"}});return b}function mpp$NotificationSvc(a){var b=a("api/notification/:notificationId",{},{query:{method:"GET",isArray:!0,tracker:"notification$query"},get:{method:"GET",tracker:"notification$get"},count:{method:"GET",isArray:!0,params:{notificationId:"count"},tracker:"notification$count"},totalCount:{method:"GET",params:{notificationId:"total-count"},tracker:"notification$totalcount"},post:{method:"POST",params:{notificationId:"@notificationId"},tracker:"notification$post"}});return b}function mpp$listActions(a){function b(a,b,c,d,e){this.title=a,this.resource=b,this.actionService=c,this.cancelCallbackFn=d,this.deleteCallbackFn=e}return b.prototype.showReDeleteModal=function(b,c){var d=this;a.ListActionsMessageBox("common.listActions.modal.delete.reDelete.title","common.listActions.modal.delete.reDelete.message",d.title,b.deletableList.length,[{label:"common.listActions.modal.delete.reDelete.buttonText",cssClass:"btn-primary",result:"deleteMore",id:"deleteMoreButton",focus:!0},{label:"common.listActions.buttonText",cssClass:"btn-info",result:"listActions",id:"listActionsButton"}]).open().result.then(function(a){"listActions"===a?d.showListActionModal(b,c):"deleteMore"===a&&d.actionService.confirmMultiDelete(d.deleteCallbackFn,!0,c)})},b.prototype.showListActionModal=function(b,c){var d=this,e="cancelAll",f="deleteAll";a.ListActionsBox(d.title,"common.listActions.modal.title","common.listActions.modal.message",[{title:"common.listActions.modal.cancel.title",message:"common.listActions.modal.cancel.message",btnText:"common.listActions.modal.cancel.buttonText",cssClass:"btn-danger",result:e,disable:b.isAllCancelable,id:"cancelAllButton",focus:!b.isAllCancelable},{title:"common.listActions.modal.delete.title",message:"common.listActions.modal.delete.message",btnText:"common.listActions.modal.delete.buttonText",cssClass:"btn-primary",result:f,disable:b.isAllDeletable,focus:b.isAllCancelable}]).open().result.then(function(a){a===e?d.actionService.multiCancel(d.cancelCallbackFn,c):a===f&&d.actionService.confirmMultiDelete(d.deleteCallbackFn,!1,c)})},b}function mpp$organizationSvc(a){return a("api/organization/:id",{},{get:{method:"GET",params:{id:"@id"},tracker:"organization$get"}})}function mpp$widgetSvc(a){return a("api/widget",{},{get:{method:"GET",tracker:"widget$get"}})}function mpp$userSvc(a){return a("api/user/:id",{},{get:{method:"GET",params:{id:"@id"},tracker:"user$get"}})}function mpp$cart(a){function b(){this.items=[],this.thresholdQuantity=20,this.maximumQuantity=100,this.totalQuantity=0}return b.prototype.reset=function(){this.items=[],this.totalQuantity=0},b.prototype._recalculateCartProperties=function(){var a=0;this.items.each(function(b){b.quantity=1*b.quantity,a+=b.quantity}),this.totalQuantity=a},b.prototype.getCart=function(){var b=this,c=a.get().$promise;return c.then(function(a){b.items=a.items,b.thresholdQuantity=a.thresholdQuantity||20,b.maximumQuantity=a.maximumQuantity||100,b._recalculateCartProperties()},function(){}),c},b.prototype.addItem=function(b,c,d){var e=this,f={fields:c,quantity:1,offering:{id:b.id,displayName:b.displayName,approvalRequired:b.approvalRequired,image:b.image,category:b.category.name,catalogId:b.catalogId},price:d},g=a.add({},f).$promise;return g.then(function(a){if(e.totalQuantity+=1,a.merged){var b=e.items.find(function(b){return a.id===b.id});b&&(b.quantity+=1,b.originalQuantity=b.quantity)}else f.id=a.id,e.items.push(f)},function(){}),g},b.prototype.updateItem=function(b){var c=this,d=a.update({id:b.id},b).$promise;return d.then(function(a){var d=c.items.find(function(a){return a.id===b.id});a.merged?(c.items=c.items.exclude(function(a){return a.id===b.id}),d.quantity+=b.quantity):Object.merge(d,b,!0),d.originalQuantity=d.quantity,c._recalculateCartProperties()},function(){b.quantity=b.originalQuantity}),d},b.prototype.editItem=function(b){var c=a.edit({id:b}).$promise;return c},b.prototype.removeItem=function(b){var c=this,d=a.remove({id:b}).$promise;return d.then(function(){c.items=c.items.exclude(function(a){return a.id===b}),c._recalculateCartProperties()},function(){}),d},new b}function mpp$CartSvc(a){var b=a("api/cart/:item/:id",{},{get:{method:"GET",tracker:"cart$get",transformResponse:function(a){try{a=angular.fromJson(a)}catch(b){a={items:[]}}return a.items.each(function(a){a.originalQuantity=a.quantity}),a}},add:{method:"PUT",params:{item:"item"},tracker:"cart$add"},update:{method:"PATCH",params:{item:"item",id:"@id"},tracker:"cart$update"},edit:{method:"GET",params:{item:"item",id:"@id"},tracker:"cart$edit"},remove:{method:"DELETE",params:{item:"item",id:"@id"},tracker:"cart$remove"},submit:{method:"POST",headers:{"Content-Type":void 0},transformRequest:function(a){if(window.FormData){var b=new FormData;if(b.append("model",angular.toJson(a.model)),a.files)for(var c=0;c<a.files.length;c++)b.append("file"+c,a.files[c]);return b}},tracker:"cart$submit"},submitWithoutAttachments:{method:"POST",headers:{"Content-Type":"application/json"},transformRequest:function(a){return angular.toJson(a)},tracker:"cart$submit"}});return b}function mpp$CartCheckout(a,b,c){function d(){this.state="detail",this.checkout={}}return d.prototype.configureItems=function(){function b(a){return{id:a.id,createdOn:a.createdOn,offering:a.offering,price:a.price,subscriptionName:"",subscriptionDesc:"",showSubscriptionDesc:!1}}this.state="itemConfig";var c=this;if(this.checkout.items){var d=[];this.checkout.items.groupBy(function(a){return a.id},function(b){a.items.none(function(a){return a.id===b})&&d.push(b)}),d.each(function(a){c.checkout.items=c.checkout.items.exclude(function(b){return b.id===a})});var e=[];a.items.each(function(a){var d,f=c.checkout.items.findAll(function(b){return b.id===a.id});if(f.length<a.quantity){d=a.quantity-f.length;for(var g=0;d>g;g++){var h=b(a);h.subscriptionName=a.offering.displayName,f.push(h)}}else f.length>a.quantity&&(f=f.slice(0,a.quantity));e=e.concat(f)}),this.checkout.items=e}else this.checkout.items=[],a.items.each(function(a){for(var d=0;d<a.quantity;d++)c.checkout.items.push(b(a))});return this},d.prototype.configureOrder=function(){return this.state="orderConfig",this},d.prototype.restart=function(){return this.state="detail",this},d.prototype._createSubmissionRequest=function(a){var b=Object.extended(this.checkout).clone(!0);return b.subscriptions=[],b.items.each(function(a){a.subscriptionName||(a.subscriptionName=a.offering.displayName),b.subscriptions.push(Object.select(a,["id","subscriptionName","subscriptionDesc"]))}),delete b.items,b.groupOwnership=a.groupOwnership||null,b.startDate=c.setStartDate(a.startDate),b.endDate=c.setEndDate(a.endDate,a.startDate),b},d.prototype._handleConfirmation=function(b){function c(b){var c=a.items.find(function(a){return a.id===b.cartItemId});if(c){var d=Object.select(c,["offering","price"]);Object.merge(b,d)}}b.requests.each(function(a){c(a)}),b.failedRequests.each(function(a){c(a)}),this.confirmation=b,this.state="confirmation"},d.prototype.submit=function(a,c){var d=this,e={};e.model=this._createSubmissionRequest(a),e.files=c;var f;return f=window.FormData?b.submit(e):b.submitWithoutAttachments(e),f.$promise.then(function(a){d._handleConfirmation(a)}),f.$promise},d}function mpp$dashboardSvc(a,b,c){var d;return c.fetch().then(function(a){d=a}),a("api/dashboard",{},{get:{method:"GET",tracker:"dashboard$get",transformResponse:function(a){try{if(a=JSON.parse(a),a.httpStatusCode>=400)throw a;a.sections&&(a.sections.each(function(a){a._id=b.uniqueId("section"),a.tiles&&a.tiles.items&&a.tiles.items.each(function(c){Object.merge(c,a.tiles.default,!0,!1),c._id=b.uniqueId("tile"),c.link&&(c.link=c.link.assign(d))})}),a.sections.tiles&&a.sections.tiles.items&&a.sections.remove(function(a){return!a.tiles.items.length}))}catch(c){console.warn("Cannot parse dashboard response data")}return a}}})}function mpp$shopDashboardSvc(a,b){var c=[{label:"shop.filters.all",approval:"ALL"},{label:"shop.filters.needReview",approval:"REQUIRED"},{label:"shop.filters.noReview",approval:"NOT_REQUIRED"}];return a("api/dashboard/catalog",{},{get:{method:"GET",tracker:"shopDashboard$get",transformResponse:function(a){try{if(a=JSON.parse(a),a.httpStatusCode>=400)throw a;if(a?(a.reviewFilters=c,a.categories.add({displayName:"shop.filters.all",name:"ALL"},0)):a={},a.sections){a.sections.each(function(a){a._id=b.uniqueId("section")});var d=a.sections.findIndex(function(a){return a.type&&"FEATURED_CATEGORY"===a.type.category});a.header=-1!==d?a.sections.splice(d,1)[0]:{},a.sections.remove(function(a){return!a.tiles.items.length})}}catch(e){console.warn("Cannot parse shop dashboard response data")}return a}}})}!function(a,b){"use strict";function c(){function a(a,c){return b.extend(new(b.extend(function(){},{prototype:a})),c)}function c(a,b){var c=b.caseInsensitiveMatch,d={originalPath:a,regexp:a},e=d.keys=[];return a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(a,b,c,d){var f="?"===d?d:null,g="*"===d?d:null;return e.push({name:c,optional:!!f}),b=b||"",""+(f?"":b)+"(?:"+(f?b:"")+(g&&"(.+?)"||"([^/]+)")+(f||"")+")"+(f||"")}).replace(/([\/$\*])/g,"\\$1"),d.regexp=new RegExp("^"+a+"$",c?"i":""),d}var d={};this.when=function(a,e){if(d[a]=b.extend({reloadOnSearch:!0},e,a&&c(a,e)),a){var f="/"==a[a.length-1]?a.substr(0,a.length-1):a+"/";d[f]=b.extend({redirectTo:a},c(f,e))}return this},this.otherwise=function(a){return this.when(null,a),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(c,e,f,g,h,i,j,k){function l(a,b){var c=b.keys,d={};if(!b.regexp)return null;var e=b.regexp.exec(a);if(!e)return null;for(var f=1,g=e.length;g>f;++f){var h=c[f-1],i=e[f];h&&i&&(d[h.name]=i)}return d}function m(){var a=n(),d=q.current;a&&d&&a.$$route===d.$$route&&b.equals(a.pathParams,d.pathParams)&&!a.reloadOnSearch&&!p?(d.params=a.params,b.copy(d.params,f),c.$broadcast("$routeUpdate",d)):(a||d)&&(p=!1,c.$broadcast("$routeChangeStart",a,d),q.current=a,a&&a.redirectTo&&(b.isString(a.redirectTo)?e.path(o(a.redirectTo,a.params)).search(a.params).replace():e.url(a.redirectTo(a.pathParams,e.path(),e.search())).replace()),g.when(a).then(function(){if(a){var c,d,e=b.extend({},a.resolve);return b.forEach(e,function(a,c){e[c]=b.isString(a)?h.get(a):h.invoke(a)}),b.isDefined(c=a.template)?b.isFunction(c)&&(c=c(a.params)):b.isDefined(d=a.templateUrl)&&(b.isFunction(d)&&(d=d(a.params)),d=k.getTrustedResourceUrl(d),b.isDefined(d)&&(a.loadedTemplateUrl=d,c=i.get(d,{cache:j}).then(function(a){return a.data}))),b.isDefined(c)&&(e.$template=c),g.all(e)}}).then(function(e){a==q.current&&(a&&(a.locals=e,b.copy(a.params,f)),c.$broadcast("$routeChangeSuccess",a,d))},function(b){a==q.current&&c.$broadcast("$routeChangeError",a,d,b)}))}function n(){var c,f;return b.forEach(d,function(d){!f&&(c=l(e.path(),d))&&(f=a(d,{params:b.extend({},e.search(),c),pathParams:c}),f.$$route=d)}),f||d[null]&&a(d[null],{params:{},pathParams:{}})}function o(a,c){var d=[];return b.forEach((a||"").split(":"),function(a,b){if(0===b)d.push(a);else{var e=a.match(/(\w+)(.*)/),f=e[1];d.push(c[f]),d.push(e[2]||""),delete c[f]}}),d.join("")}var p=!1,q={routes:d,reload:function(){p=!0,c.$evalAsync(m)}};return c.$on("$locationChangeSuccess",m),q}]}function d(){this.$get=function(){return{}}}function e(a,c,d){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(e,f,g,h,i){function j(){l&&(l.$destroy(),l=null),m&&(d.leave(m),m=null)}function k(){var g=a.current&&a.current.locals,h=g&&g.$template;if(b.isDefined(h)){var k=e.$new(),p=a.current,q=i(k,function(a){d.enter(a,null,m||f,function(){!b.isDefined(n)||n&&!e.$eval(n)||c()}),j()});m=q,l=p.scope=k,l.$emit("$viewContentLoaded"),l.$eval(o)}else j()}var l,m,n=g.autoscroll,o=g.onload||"";e.$on("$routeChangeSuccess",k),k()}}}function f(a,b,c){return{restrict:"ECA",priority:-400,link:function(d,e){var f=c.current,g=f.locals;e.html(g.$template);var h=a(e.contents());if(f.controller){g.$scope=d;var i=b(f.controller,g);f.controllerAs&&(d[f.controllerAs]=i),e.data("$ngControllerController",i),e.children().data("$ngControllerController",i)}h(d)}}}var g=b.module("ngRoute",["ng"]).provider("$route",c);g.provider("$routeParams",d),g.directive("ngView",e),g.directive("ngView",f),e.$inject=["$route","$anchorScroll","$animate"],f.$inject=["$compile","$controller","$route"]}(window,window.angular),function(a,b,c){"use strict";function d(a){return null!=a&&""!==a&&"hasOwnProperty"!==a&&h.test("."+a)}function e(a,b){if(!d(b))throw g("badmember",'Dotted member path "@{0}" is invalid.',b);for(var e=b.split("."),f=0,h=e.length;h>f&&a!==c;f++){var i=e[f];a=null!==a?a[i]:c}return a}function f(a,c){c=c||{},b.forEach(c,function(a,b){delete c[b]});for(var d in a)!a.hasOwnProperty(d)||"$"===d.charAt(0)&&"$"===d.charAt(1)||(c[d]=a[d]);return c}var g=b.$$minErr("$resource"),h=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;b.module("ngResource",["ng"]).factory("$resource",["$http","$q",function(a,d){function h(a){return i(a,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function i(a,b){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,b?"%20":"+")}function j(a,b){this.template=a,this.defaults=b||{},this.urlParams={}}function k(h,i,r){function s(a,b){var c={};return b=o({},i,b),n(b,function(b,d){q(b)&&(b=b()),c[d]=b&&b.charAt&&"@"==b.charAt(0)?e(a,b.substr(1)):b}),c}function t(a){return a.resource}function u(a){f(a||{},this)}var v=new j(h);return r=o({},l,r),n(r,function(e,h){var i=/^(POST|PUT|PATCH)$/i.test(e.method);u[h]=function(h,j,k,l){var r,w,x,y={};switch(arguments.length){case 4:x=l,w=k;case 3:case 2:if(!q(j)){y=h,r=j,w=k;break}if(q(h)){w=h,x=j;break}w=j,x=k;case 1:q(h)?w=h:i?r=h:y=h;break;case 0:break;default:throw g("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var z=this instanceof u,A=z?r:e.isArray?[]:new u(r),B={},C=e.interceptor&&e.interceptor.response||t,D=e.interceptor&&e.interceptor.responseError||c;n(e,function(a,b){"params"!=b&&"isArray"!=b&&"interceptor"!=b&&(B[b]=p(a))}),i&&(B.data=r),v.setUrlParams(B,o({},s(r,e.params||{}),y),e.url);var E=a(B).then(function(a){var c=a.data,d=A.$promise;if(c){if(b.isArray(c)!==!!e.isArray)throw g("badcfg","Error in resource configuration. Expected response to contain an {0} but got an {1}",e.isArray?"array":"object",b.isArray(c)?"array":"object");e.isArray?(A.length=0,n(c,function(a){A.push(new u(a))})):(f(c,A),A.$promise=d)}return A.$resolved=!0,a.resource=A,a},function(a){return A.$resolved=!0,(x||m)(a),d.reject(a)});return E=E.then(function(a){var b=C(a);return(w||m)(b,a.headers),b},D),z?E:(A.$promise=E,A.$resolved=!1,A)},u.prototype["$"+h]=function(a,b,c){q(a)&&(c=b,b=a,a={});var d=u[h].call(this,a,this,b,c);return d.$promise||d}}),u.bind=function(a){return k(h,o({},i,a),r)},u}var l={get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}},m=b.noop,n=b.forEach,o=b.extend,p=b.copy,q=b.isFunction;return j.prototype={setUrlParams:function(a,c,d){var e,f,i=this,j=d||i.template,k=i.urlParams={};n(j.split(/\W/),function(a){if("hasOwnProperty"===a)throw g("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(a)&&a&&new RegExp("(^|[^\\\\]):"+a+"(\\W|$)").test(j)&&(k[a]=!0)}),j=j.replace(/\\:/g,":"),c=c||{},n(i.urlParams,function(a,d){e=c.hasOwnProperty(d)?c[d]:i.defaults[d],b.isDefined(e)&&null!==e?(f=h(e),j=j.replace(new RegExp(":"+d+"(\\W|$)","g"),function(a,b){return f+b})):j=j.replace(new RegExp("(/?):"+d+"(\\W|$)","g"),function(a,b,c){return"/"==c.charAt(0)?c:b+c})}),j=j.replace(/\/+$/,"")||"/",j=j.replace(/\/\.(?=\w+($|\?))/,"."),a.url=j.replace(/\/\\\./,"/."),n(c,function(b,c){i.urlParams[c]||(a.params=a.params||{},a.params[c]=b)})}},k}])}(window,window.angular),function(a,b,c){"use strict";b.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function(a,d){function e(){var a,e,f,i;for(a in h)k(g[a])&&d.cookies(a,c);for(a in g)e=g[a],b.isString(e)||(e=""+e,g[a]=e),e!==h[a]&&(d.cookies(a,e),i=!0);if(i){i=!1,f=d.cookies();for(a in g)g[a]!==f[a]&&(k(f[a])?delete g[a]:g[a]=f[a],i=!0)}}var f,g={},h={},i=!1,j=b.copy,k=b.isUndefined;return d.addPollFn(function(){var b=d.cookies();f!=b&&(f=b,j(b,h),j(b,g),i&&a.$apply())})(),i=!0,a.$watch(e),g}]).factory("$cookieStore",["$cookies",function(a){return{get:function(c){var d=a[c];return d?b.fromJson(d):d},put:function(c,d){a[c]=b.toJson(d)},remove:function(b){delete a[b]}}}])}(window,window.angular),function(a,b){"use strict";function c(){this.$get=["$$sanitizeUri",function(a){return function(b){var c=[];return f(b,i(c,function(b,c){return!/^unsafe/.test(a(b,c))})),c.join("")}}]}function d(a){var c=[],d=i(c,b.noop);return d.chars(a),c.join("")}function e(a){var b,c={},d=a.split(",");for(b=0;b<d.length;b++)c[d[b]]=!0;return c}function f(a,c){function d(a,d,f,h){if(d=b.lowercase(d),x[d])for(;s.last()&&y[s.last()];)e("",s.last());w[d]&&s.last()==d&&e("",d),h=t[d]||!!h,h||s.push(d);var i={};f.replace(m,function(a,b,c,d,e){var f=c||d||e||"";i[b]=g(f)}),c.start&&c.start(d,i,h)}function e(a,d){var e,f=0;if(d=b.lowercase(d))for(f=s.length-1;f>=0&&s[f]!=d;f--);if(f>=0){for(e=s.length-1;e>=f;e--)c.end&&c.end(s[e]);s.length=f}}var f,h,i,s=[],u=a;for(s.last=function(){return s[s.length-1]};a;){if(h=!0,s.last()&&z[s.last()])a=a.replace(new RegExp("(.*)<\\s*\\/\\s*"+s.last()+"[^>]*>","i"),function(a,b){return b=b.replace(p,"$1").replace(r,"$1"),c.chars&&c.chars(g(b)),""}),e("",s.last());else if(0===a.indexOf("<!--")?(f=a.indexOf("--",4),f>=0&&a.lastIndexOf("-->",f)===f&&(c.comment&&c.comment(a.substring(4,f)),a=a.substring(f+3),h=!1)):q.test(a)?(i=a.match(q),i&&(a=a.replace(i[0],""),h=!1)):o.test(a)?(i=a.match(l),i&&(a=a.substring(i[0].length),i[0].replace(l,e),h=!1)):n.test(a)&&(i=a.match(k),i&&(a=a.substring(i[0].length),i[0].replace(k,d),h=!1)),h){f=a.indexOf("<");var v=0>f?a:a.substring(0,f);a=0>f?"":a.substring(f),c.chars&&c.chars(g(v))}if(a==u)throw j("badparse","The sanitizer was unable to parse the following block of html: {0}",a);u=a}e()}function g(a){if(!a)return"";var b=E.exec(a),c=b[1],d=b[3],e=b[2];return e&&(D.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in D?D.textContent:D.innerText),c+e+d}function h(a){return a.replace(/&/g,"&amp;").replace(s,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function i(a,c){var d=!1,e=b.bind(a,a.push);return{start:function(a,f,g){a=b.lowercase(a),!d&&z[a]&&(d=a),d||A[a]!==!0||(e("<"),e(a),b.forEach(f,function(d,f){var g=b.lowercase(f),i="img"===a&&"src"===g||"background"===g;C[g]!==!0||B[g]===!0&&!c(d,i)||(e(" "),e(f),e('="'),e(h(d)),e('"'))}),e(g?"/>":">"))},end:function(a){a=b.lowercase(a),d||A[a]!==!0||(e("</"),e(a),e(">")),a==d&&(d=!1)},chars:function(a){d||e(h(a))}}}var j=b.$$minErr("$sanitize"),k=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,l=/^<\s*\/\s*([\w:-]+)[^>]*>/,m=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,n=/^</,o=/^<\s*\//,p=/<!--(.*?)-->/g,q=/<!DOCTYPE([^>]*?)>/i,r=/<!\[CDATA\[(.*?)]]>/g,s=/([^\#-~| |!])/g,t=e("area,br,col,hr,img,wbr"),u=e("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),v=e("rp,rt"),w=b.extend({},v,u),x=b.extend({},u,e("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),y=b.extend({},v,e("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),z=e("script,style"),A=b.extend({},t,x,y,w),B=e("background,cite,href,longdesc,src,usemap"),C=b.extend({},B,e("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),D=document.createElement("pre"),E=/^(\s*)([\s\S]*?)(\s*)$/;b.module("ngSanitize",[]).provider("$sanitize",c),b.module("ngSanitize").filter("linky",["$sanitize",function(a){var c=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,e=/^mailto:/;return function(f,g){function h(a){a&&n.push(d(a))}function i(a,c){n.push("<a "),b.isDefined(g)&&(n.push('target="'),n.push(g),n.push('" ')),n.push('href="'),n.push(a),n.push('">'),h(c),n.push("</a>")}if(!f)return f;for(var j,k,l,m=f,n=[];j=m.match(c);)k=j[0],j[2]==j[3]&&(k="mailto:"+k),l=j.index,h(m.substr(0,l)),i(k,j[0].replace(e,"")),m=m.substring(l+j[0].length);return h(m),a(n.join(""))}}])}(window,window.angular),angular.module("mppApp").controller("NavigationCtrl",["$scope","$document","$user","$organization","$session","orgSecurityBannerColorMap","translateSvc","HelpService","cart","SessionMgmtService","$window","about",function(a,b,c,d,e,f,g,h,i,j,k,l){a.cart=i,c.fetch().then(function(b){a.user=b.name,b.avatarImage&&(a.avatarStyle={"background-position":"center","background-size":"100%","background-image":"url('"+b.avatarImage+"')"})}),d.fetch().then(function(b){a.org=b}),a.showAbout=function(){l.show()},a.getHelpUrl=function(){return h.getCurrentHelpUrl()},a.hideSideBar=function(){a.visible=!1},a.showSideBar=function(){a.visible=!0},a.logout=function(){j.cleanup()},b.bind("keydown",function(b){27===b.which&&(a.hideSideBar(),a.$digest())})}]),angular.module("mppApp").controller("ExpiredCtrl",["$scope","$window","$location","$organization","$session","SessionMgmtService",function(a,b,c,d,e,f){d.fetch().then(function(b){a.org=b,f.cleanup()},function(){f.cleanup()}),a.bowser=bowser,a.closeWindow=function(){b.open("","_self").close()}}]),angular.module("mppApp").controller("DashboardCtrl",["$scope","$dashboard","toggleSvc",function(a,b,c){a.bannerToggle=c("dashboardBanner",!0),a.getData=function(){b.fetch().then(function(b){a.data=b},function(b){a.showError.merge(b.data),a.showError.enabled=!0})},a.showError=Object.extended({enabled:!1,action:a.getData}),a.getData()
}]),angular.module("mppApp").controller("SpecialCategoryCtrl",["$scope","$location","$routeParams","$translate","serviceSvc","subscriptionSvc",function(a,b,c,d,e,f){var g={new_releases:"NEW_RELEASES",most_requested:"MOST_REQUESTED"},h=b.path().split("/")[1],i=b.path().split("/")[2];a.totalCount=0,a.services=[],a.subscriptions=[],a.translate=d,a.query={count:10},a.next=function(b){b?a.query.offset=0:a.query.offset+=a.query.count,"featuredSubscriptions"===h?f.query(Object.merge(a.query,{category:"EXPIRING_SOON",sort:"expiryDate",status:"ACTIVE"}),function(c,d){a.callback(a.subscriptions,c,d,b)}):e.query(Object.merge(a.query,{category:g[i],sort:"ascend"}),function(c,d){a.callback(a.services,c,d,b)})},a.callback=function(b,c,d,e){a.totalCount=1*d("mpp-totalCount"),e?b.splice.apply(b,[0,b.length].concat(c)):b.splice.apply(b,[b.length,0].concat(c))},a.next(!0)}]),angular.module("mppApp").controller("ApprovalListCtrl",["$scope","$routeParams","$location","$route","$translate","translateSvc","approvalSvc","$apiSort","$apiFilter","categoryOptionsSvc","approvalAction",function(a,b,c,d,e,f,g,h,i,j,k){a.query={count:10,sort:"newest",reqType:"ALL",status:"ALL"},a.approvals=[],a.translate=e,f.checkAvailability(function(){a.sortFilters=h.getServiceSortings(),a.requestTypes=i.getRequestTypes(),a.statusFilters=i.getApprovalStatus()}),a.showError=Object.extended({enabled:!1}),Object.merge(a.query,Object.select(b,"category","search","sort","status")),a.next=function(b){b?a.query.offset=0:a.query.offset+=a.query.count,a.updatePath(),a.getData(b)},a.getData=function(b){g.query(Object.extended(a.query).findAll(/^(?!ALL)/),function(c,d){a.totalCount=1*d("mpp-totalCount"),b?a.approvals.splice.apply(a.approvals,[0,a.approvals.length].concat(c)):a.approvals.splice.apply(a.approvals,[a.approvals.length,0].concat(c))},function(c){a.showError.merge(Object.merge(c.data,{action:a.getData,params:[b]})),a.showError.enabled=!0})},a.updatePath=function(){c.replace(),c.search(Object.reject(a.query,"count","offset"))},a.callback=function(){d.reload()},a.deny=function(b,d){k.deny(b,d,a.callback,function(e){a.showError.merge(Object.merge(e.data,{action:a.deny,params:[b,d]})),a.showError.enabled=!0,c.path("/approval")})},a.approve=function(b,d){k.approve(b,d,a.callback,function(e){a.showError.merge(Object.merge(e.data,{action:a.approve,params:[b,d]})),c.path("/approval")})},a.canAct=function(a){return"DECISION_PENDING"===a?!0:!1},a.next(!0)}]),angular.module("mppApp").controller("ApprovalDetailCtrl",["$scope","$location","$route","$routeParams","approvalSvc","approvalAction",function(a,b,c,d,e,f){a.showConfiguration=!1,a.showDetails=!0,a.showError=Object.extended({enabled:!1}),a.getData=function(){e.get({id:d.id},function(b){a.data=b},function(b){a.showError.merge(Object.merge(b.data,{action:a.getData})),a.showError.enabled=!0})},a.getData(),a.callback=function(b){a.data.status=b},a.deny=function(){f.deny(a.data.id,d.catalogId,a.callback,function(b){a.showError.merge(Object.merge(b.data,{action:a.deny})),a.showError.enabled=!0})},a.approve=function(){f.approve(a.data.id,d.catalogId,a.callback,function(b){a.showError.merge(Object.merge(b.data,{action:a.approve})),a.showError.enabled=!0})},a.canAct=function(a){return"DECISION_PENDING"===a?!0:!1}}]),angular.module("mppApp").controller("ServiceListCtrl",["$scope","$routeParams","$location","$translate","translateSvc","$apiSort","$apiFilter","serviceSvc","categoryOptionsSvc","promiseTracker","renderSelect",function(a,b,c,d,e,f,g,h,i,j,k){var l=Date.create("7 days ago"),m=Date.create();a.services=[],a.translate=d;var n=i.getService();n.then(function(b){a.categories=b,k.render("#filterCategory")}),e.checkAvailability(function(){a.sortFilters=f.getServiceSortings(),a.serviceTypeFilters=g.getServiceTypes()}),a.query={count:10,sort:"ascend",layout:"list",approval:"ALL",category:"ALL"},a.featured=b.featured,Object.merge(a.query,Object.select(b,"category","search","sort","layout","featured","approval")),a.next=function(b){b?(a.query.offset=0,a.updatePath()):a.query.offset+=a.query.count,a.getData(b)},a.getData=function(b){h.query(Object.extended(a.query).reject("layout").findAll(/^(?!ALL)/),function(c,d){a.totalCount=1*d("mpp-totalCount"),b?a.services.splice.apply(a.services,[0,a.services.length].concat(c)):a.services.splice.apply(a.services,[a.services.length,0].concat(c))},function(c){Object.merge(a.showError,c.data),a.showError.params=[b],a.showError.enabled=!0})},a.showError={enabled:!1,action:a.getData},a.isRecentlyAdded=function(a){return new Date(a).isBetween(l,m)},a.updatePath=function(){c.replace(),c.search(Object.reject(a.query,"count","offset"))},a.next(!0)}]),angular.module("mppApp").controller("ServiceDetailCtrl",["$scope","$window","$session","$sce","$translate","$location","$routeParams","$modal","$timeout","$organization","SingleServiceCheckout","serviceSvc","$filter","pricingCalculatorSvc","cart","dfSummaryRenderer",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a){h.messageBox("cart.modal.merged.title","cart.modal.merged.message",[{label:"common.ok",cssClass:"btn-primary",result:"ok",id:"ok-"+a.id,focus:!0}]).open().result.then(function(a){"ok"===a&&f.path("/cart")})}a.summaryRenderer=p,a.user=c.get("user"),a.catalogId=g.catalogId,a.basedOn=g.basedOn,j.fetch().then(function(b){a.portalShowTermsOfUse=b.portalShowTermsOfUse||!1,a.isEnforceEndDate=b.portalEnforceEndDate||!1,a.configEndDate=b.portalEndDatePeriod||12,a.securityLevel=b.securityLevel,a.request={startDate:Date.create("today"),endDate:Date.create("today").addMonths(a.configEndDate),subscriptionPeriod:"term",isGroupOwned:!1},a.$watch("request.subscriptionPeriod",function(b){"term"!==b?(a.dateOptions.endDateRequired=!1,a.dateOptions.endDateDisabled=!0):(a.dateOptions.endDateRequired=!0,a.dateOptions.endDateDisabled=!1)}),a.dateOptions={minStartDate:Date.create("today"),maxStartDate:a.request.endDate,minEndDate:Date.create(a.request.startDate).addDays(1),maxEndDate:a.request.endDate,startDateRequired:!0,endDateRequired:a.isEnforceEndDate}}),a.showDetails=!0,a.showError={enabled:!1},a.checkout=new k,a.submit=function(){a.checkout.submit(a.getCheckoutInfo()).catch(function(b){a.fileError=413===b.status,Object.merge(a.showError,b.data),a.showError.action=a.onCheckout,a.showError.enabled=!0})},a.addToCart=function(b){var c={};b.each(function(a){c[a.id]=a.value});var d=Object.select(a.checkout.item,"initPrice","recurringPrice");d.initPrice.price=a.initPrice,d.recurringPrice.price=a.recurringPrice,o.addItem(a.checkout.item,c,d).then(function(a){a.merged?q(a):f.path("/cart")},function(c){Object.merge(a.showError,c.data),a.showError.action=a.addToCart,a.showError.params=[b],a.showError.enabled=!0})},a.back=function(b){"confirmation"===b?a.checkout.reset():"checkout"===b?a.checkout.makeChanges():f.path("/service")},a.backLabel=function(a){return"confirmation"===a||"checkout"===a?"services.detail.title":"detail"===a?"services.title":"services.checkout.title"},a.getCheckoutInfo=function(){var b={name:a.request.subscriptionName||a.checkout.item.displayName,description:a.request.subscriptionDescription,startDate:a.request.startDate};return"term"===a.request.subscriptionPeriod&&(b.endDate=a.request.endDate),a.request.isGroupOwned&&(b.userGroup=a.request.userGroup),b.files=a.files,b};var r=Object.extended({serviceId:g.id,catalog:g.catalogId,category:g.category});a.basedOn&&r.merge({basedOn:a.basedOn}),a.pageSubmit=function(){l.get(r,function(b){a.basedOn&&(b.basedOn=a.basedOn),a.checkout=new k(b),a.$watch("checkout.item",function(){a.updatePricing()},!0)},function(b){Object.merge(a.showError,b.data,!1),a.showError.action=a.pageSubmit,a.showError.params=[],a.showError.enabled=!0})},a.pageSubmit(),a.getGroupOwnership=function(){var b="<strong><span>"+e("common.on")+"</span></strong>",c="<strong><span>"+e("common.off")+"</span></strong>",f=e("services.checkout.groupOwnershipIs",{status:b}),g=e("services.checkout.groupOwnershipIs",{status:c});return a.request.isGroupOwned?a.groupOwnershipOn=d.trustAsHtml(f):a.groupOwnershipOff=d.trustAsHtml(g)},a.extractOptions=function(){var b=a.checkout.item.fields||[],c=function(a){return angular.isObject(a)?a.value:a};return b.each(function(a){a.value=angular.isArray(a.value)?a.value.map(c):c(a)}),b},a.initPrice=void 0,a.recurringPrice=void 0,a.updatePricing=function(){if(a.checkout.item&&a.checkout.item.fields){var b=angular.copy(m("selectedFields")(a.checkout.item.fields)),c=function(a){return angular.isObject(a)?a.value:a};b.each(function(a){a.value=angular.isArray(a.value)?a.value.map(c):c(a)}),a.initPrice=n.totalInitialPrice(a.checkout.item,b),a.recurringPrice=n.totalRecurringPrice(a.checkout.item,b)}},a.openImages=function(b){h.imageCarousel(a.checkout.item.screenshots,b)},a.removeFile=function(b){a.files.splice(b,1)},a.files=[],a.allowAttachments=window.FormData?!0:!1,a.$on("fileSelected",function(b,c){var d=a.files.findIndex(function(a){return a.name==c.file.name});a.$apply(function(){-1===d&&a.files.push(c.file)});var e=angular.element("#fileUpload");e.replaceWith(e=e.clone(!0))})}]),angular.module("mppApp").controller("requestCtrl",["$scope","$routeParams","$location","$translate","translateSvc","$apiSort","$apiFilter","requestAction","requestSvc","listActions",function(a,b,c,d,e,f,g,h,i,j){var k,l=function(a){a.requestState=a.approvalStatus="CANCELLED",a.pending=!1},m=function(a){a.inProgress=!0,a.processing=!0};a.nextBatch=[],a.haveProcessingItems=!1,a.showError=Object.extended({enabled:!1}),a.updateCanceledItems=function(b){var c=a.requestData;b.forEach(function(a){var b=c.find(function(b){return b.id===a});l(b)})},a.removeDeletedItems=function(b){var c=a.requestData;b.length>0&&(a.haveProcessingItems=!0),b.forEach(function(a){var b=c.find(function(b){return b.id===a});m(b)})},a.deleteAgainCallback=function(b){a.loadNextBatch(!0,!0,b)},k={removeDeletedItems:a.removeDeletedItems,deleteAgainCallback:a.deleteAgainCallback};var n=new j("request.modal.title",i,h,a.updateCanceledItems,k);h.setListActionsInstance(n),a.requestData=[],a.translate=d,e.checkAvailability(function(){a.serviceSortings=f.getServiceSortings(),a.requestTypes=g.getRequestTypes(),a.requestStates=g.getRequestStates()}),a.query={count:10,reqType:"ALL",reqState:"ALL",sort:"newest"},Object.merge(a.query,Object.select(b,"search","sort","reqType","reqState")),a.iconForRequestType=function(a){return h.iconForRequestType(a)},a.updatePath=function(){c.search(Object.reject(a.query,"count","offset"))},a.cancelRequest=function(b){h.singleCancel(b,function(b){l(a.requestData.find({id:b}))},function(c){a.showError.merge(Object.merge(c.data,{action:a.cancelRequest,params:[b]})),a.showError.enabled=!0})},a.deleteRequest=function(b){h.singleDelete(b,function(){m(a.requestData.find({id:b}))},function(c){a.showError.merge(Object.merge(c.data,{action:a.deleteRequest,params:[b]})),a.showError.enabled=!0})},a.loadNextBatch=function(b,c,d){b?a.query.offset=d:a.query.offset+=a.query.count,i.query(Object.extended(a.query).findAll(/^(?!ALL)/),function(b,d){a.totalCount=1*d("mpp-totalCount"),a.requestData.splice.apply(a.requestData,[a.requestData.length,0].concat(b)),c&&(a.nextBatch.splice.apply(a.nextBatch,[0,a.nextBatch.length].concat(b)),h.setDataAnalysis(a.nextBatch),h.multiDelete(k))})},a.updateOffsetAndLoadList=function(){var b=h.getRemainingCount()===Math.floor((a.totalCount-a.query.offset)/10)-1;h.setDataAnalysis(a.requestData);var c=h.getDataAnalysis();a.loadNextBatch(b,!1,c.total-c.processingListCounter)},a.resetOffsetAndLoadList=function(b){b?a.query.offset=0:a.query.offset+=a.query.count,a.updatePath(),a.getRequest(b)},a.next=function(b){a.haveProcessingItems?a.updateOffsetAndLoadList():b?a.resetOffsetAndLoadList(!0):a.resetOffsetAndLoadList()},a.getRequest=function(b){i.query(Object.extended(a.query).findAll(/^(?!ALL)/),function(c,d){a.totalCount=1*d("mpp-totalCount"),b?a.requestData.splice.apply(a.requestData,[0,a.requestData.length].concat(c)):a.requestData.splice.apply(a.requestData,[a.requestData.length,0].concat(c))},function(c){a.showError.merge(Object.merge(c.data,{action:a.getRequest,params:[b]})),a.showError.enabled=!0})},a.popupListActionsModal=function(){h.setRemainingCount(Math.floor((a.totalCount-a.query.offset)/10)),h.setDataAnalysis(a.requestData),n.showListActionModal(h.getDataAnalysis(),function(b){a.showError.merge(Object.merge(b.data,{action:a.popupListActionsModal,params:[]})),a.showError.enabled=!0})},a.next(!0)}]),angular.module("mppApp").controller("RequestDetailCtrl",["$scope","$routeParams","$location","$modal","$organization","requestAction","requestSvc","orderSvc","wizardSvc",function(a,b,c,d,e,f,g,h,i){function j(b){i.list(function(c){c&&c.length>0&&c.find(function(a){return a.serviceId===b.service.id})&&(a.originalOfferingType="wizard")})}function k(){d.messageBox("request.modal.resubmit.title","request.modal.resubmit.message",[{label:"request.title",cssClass:"btn-primary",result:"goto",id:"confirm-goto"},{label:"common.close",cssClass:"btn-info",result:"close",id:"confirm-close"}]).open().result.then(function(a){"goto"===a&&m()})}function l(){d.messageBox("request.modal.resubmit.error.title","request.modal.resubmit.error.message",[{label:"common.ok",cssClass:"btn-danger",result:"ok",id:"confirm-ok"}]).open()}var m=function(){c.path("/request")};a.showError=Object.extended({enabled:!1}),a.catalogId=b.catalogId,a.originalOfferingType="service",a.showConfiguration=!1,a.showDetails=!0,a.iconForRequestType=function(a){return f.iconForRequestType(a)},a.iconForStatus=function(a){return f.iconForRequestStatus(a)},a.getRequest=function(){g.get({id:b.id,catalogId:b.catalogId},function(b){a.data=b,j(b),b.orderId&&n(b)},function(b){a.showError.merge(Object.merge(b.data,{action:a.getRequest})),a.showError.enabled=!0})},a.getRequest();var n=function(b){h.get({id:b.orderId,filterRequestId:b.id}).$promise.then(function(b){a.order=b.members},function(b){a.showError.merge(Object.merge(b.data,{action:n})),a.showError.enabled=!0})};a.cancelRequest=function(b){f.singleCancel(a.data.id,function(){b.requestState=b.approvalStatus="CANCELLED",b.pending=!1,m()},function(b){a.showError.merge(Object.merge(b.data,{action:a.cancelRequest})),a.showError.enabled=!0})},a.deleteRequest=function(b){f.singleDelete(b.id,function(){b.inProgress=!0,b.processing=!0,m()},function(b){a.showError.merge(Object.merge(b.data,{action:a.deleteRequest})),a.showError.enabled=!0})},a.isReorderable=function(){return a.data?"ORDER"===a.data.requestedAction&&a.data.reorderable:!1},a.redirectToRequest=function(a){c.path("/request/"+a)},a.isRemodifiable=function(){return a.data?"MODIFY_SUBSCRIPTION"===a.data.requestedAction&&a.data.resubmitable:!1},a.resubmitModifyRequest=function(){var a=g.resubmitModifyRequest({id:b.id,basedOn:b.id,catalogId:b.catalogId},{action:"RESUBMIT_REQUEST"});a.$promise.then(function(){k()},function(){l()})}}]),angular.module("mppApp").controller("SubscriptionDetailCtrl",["$scope","$routeParams","$translate","$location","subscriptionSvc","subscriptionAction","$user",function(a,b,c,d,e,f,g){g.fetch().then(function(b){a.user=b.name}),a.showRequest=function(){return a.data&&a.data.owner&&a.user?a.data.owner.toLowerCase()===a.user.toLowerCase():!1};var h=function(){d.path("/subscription")};a.showError=Object.extended({enabled:!1}),a.getSubscription=function(){e.get({id:b.id},function(b){a.data=b},function(b){a.showError.merge(Object.merge(b.data,{action:a.getSubscription})),a.showError.enabled=!0})},a.getSubscription(),a.cancelSubscription=function(){f.singleCancel(a.data.id,a.data.catalogId,h,function(b){a.showError.merge(Object.merge(b.data,{action:a.cancelSubscription})),a.showError.enabled=!0})},a.deleteSubscription=function(){f.singleDelete(a.data.id,h,function(b){a.showError.merge(Object.merge(b.data,{action:a.deleteSubscription})),a.showError.enabled=!0})},a.getModifySubscriptionLabel=function(){return c("MODIFY_FAILED"===a.data.instanceState?"subscription.detail.links.modifySubscription.resubmitButton":"subscription.detail.links.modifySubscription.button")}}]),angular.module("mppApp").controller("ModifySubscriptionCtrl",["$scope","$session","$window","$sce","$translate","$routeParams","$organization","ModifySubscriptionCheckout","subscriptionSvc","$filter","pricingCalculatorSvc","dfSummaryRenderer",function(a,b,c,d,e,f,g,h,i,j,k,l){a.summaryRenderer=l,a.showDetails=!1,a.checkoutInfo=Object.extended(),a.dateOptions=Object.extended(),a.checkout={},g.fetch().then(function(b){a.portalShowTermsOfUse=b.portalShowTermsOfUse||!1,a.isEnforceEndDate=b.portalEnforceEndDate||!1,a.configEndDate=b.portalEndDatePeriod||12,a.securityLevel=b.securityLevel,i.get({id:f.id,action:"MODIFY"},function(b){a.checkout=new h(b);var c,d,e=a.checkout.item.subscriptionTerm.startDate,f=a.checkout.item.subscriptionTerm.endDate;a.checkoutInfo.startDate=Date.create(e?e:"today"),f?(a.checkoutInfo.endDate=Date.create(f),c=a.checkoutInfo.endDate,a.checkoutInfo.subscriptionPeriod="term",a.dateOptions.merge({endDateRequired:a.isEnforceEndDate,endDateDisabled:!1})):(a.checkoutInfo.endDate=null,c=d=Date.create(a.checkoutInfo.startDate).addMonths(a.configEndDate),a.checkoutInfo.subscriptionPeriod="recurring",a.isEnforceEndDate&&(a.checkoutInfo.subscriptionPeriod="term"),a.dateOptions.merge({endDateRequired:a.isEnforceEndDate,endDateDisabled:!0})),a.dateOptions.merge({minStartDate:a.checkoutInfo.startDate,maxStartDate:c,minEndDate:Date.create(a.checkoutInfo.startDate).addDays(1),maxEndDate:d,startDateRequired:!0,startDateDisabled:!0}),a.checkoutInfo.subsName=a.checkout.item.name,a.checkoutInfo.subsDesc=a.checkout.item.description,a.checkout.item.userGroups?(a.showGroupOwnership=!0,a.checkoutInfo.groupOwned=a.checkout.item.selectedUserGroup?!0:!1,a.userGroups=a.checkout.item.userGroups,a.checkoutInfo.group=a.userGroups.find(function(b){return b.name===a.checkout.item.selectedUserGroup})):a.showGroupOwnership=!1,a.initPrice=a.checkout.item.initPrice.price,a.recurringPrice=a.checkout.item.recurringPrice.price,a.modifiableOptions=b.modifiableOptions,a.modifiableOptions||a.checkout.checkout(a.extractOptions())})}),a.$watch("checkout.item",function(){a.updatePricing()},!0),a.$watch("checkoutInfo.subscriptionPeriod",function(b){"term"!==b?(a.dateOptions.endDateRequired=!1,a.dateOptions.endDateDisabled=!0):(a.dateOptions.endDateRequired=!0,a.dateOptions.endDateDisabled=!1)}),a.back=function(){c.history.back()},a.extractOptions=function(){var b=a.checkout.item.fields||[],c=function(a){return angular.isObject(a)?a.value:a};return b.each(function(a){a.value=angular.isArray(a.value)?a.value.map(c):c(a)}),b},a.updatePricing=function(){if(a.checkout.item&&a.checkout.item.fields){var b=angular.copy(j("selectedFields")(a.checkout.item.fields)),c=function(a){return angular.isObject(a)?a.value:a};b.each(function(a){a.value=angular.isArray(a.value)?a.value.map(c):c(a)}),a.initPrice=k.totalInitialPrice(a.checkout.item,b),a.recurringPrice=k.totalRecurringPrice(a.checkout.item,b)}},a.getGroupOwnership=function(){var b="<strong><span>"+e("common.on")+"</span></strong>",c="<strong><span>"+e("common.off")+"</span></strong>",f=e("services.checkout.groupOwnershipIs",{status:b}),g=e("services.checkout.groupOwnershipIs",{status:c});return a.checkoutInfo.groupOwned?a.groupOwnershipOn=d.trustAsHtml(f):a.groupOwnershipOff=d.trustAsHtml(g)}}]),angular.module("mppApp").controller("SubscriptionListCtrl",["$scope","$translate","translateSvc","$routeParams","$location","subscriptionSvc","$apiSort","$apiFilter","categoryOptionsSvc","subscriptionAction","listActions","renderSelect",function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n=function(a){a.cancelable="",a.deletable="",a.processing=!0},o=function(a){a.cancelable="",a.deletable="",a.processing=!0};a.nextBatch=[],a.haveProcessingItems=!1,a.updateCanceledItems=function(b){var c=a.subscriptions;b.length>0&&(a.haveProcessingItems=!0),b.forEach(function(a){var b=c.find(function(b){return b.id===a.id});n(b)})},a.removeDeletedItems=function(b){var c=a.subscriptions;b.length>0&&(a.haveProcessingItems=!0),b.forEach(function(a){var b=c.find(function(b){return b.id===a});o(b)})},a.deleteAgainCallback=function(b){a.loadNextBatch(!0,!0,b)},m={removeDeletedItems:a.removeDeletedItems,deleteAgainCallback:a.deleteAgainCallback};var p=new k("subscription.modal.title",f,j,a.updateCanceledItems,m);j.setListActionsInstance(p),a.query={count:10,sort:"newest",category:"ALL",status:"ALL"},a.translate=b,a.subscriptions=[];var q=i.getSubscription();q.then(function(b){a.categories=b,l.render("#filterCategory")}),c.checkAvailability(function(){a.sortFilters=g.getServiceSortings(),a.statusFilters=h.getSubscriptionStates()}),Object.merge(a.query,Object.select(d,"category","search","sort","status")),a.showError=Object.extended({enabled:!1}),a.loadNextBatch=function(b,c,d){b?a.query.offset=d:a.query.offset+=a.query.count,f.query(Object.extended(a.query).findAll(/^(?!ALL)/),function(b,d){a.totalCount=1*d("mpp-totalCount"),a.subscriptions.splice.apply(a.subscriptions,[a.subscriptions.length,0].concat(b)),c&&(a.nextBatch.splice.apply(a.nextBatch,[0,a.nextBatch.length].concat(b)),j.setDataAnalysis(a.nextBatch),j.multiDelete(m))})},a.updateOffsetAndLoadList=function(){var b=j.getRemainingCount()===Math.floor((a.totalCount-a.query.offset)/10)-1;j.setDataAnalysis(a.subscriptions);var c=j.getDataAnalysis();a.loadNextBatch(b,!1,c.total-c.processingListCounter)},a.resetOffsetAndLoadList=function(b){b?(a.query.offset=0,a.updatePath()):a.query.offset+=a.query.count,a.getSubscription(b)},a.next=function(b){a.haveProcessingItems?a.updateOffsetAndLoadList():b?a.resetOffsetAndLoadList(!0):a.resetOffsetAndLoadList()},a.updatePath=function(){e.replace(),e.search(Object.reject(a.query,"count","offset"))},a.getSubscription=function(b){f.query(Object.extended(a.query).findAll(/^(?!ALL)/),function(c,d){a.totalCount=1*d("mpp-totalCount"),b?a.subscriptions.splice.apply(a.subscriptions,[0,a.subscriptions.length].concat(c)):a.subscriptions.splice.apply(a.subscriptions,[a.subscriptions.length,0].concat(c))},function(c){a.showError.merge(Object.merge(c.data,{action:a.getSubscription,params:[b]})),a.showError.enabled=!0})},a.updatePath=function(){e.replace(),e.search(Object.reject(a.query,"count","offset"))},a.cancelSubscription=function(b){j.singleCancel(b.id,b.catalogId,function(b){n(a.subscriptions.find({id:b}))},function(c){a.showError.merge(Object.merge(c.data,{action:a.cancelSubscription,params:[b]})),a.showError.enabled=!0})},a.deleteSubscription=function(b){j.singleDelete(b.id,function(){o(a.subscriptions.find({id:b.id}))},function(c){a.showError.merge(Object.merge(c.data,{action:a.deleteSubscription,params:[b]})),a.showError.enabled=!0})},a.popupListActionsModal=function(){j.setRemainingCount(Math.floor((a.totalCount-a.query.offset)/10)),j.setDataAnalysis(a.subscriptions),p.showListActionModal(j.getDataAnalysis(),function(b){a.showError.merge(Object.merge(b.data,{action:a.popupListActionsModal,params:[]})),a.showError.enabled=!0})},a.next(!0)}]),angular.module("mppApp").controller("MyServiceListCtrl",["$scope","$translate","$routeParams","$location","myserviceSvc","$apiSort","$apiFilter","categoryOptionsSvc","myserviceColorMap","translateSvc","renderSelect",function(a,b,c,d,e,f,g,h,i,j,k){a.getColor=i.getColor,a.query={count:10,sort:"newest",category:"ALL",status:"ALL"},a.translate=b,a.myServices=[];var l=h.getSubscription();l.then(function(b){a.categories=b,k.render("#filterCategory")}),j.checkAvailability(function(){a.sortFilters=f.getServiceSortings(),a.statusFilters=g.getServiceInstanceStates()}),Object.merge(a.query,Object.select(c,"category","search","sort","status")),a.next=function(b){b?a.query.offset=0:a.query.offset+=a.query.count,a.updatePath(),a.getData(b)},a.getData=function(b){e.query(Object.extended(a.query).findAll(/^(?!ALL)/),function(c,d){a.totalCount=1*d("mpp-totalCount"),b?a.myServices.splice.apply(a.myServices,[0,a.myServices.length].concat(c)):a.myServices.splice.apply(a.myServices,[a.myServices.length,0].concat(c))},function(c){a.showError.merge(Object.merge(c.data,{params:[b]})),a.showError.enabled=!0})},a.showError=Object.extended({enabled:!1,action:a.getData}),a.updatePath=function(){d.replace(),d.search(Object.reject(a.query,"count","offset"))},a.translateStatus=function(a){return j.translateDataValue("myservice.status."+a.toUpperCase().replace(" ","_"))},a.next(!0)}]),angular.module("mppApp").controller("MyServiceDetailCtrl",["$scope","$routeParams","$translate","$filter","$modal","$sce","myserviceSvc","myserviceColorMap","myserviceUtil","$route",function(a,b,c,d,e,f,g,h,i,j){a.getColor=h.getColor,a.serviceActions=[c("myservice.action.DEFAULT")],a.instanceAction=a.serviceActions[0],a.showError=Object.extended({enabled:!1}),a.launchURL=function(a){var b=a?a.find(function(a){return"launchURL"===a.name}):null;return b?b.value.first():!1},a.reload=j.reload,a.onComponentAction=function(b,c,d){var f;d?f=b:(f=Object.clone(b,!0),k(f.properties)),e.open({templateUrl:"views/myservice/actionDialog.html",controller:"ComponentActionCtrl",resolve:{model:function(){return{action:f,instanceName:a.data.id,componentId:c}}}}).result.then(function(d){"execute"===d&&g.post({id:b.refId,catalog:a.data.catalogId},{action:f.name,subscriptionId:a.data.subscriptionId,fields:f.properties?i.buildFields(f.properties):null}).$promise.then(a.showSuccess,function(b){a.showError.merge(Object.merge(b.data,{action:a.onComponentAction,params:[f,c,!0]})),a.showError.enabled=!0})})};var k=function(a){a&&a.each(function(a){switch(a._value=a.value&&a.value.length>0&&"ENUM"!==a.valueType?a.value[0]:null,a.valueType){case"INTEGER":a._value=angular.isNumber(a._value)?a._value.toNumber():0;break;case"ENUM":a._value=a.value,a.value=null}})};a.showSuccess=function(b){e.open({templateUrl:"views/myservice/actionSuccess.html",controller:"ActionSuccessBoxCtrl",resolve:{model:function(){return{id:b.id,cid:a.data.catalogId}}}}).result.then(function(b){"refresh"===b&&a.reload()})},a.openImages=function(b){e.imageCarousel(a.data.screenshots,b)},a.getDetails=function(){g.get({id:b.id,catalog:b.catalogId},function(c){a.data=c,a.serviceInstanceId=b.id,c.serviceInstance&&c.serviceInstance.serviceAction&&c.serviceInstance.serviceAction.each(function(b){a.serviceActions.push(b.displayName)}),c.components&&c.components.each(function(a){a.actions=i.buildComponentActions(a),a._specialProperties=i.getSpecialProperties(a.properties),i.removeSpecialProperties(a.properties),a._specialProperties.externalViewURL&&(a._specialProperties.externalViewURL=f.trustAsResourceUrl(a._specialProperties.externalViewURL))})},function(b){a.showError.merge(Object.merge(b.data,{action:a.getDetails,params:[]})),a.showError.enabled=!0})},a.getDetails()}]).controller("ActionSuccessBoxCtrl",["$scope","$modalInstance","model",function(a,b,c){a.id=c.id,a.cid=c.cid,a.close=function(a){b.close(a)}}]).controller("ComponentActionCtrl",["$scope","$modalInstance","model","myserviceActionSvc","myserviceUtil",function(a,b,c,d,e){a.action=c.action,a.showDetails=!0;var f;a.action.properties&&(f=a.action.properties.filter(function(a){return"ENUM"===a.valueType&&a.dynamicValueEnabled})),a.close=function(a){b.close(a)},a.onEnumChange=function(b){if(b.dynamicValueEnabled){var c;f.exclude(function(a){return a.name===b.name}).forEach(function(b){c?c.then(function(){a.getListData(b)}):c=a.getListData(b)})}},a.getListData=function(a,b){var f={propertyName:a.name,actionName:c.action.name,fields:e.buildFields(c.action.properties)},g=d.post({id:c.instanceName,cid:c.componentId},f);return b||g.$promise.then(function(b){angular.equals(Object.reject(b,/[$].*/),{})?a.value=a._value=null:a._value&&angular.equals(a._value,b)||(a.value=null,a._value=b)},function(){console.error("Failed to fetch",a.name)}),g.$promise},f&&f.length&&(a.getListData(f[0]),f.length>1&&a.onEnumChange(f[0]))}]),angular.module("mppApp").controller("NotificationListCtrl",["$scope","$routeParams","$location","$translate","translateSvc","$apiSort","promiseTracker","notificationSvc","$apiFilter",function(a,b,c,d,e,f,g,h,i){a.data=[],a.translate=d,e.checkAvailability(function(){a.sortFilters=f.getNotificationSortings(),a.dateFilters=i.getNotificationDateFilter()}),a.promise=g("notification$query"),a.query={count:20,sort:"newest",dateRange:"ALL"},Object.merge(a.query,Object.select(b,"search","sort","dateRange")),a.next=function(b){b?(a.query.offset=0,a.updatePath()):a.query.offset+=a.query.count,a.getData(b)},a.getData=function(b){h.query(Object.extended(a.query).findAll(/^(?!ALL)/),function(c,d){a.totalCount=1*d("mpp-totalCount"),b?a.data.splice.apply(a.data,[0,a.data.length].concat(c)):a.data.splice.apply(a.data,[a.data.length,0].concat(c))},function(c){a.showError.merge(Object.merge(c.data,{params:[b]})),a.showError.enabled=!0})},a.showError=Object.extended({enabled:!1,action:a.getData}),a.updatePath=function(){c.replace(),c.search(Object.reject(a.query,"count","offset"))},a.next(!0)}]),angular.module("mppApp").controller("NotificationDetailCtrl",["$scope","$routeParams","notificationSvc","$session",function(a,b,c,d){a.showError=Object.extended({enabled:!1}),a.getData=function(){c.get({notificationId:b.id},function(b){a.data=b,a.user=d.get("user").name},function(b){a.showError.merge(b.data),a.showError.enabled=!0})},a.getData()}]),angular.module("mppApp").controller("WizardCtrl",["$scope","$route","$routeParams","$organization","wizardSvc","promiseTracker","$filter","WizardCheckout","pricingCalculatorSvc",function(a,b,c,d,e,f,g,h,i){a.serviceId=c.id,a.category=c.category,a.catalogId=c.catalog,a.showError=Object.extended({enabled:!1}),f("wizard$get").on("error",function(b){Object.merge(a.showError,b.data,!1,!1),a.showError.action=a.loadWizard,a.showError.enabled=!0}),a.servicePostTracker=f("service$post"),a.servicePostTracker.on("error",function(b){Object.merge(a.showError,b.data,!1,!1),a.showError.action=a.submitWizard,a.showError.enabled=!0}),a.loadWizard=function(){e.get({id:a.serviceId,catalog:a.catalogId,category:a.category},function(b){a.checkout=new h(b),a.$watch("checkout.item",function(){a.updatePricing()},!0)})},a.submitWizard=function(){function b(a,c){if(a&&a.fieldId===c)return a;if(a.layout)for(var d=0;d<a.layout.length;++d){var e=a.layout[d],f=b(e,c);if(f)return f}return null}var c=g("selectedFields")(a.checkout.item.fields)||[],d=c.findIndex({id:"virtualMachineName"}),e={name:c[d].value,startDate:Date.create("today"),endDate:Date.create("today").addMonths(a.configEndDate)},f=[];c.each(function(c){var d=b(a.checkout.item,c.id);d&&f.push(d)}),f.vmName=c[d].value,c.splice(d,1),a.options=c,a.summary=f,a.checkout.submit(c,e)},a.reOrder=function(){b.reload()},a.updatePricing=function(){if(a.checkout.item){var b=g("selectedFields")(a.checkout.item.fields);a.initPrice=i.totalInitialPrice(a.checkout.item,b),a.recurringPrice=i.totalRecurringPrice(a.checkout.item,b)}},d.fetch().then(function(b){a.configEndDate=b.portalEndDatePeriod||12,a.loadWizard()})}]),angular.module("mppApp").controller("ListCartItemsCtrl",["$scope","$modalInstance","model",function(a,b,c){a.title=c.title,a.message=c.message,a.items=c.items,a.buttons=c.buttons,a.close=function(a){b.close(a)}}]).controller("CartCtrl",["$q","$scope","$modal","$organization","$user","cart","CartCheckout","$sce","$translate","$window","$location","HelpService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){if(f.totalQuantity>f.thresholdQuantity){var b=i("cart.modal.submitDelay.message",{quantity:f.thresholdQuantity});return c.messageBox("cart.modal.submitDelay.title",b,[{label:"common.yes",cssClass:"btn-primary",result:"checkout",id:"checkoutButton",focus:!0},{label:"common.no",cssClass:"btn-info",result:"no",id:"no-"+f.id}]).open().result}var d=a.defer();return d.resolve("checkout"),d.promise}function n(a){var b=[];return f.items.each(function(c){a.find(function(a){return a.cartItemId===c.id})&&b.add(c)}),b.unique()}b.allowAttachments=j.FormData?!0:!1,b.cart=f,b.showError=Object.extended({enabled:!1}),f.getCart().catch(function(a){b.showError.merge(Object.merge(a.data,{action:b.getCart,params:[]})),b.showError.enabled=!0
}),e.fetch().then(function(a){b.user=a}),d.fetch().then(function(a){b.portalShowTermsOfUse=a.portalShowTermsOfUse||!1,b.isEnforceEndDate=a.portalEnforceEndDate||!1,b.configEndDate=a.portalEndDatePeriod||12,b.securityLevel=a.securityLevel,b.request={startDate:Date.create("today"),endDate:Date.create("today").addMonths(b.configEndDate),subscriptionPeriod:"term",isGroupOwned:!1,userGroup:null},b.$watch("request.subscriptionPeriod",function(a){"term"!==a?(b.dateOptions.endDateRequired=!1,b.dateOptions.endDateDisabled=!0):(b.dateOptions.endDateRequired=!0,b.dateOptions.endDateDisabled=!1)}),b.dateOptions={minStartDate:Date.create("today"),maxStartDate:b.request.endDate,minEndDate:Date.create(b.request.startDate).addDays(1),maxEndDate:b.request.endDate,startDateRequired:!0,endDateRequired:b.isEnforceEndDate}}),b.checkout=new g,b.update=function(a){var d=0;if(f.items.each(function(a){d+=a.quantity}),d>f.maximumQuantity){var e=i("cart.modal.cartTooBig.message",{quantity:f.maximumQuantity});return c.messageBox("cart.modal.cartTooBig.title",e,[{label:"common.ok",cssClass:"btn-info",result:"ok",id:"ok-"+f.id}]).open()}f.updateItem(a).catch(function(c){b.showError.merge(Object.merge(c.data,{action:b.update,params:[a]})),b.showError.enabled=!0})},b.configure=function(){m().then(function(a){"checkout"===a&&b.checkout.configureItems()})},b.submit=function(){return b.checkout.submit({startDate:b.request.startDate,endDate:b.request.endDate,groupOwnership:b.request.userGroup},b.files).then(function(){var a=b.checkout.confirmation;if(b.handleSubmittedRequests(a),a.failedRequests&&a.failedRequests.length>0){var c=n(a.failedRequests);b.handleFailedRequests(c)}},function(a){a.data&&a.data.httpStatusCode>=500?b.handleFailedRequests(f.items,!0):(b.showError.merge(Object.merge(a.data,{action:b.submit,params:[]})),b.showError.enabled=!0)})},b.confirmFailedItemsRemoval=function(a,b,d,e){var f={templateUrl:"views/cart/dialog/listItems.html",controller:"ListCartItemsCtrl",resolve:{model:function(){return{title:a,message:b,buttons:d,items:e}}}};return{open:c.open.fill(f)}},b.handleFailedRequests=function(a,c){b.confirmFailedItemsRemoval("cart.modal.removeFailedItems.title","cart.modal.removeFailedItems.message",[{label:"cart.modal.removeFailedItems.remove",cssClass:"btn-primary",result:"remove",id:"removeButton",focus:!0},{label:"cart.shopMore",cssClass:"btn-info",result:"shopMore",id:"shopMore-"+f.id}],a).open().result.then(function(d){"remove"===d?(a.each(function(a){f.removeItem(a.id)}),c&&b.checkout.restart()):k.path("/service")})},b.handleSubmittedRequests=function(a){var c=n(a.requests);c.length>0&&((a.showTotalPrice=b.showTotalPrice(c))&&(a.price=Object.clone(c[0].price,!0),a.price.initPrice.price=b.getTotalPrice(c)),(a.showTotalRecurringPrice=b.showTotalRecurringPrice(c))&&(a.price=a.price||Object.clone(c[0].price,!0),a.price.recurringPrice.price=b.getTotalRecurringPrice(c)),c.each(function(a){f.removeItem(a.id)}))},b.showTotalPrice=function(a){return a=a||f.items,Object.extended(a.groupBy(function(a){return a.price.initPrice.currency})).keys().length<=1},b.showTotalRecurringPrice=function(a){a=a||f.items;var b=Object.extended(a.groupBy(function(a){return a.price.recurringPrice.currency})).keys().length<=1,c=Object.extended(a.groupBy(function(a){return a.price.recurringPrice.basedOn})).keys().length<=1;return b&&c},b.getTotalPrice=function(a){return a=a||f.items,a.sum(function(a){return a.price.initPrice.price*a.originalQuantity})},b.getTotalRecurringPrice=function(a){return a=a||f.items,a.sum(function(a){return a.price.recurringPrice.price*a.originalQuantity})},b.request={isGroupOwned:!1},b.back=function(a){"itemConfig"===a?b.checkout.state="detail":"orderConfig"===a?b.checkout.state="itemConfig":k.path("/")},b.backLabel=function(a){return"detail"===a||"confirmation"===a?"home.title":"itemConfig"===a?"cart.detail.title":"orderConfig"===a?"cart.itemConfig.title":"cart.detail.title"},b.getGroupOwnership=function(){var a="<strong><span>"+i("common.on")+"</span></strong>",c="<strong><span>"+i("common.off")+"</span></strong>",d=i("services.checkout.groupOwnershipIs",{status:a}),e=i("services.checkout.groupOwnershipIs",{status:c});return h.trustAsHtml(b.request.isGroupOwned?d:e)},b.editConfig=function(a){console.log("soon to be edit configs for item: "+a.$$hashKey)},b.removeItem=function(a){c.messageBox("cart.modal.remove.title","cart.modal.remove.message",[{label:"common.yes",cssClass:"btn-primary",result:"delete",id:"confirm-"+a.id,focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok",id:"ok-"+a.id}]).open().result.then(function(c){"delete"===c&&f.removeItem(a.id).catch(function(c){b.showError.merge(Object.merge(c.data,{action:b.removeItem,params:[a]})),b.showError.enabled=!0})})},b.removeFile=function(a){b.files.splice(a,1)},b.files=[],b.allowAttachments=window.FormData?!0:!1,b.$on("fileSelected",function(a,c){var d=b.files.findIndex(function(a){return a.name==c.file.name});b.$apply(function(){-1===d&&b.files.push(c.file)});var e=angular.element("#fileUpload");e.replaceWith(e=e.clone(!0))}),b.$watch("checkout.state",function(a){switch(a){case"itemConfig":l.setHelpAlias("shopping_cart_add_sub_names");break;case"orderConfig":l.setHelpAlias("shopping_cart_provide_order_info");break;case"confirmation":l.setHelpAlias("shopping_cart_confirmation");break;case"detail":default:l.setHelpAlias("shopping_cart")}})}]),angular.module("mppApp").controller("CartItemCtrl",["$scope","$routeParams","$route","$location","$filter","$modal","$organization","promiseTracker","pricingCalculatorSvc","cart",function(a,b,c,d,e,f,g,h,i,j){function k(b,c){a.showError.merge(b),c&&"function"==typeof c&&(a.showError.action=c),a.showError.enabled=!0}function l(){return a.item.fields||[]}function m(){if(a.item){var b=l();a.initPrice=i.totalInitialPrice(a.item,b),a.recurringPrice=i.totalRecurringPrice(a.item,b)}}function n(){j.editItem(q).then(function(b){a.item=b,a.$watch("item",function(){m()},!0)},function(a){k(a.data,n)})}function o(a){f.messageBox("cart.modal.merged.title","cart.modal.merged.message",[{label:"common.ok",cssClass:"btn-primary",result:"ok",id:"ok-"+a.id,focus:!0}]).open().result.then(function(a){"ok"===a&&d.path("/cart")})}function p(){var b={},c=l();c.each(function(a){b[a.id]=a.value});var d=Object.clone(r,!0);return d.fields=b,d.price.initPrice=a.item.initPrice,d.price.recurringPrice=a.item.recurringPrice,d.price.initPrice.price=a.initPrice,d.price.recurringPrice.price=a.recurringPrice,d}var q=b.id,r=j.items.find(function(a){return a.id===q});a.showError=Object.extended({enabled:!1}),g.fetch().then(function(b){a.securityLevel=b.securityLevel}),a.showDetails=!0,a.initPrice=0,a.recurringPrice=0,a.openImages=function(b){f.imageCarousel(a.item.screenshots,b)},a.update=function(){var b=p();j.updateItem(b).then(function(a){a.merged?o(a):d.path("/cart")},function(b){k(b.data,a.update)})},a.back=function(){d.path("/cart")},n()}]),angular.module("mppApp").controller("ImageCarouselCtrl",["$scope","images","index","$modalInstance",function(a,b,c,d){function e(b){a.images.forEach(function(a){a.active=!1}),a.images[b].active=!0}a.images=b,e(c),a.close=function(){d.close()}}]).controller("MessageBoxCtrl",["$scope","$modalInstance","model",function(a,b,c){a.title=c.title,a.message=c.message,a.buttons=c.buttons,a.close=function(a){b.close(a)}}]).controller("ListActionsMessageBoxCtrl",["$scope","$modalInstance","model",function(a,b,c){a.title=c.title,a.message=c.message,a.buttons=c.buttons,a.info={type:c.type,num:c.num},a.close=function(a){b.close(a)}}]).controller("ListActionsBoxCtrl",["$scope","$modalInstance","model",function(a,b,c){a.type=c.type,a.title=c.title,a.message=c.message,a.actions=c.actions,a.close=function(a){b.close(a)}}]).controller("SecurityBoxCtrl",["$scope","$modalInstance","model","orgSecurityBannerColorMap","translateSvc",function(a,b,c,d,e){a.title=c.title,a.message=c.message,a.buttons=c.buttons,a.securityLevel=c.securityLevel,a.disclaimerText=c.disclaimerText,a.getColor=d.getColor,a.close=function(a){"proceed"==a?b.close(a):window.open(a)},a.translateStatus=function(a){return e.translateDataValue("security.labels."+a.toUpperCase().replace(" ","_"))}}]).controller("CommentBoxCtrl",["$scope","$modalInstance","model",function(a,b,c){a.title=c.title,a.message=c.message,a.buttons=c.buttons,a.placeholder=c.placeholder,a.error=c.error,a.maxChars=c.maxChars||null,a.comment={},a.close=function(a,c){"ok"===a?b.dismiss():b.close({type:a,comment:c})},a.trimComment=function(){a.comment.text&&(a.comment.text=a.comment.text.replace(/(\r\n|\n|\r)/gm,"\r\n"),a.comment.text=a.comment.text.substring(0,a.maxChars))}}]),angular.module("mppApp").controller("ShopCtrl",["$scope","$shopDashboard","$location","toggleSvc",function(a,b,c,d){a.query={search:""},a.bannerToggle=d("shopBanner",!0),a.updatePath=function(){c.path("/service"),c.search(a.query)},a.getActiveSlideName=function(){return a.bannerToggle.state?"":$(".carousel-inner .active .item-label").html()},a.getData=function(){b.fetch().then(function(b){a.data=b,a.header=b.header},function(b){a.showError.merge(b.data),a.showError.enabled=!0})},a.showError=Object.extended({enabled:!1,action:a.getData}),a.getData()}]),angular.module("mppApp").factory("serviceSvc",["$resource",mpp$ServiceSvc]),angular.module("mppApp").factory("offeringSvc",["$resource",mpp$OfferingSvc]),angular.module("mppApp").factory("servicePropertySvc",["$resource",mpp$ServicePropertySvc]),angular.module("mppApp").factory("SingleServiceCheckout",["$session","serviceSvc","checkoutSvc",mpp$SingleServiceCheckout]),angular.module("mppApp").factory("ModifySubscriptionCheckout",["$modal","$session","subscriptionSvc","SingleServiceCheckout","checkoutSvc",mpp$ModifySubscriptionCheckout]),angular.module("mppApp").factory("myserviceSvc",["$resource",mpp$MyserviceSvc]),angular.module("mppApp").factory("myserviceActionSvc",["$resource",mpp$MyserviceActionSvc]),angular.module("mppApp").factory("myserviceColorMap",function(){var a={IN_PROGRESS:"bg-notification",RESERVED:"bg-action",DEPLOYING:"bg-new",ACTIVE:"bg-online",FAILED:"bg-critical",PUBLIC_ACTION_FAILED:"bg-critical",CANCELLED:"bg-white",MODIFYING:"bg-link",MODIFY_FAILED:"bg-popular",CANCELLING:"bg-text",CANCEL_FAILED:"bg-critical",EXPIRING:"bg-popular",EXPIRE_FAILED:"bg-critical"};return{getColor:function(b){return b?a[b.toUpperCase().replace(" ","_")]||"bg-white":"bg-white"}}}),angular.module("mppApp").factory("myserviceUtil",function(){var a=["externalViewURL","externalViewWidth","externalViewHeight","launchURL"];return{buildComponentActions:function(a){var b=[];return a&&(a.serviceAction&&angular.forEach(a.serviceAction,function(b){b.refId=a.id,this.push(b)},b),a.resourceSubscription&&angular.forEach(a.resourceSubscription,function(a,c){(c||!c&&b.length)&&this.push({type:"divider"}),this.push({displayName:a.displayName,type:"dropdown-header"}),angular.forEach(a.serviceAction,function(b){b.refId=a.id,this.push(b)},this)},b)),b},getSpecialProperties:function(b){var c={};return b&&b.forEach(function(b){a.indexOf(b.name)>-1&&(this[b.name]=b.value[0]||null)},c),c},removeSpecialProperties:function(b){b&&b.remove(function(b){return a.indexOf(b.name)>-1})},buildFields:function(a){var b={};return a&&a.each(function(a){b[a.name]="ENUM"===a.valueType?a.value:a._value}),b}}}),angular.module("mppApp").factory("approvalSvc",["$resource",mpp$approvalSvc]),angular.module("mppApp").factory("approvalAction",["$modal","$location","$route","approvalSvc",mpp$approvalAction]),angular.module("mppApp").factory("orderSvc",["$resource",mpp$orderSvc]),angular.module("mppApp").factory("requestSvc",["$resource",mpp$requestSvc]),angular.module("mppApp").factory("requestAction",["$modal","requestSvc",mpp$reqAction]),angular.module("mppApp").factory("subscriptionSvc",["$resource",mpp$SubscriptionSvc]),angular.module("mppApp").factory("subscriptionAction",["$modal","subscriptionSvc",function(a,b){var c,d,e=0;return{setListActionsInstance:function(a){d=a},setRemainingCount:function(a){e=a},getRemainingCount:function(){return e},getDataAnalysis:function(){return c},setDataAnalysis:function(a){var b,d=[],e=[],f=0,g=function(a){a.processing&&(f+=1),a.cancelable&&d.push({id:a.id,action:"CANCEL_SUBSCRIPTION"}),a.deletable&&e.push(a.id)};0!==a.length&&(b=a[0].catalogId),a.forEach(function(a){g(a)}),c={total:a.length,catalogId:b,isAllCancelable:0===d.length,cancelableList:d,isAllDeletable:0===e.length,deletableList:e,processingListCounter:f}},singleCancel:function(c,d,e,f){a.messageBox("subscription.modal.cancel.title","subscription.modal.cancel.message",[{label:"common.yes",cssClass:"btn-danger",result:"cancel",id:"confirm-"+c,focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok",id:"ok-"+c}]).open().result.then(function(a){if("cancel"===a){b.cancel({id:c,catalog:d},{ids:[{id:c,action:"CANCEL_SUBSCRIPTION"}]}).$promise.then(function(){e&&e(c)},f)}})},multiCancel:function(d,e){var f;a.messageBox("subscription.modal.multiple_cancel.title","subscription.modal.multiple_cancel.message",[{label:"common.yes",cssClass:"btn-danger",result:"cancelAll",focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok"}]).open().result.then(function(a){"cancelAll"===a&&(f=c.cancelableList,b.multiCancel({id:f[0].id,catalog:c.catalogId},{ids:f}).$promise.then(function(){d(f)},e))})},singleDelete:function(c,d,e){a.messageBox("subscription.modal.delete.title","subscription.modal.delete.message",[{label:"common.yes",cssClass:"btn-primary",result:"delete",id:"confirm-"+c,focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok",id:"ok-"+c}]).open().result.then(function(a){if("delete"===a){b.delete({ids:[c]}).$promise.then(d,e)}})},multiDelete:function(a,f){var g=this;b.multiDelete({ids:c.deletableList}).$promise.then(function(){a.removeDeletedItems(c.deletableList),e>0?(d.showReDeleteModal(c,f),e-=1):g.noMoreToBeDeleted(c.deletableList.length)},f)},confirmMultiDelete:function(b,d,e){var f=this;a.messageBox("subscription.modal.multiple_delete.title","subscription.modal.multiple_delete.message",[{label:"common.yes",cssClass:"btn-primary",result:"deleteAll",focus:!0},{label:"common.no",cssClass:"btn-info",result:"ok"}]).open().result.then(function(a){"deleteAll"===a&&(d?b.deleteAgainCallback(f,c.total-c.deletableList.length):f.multiDelete(b,e))})},noMoreToBeDeleted:function(b){a.ListActionsMessageBox("subscription.modal.end.title","subscription.modal.end.message","",b,[{label:"common.ok",cssClass:"btn-primary",result:"ok",focus:!0}]).open()}}}]),angular.module("mppApp").factory("wizardSvc",["$resource","$translate",mpp$WizardSvc]),angular.module("mppApp").factory("notificationSvc",["$resource",mpp$NotificationSvc]),angular.module("mppApp").factory("WizardCheckout",["$user","serviceSvc",function(a,b){function c(a){this.item=a,this.state="detail"}return c.prototype.submit=function(c,d){var e=this,f=Object.extended();c.each(function(a){f[a.id]=a.value});var g=Object.extended();return g.model={categoryName:e.item.category.name,subscriptionName:d.name,startDate:d.startDate,endDate:d.endDate,fields:f,action:"ORDER"},b.post({serviceId:this.item.id,catalog:this.item.catalogId},g).$promise.then(function(b){a.fetch().then(function(a){b.requestedBy=a.name}),b.createdOn=Date.create(),e.confirmation=b,e.state="confirmation"}),this},c}]),angular.module("mppApp").factory("listActions",["$modal",mpp$listActions]),angular.module("mppApp").factory("serviceCategorySvc",["$resource",function(a){return a("api/category/service",{},{query:{method:"GET",isArray:!0,tracker:"category$query"}})}]),angular.module("mppApp").factory("subscriptionCategorySvc",["$resource",function(a){return a("api/category/subscription",{},{query:{method:"GET",isArray:!0,tracker:"category$query"}})}]),angular.module("mppApp").factory("categoryOptionsSvc",["serviceCategorySvc","subscriptionCategorySvc","$translate",function(a,b,c){return{getService:function(){var b=[];return a.query().$promise.then(function(a){return b.add(a.add({displayName:c("services.allCategories"),name:"ALL"},0)),b})},getSubscription:function(){var a=[];return b.query().$promise.then(function(b){return a.add(b.add({displayName:c("services.allCategories"),name:"ALL"},0)),a})}}}]),angular.module("mppApp").factory("organizationSvc",["$resource",mpp$organizationSvc]).service("$organization",["organizationSvc","$user","$session","$q","promiseTracker",function(a,b,c,d,e){var f;this.fetch=function(){function g(){return e("organization$get").active()?f:f=a.get({},function(a){c.set("org",a)}).$promise}var h=c.get("org");if(h&&h.name){var i=d.defer();return b.fetch().then(function(a){a&&a.tenant&&a.tenant.name===h.name?i.resolve(h):g().then(function(a){i.resolve(a)},function(a){i.reject(a)})}),i.promise}return g()}}]).factory("orgSecurityBannerColorMap",function(){var a={UNCLASSIFIED:"unclassified",UNCLASSIFIED_FOUO:"fouo",CONFIDENTIAL_FOUO:"confidential_fouo",CONFIDENTIAL:"confidential",CONFIDENTIAL_NOFORN:"confidential_noforn",UNCLASSIFIED_NOFORN:"noforn",FOUO:"fouo",NOFORN:"noforn",SECRET:"secret",TOPSECRET:"topsecret"};return{getColor:function(b){return b?a[b.toUpperCase().replace(" ","_")]||"unclassified":"unclassified"}}}),angular.module("mppApp").factory("widgetSvc",["$resource",mpp$widgetSvc]),angular.module("mppApp").factory("userSvc",["$resource",mpp$userSvc]).service("$user",["userSvc","$session","$q",function(a,b,c){this.fetch=function(){var d=b.get("user");if(d){var e=c.defer();return e.resolve(d),e.promise}return a.get({},function(a){b.set("user",a)}).$promise}}]),angular.module("mppApp").service("$apiSort",function(){this.getServiceSortings=function(){return["newest","oldest","expensive","cheap","ascend","descend"]},this.getNotificationSortings=function(){return["newest","oldest"]}}),angular.module("mppApp").service("$apiFilter",function(){this.getRequestTypes=function(){return["ALL","ACTION","ORDER","MODIFY_SUBSCRIPTION","CANCEL_SUBSCRIPTION"]},this.getRequestStates=function(){return["ALL","PENDING","CANCELLED","APPROVED","REJECTED","CANCELLABLE","DELETABLE"]},this.getSubscriptionStates=function(){var a=["ALL","ACTIVE","PENDING","EXPIRED","CANCELLED","TERMINATED","PAUSED"];return a},this.getServiceInstanceStates=function(){var a=["ALL","ACTIVE","RESERVED","DEPLOYING","IN_PROGRESS","MODIFYING","MODIFY_FAILED","FAILED","CANCELLED","CANCELLING","CANCEL_FAILED","EXPIRING","EXPIRE_FAILED","PUBLIC_ACTION_FAILED"];return a},this.getServiceTypes=function(){return["ALL","REQUIRED","NOT_REQUIRED"]},this.getApprovalStatus=function(){return["ALL","APPROVED","DECISION_PENDING","REJECTED"]},this.getNotificationDateFilter=function(){return["ALL","DAY","WEEK","MONTH","YEAR"]}}),angular.module("mppApp").service("checkoutSvc",function(){var a=function(a,b,c){if(a)if(b&&b.isToday()||a.isToday()){var d=b?b:new Date;a.set({hours:d.getHours(),minutes:d.getMinutes(),seconds:d.getSeconds()})}else a.set(c);return a};this.setStartDate=function(b){return a(b,null,{hours:0,minutes:0,seconds:5})},this.setEndDate=function(b,c){return a(b,c,{hours:23,minutes:59,seconds:55})}}),angular.module("mppApp").service("translateSvc",["$rootScope","translateFilter","$translate",function(a,b,c){this.tryKeyOrLabel=function(a,c){var d=b(a);return d===a?b(c):d},this.translateDataValue=function(a){return this.tryKeyOrLabel(a,b("common.unknown"))},this.checkAvailability=function(b){if(c.uses())b();else var d=a.$on("$translateChangeSuccess",function(){d(),b()})}}]).filter("translate",["$translate",function(a){return function(b,c,d){try{return a(b,c,d)}catch(e){return b}}}]),angular.module("mppApp").factory("cart",["cartSvc",mpp$cart]),angular.module("mppApp").factory("cartSvc",["$resource",mpp$CartSvc]),angular.module("mppApp").factory("CartCheckout",["cart","cartSvc","checkoutSvc",mpp$CartCheckout]),angular.module("mppApp").factory("dashboardSvc",["$resource","utilSvc","$organization",mpp$dashboardSvc]).factory("shopDashboardSvc",["$resource","utilSvc",mpp$shopDashboardSvc]).service("$dashboard",["dashboardSvc","$session","$q","promiseTracker",function(a,b,c,d){var e,f="dashboardLayout";this.fetch=function(){function g(){return d("dashboard$get").active()?e:e=a.get({},function(a){b.set(f,a)}).$promise}var h=b.get(f);return h?c.when(h):g()}}]).service("$shopDashboard",["shopDashboardSvc","$session","$q","promiseTracker",function(a,b,c,d){var e,f="shopDashboardLayout";this.fetch=function(){function g(){return d("shopDashboard$get").active()?e:e=a.get({},function(a){b.set(f,a)}).$promise}var h=b.get(f);return h?c.when(h):g()}}]),angular.module("mppApp").service("renderSelect",[function(){this.render=function(a){if(bowser.msie){var b=angular.element(a).css("width");angular.element(a).css("width",b)}}}]),angular.module("mppApp").filter("bytes",["$translate",function(a){return function(b){var c=[a("formats.bytes.bytes"),a("formats.bytes.kilobytes"),a("formats.bytes.megabytes"),a("formats.bytes.gigabytes"),a("formats.bytes.terabytes")];if("singleFileMax"===b&&(b=5243e3),"totalFileMax"===b&&(b=1049e5),0===b||"0"===b)return"n/a";var d=parseInt(Math.floor(Math.log(b)/Math.log(1024)),10);return Math.round(b/Math.pow(1024,d),2)+" "+c[d]}}]),angular.module("mppApp").filter("linkyPlus",["$sce",function(a){var b=/(((ftp|https?):\/\/)[^<>\]]+?(?![^<>\]]*([>]|<\/))|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,c=/^mailto:/;return function(d,e){function f(a){a&&l.push(a)}function g(a,b){l.push("<a "),angular.isDefined(e)&&(l.push('target="'),l.push(e),l.push('" ')),l.push('href="'),l.push(a),l.push('">'),f(b),l.push("</a>")}if(!d)return d;for(var h,i,j,k=a.getTrustedHtml(d),l=[];h=k.match(b);)i=h[0],h[2]===h[3]&&(i="mailto:"+i),j=h.index,f(k.substr(0,j)),g(i,h[0].replace(c,"")),k=k.substring(j+h[0].length);return f(k),l.join("")}}]),angular.module("mppApp").directive("termsAndConditions",["$organization","$sce","$translate",function(a,b,c){return{scope:{termsMessageKey:"@"},templateUrl:"views/directives/termsAndConditions.html",restrict:"A",link:function(d,e,f){a.fetch().then(function(a){var e='<a href="'+a.portalTermsOfUseUrl+'" target="_blank" class="text-primary">'+c("services.checkout.tac.terms")+"</a>";b.trustAsHtml(a.portalTermsOfUseUrl),d.terms={terms:e},d.termsMessageKey=f.termsMessageKey||"services.checkout.tac.message"})}}}]),angular.module("mppApp").directive("nodata",function(){return{scope:{title:"@",icon:"@",helpAlias:"@"},templateUrl:"views/directives/noData.html",restrict:"E",controller:["$scope","HelpService",function(a,b){a.getHelpUrl=function(a){return b.createHelpUrl(a)}}],link:function(a,b,c){a.helpUrl=a.getHelpUrl(c.helpAlias)}}}),angular.module("mppApp").directive("dynamicForm",function(){return{restrict:"EA",require:["^ngModel","^form"],scope:!0,templateUrl:"views/directives/dynamicForm.html",link:function(a,b,c,d){var e=d[0],f=d[1];a.$watch(function(){return e.$modelValue},function(){e.$modelValue&&(a.optionModel=e.$modelValue,f.fields={},angular.forEach(e.$modelValue.fields,function(a){f.fields[a.id]=a}))})}}}).directive("dynamicFormTrigger",["$parse","servicePropertySvc",function(a,b){return{restrict:"A",require:"^ngModel",scope:!0,link:function(c,d,e,f){c.$watch(function(){return f.$modelValue},function(){f.$modelValue&&(angular.forEach(f.$modelValue.fields,function(a){c[a.id]=a}),angular.forEach(f.$modelValue.dependencies,function(d){angular.forEach(d.triggers,function(e){c.$watch(e,function(e,f){angular.forEach(d.actions,function(d){if(angular.isString(d))c.$eval(d);else if(e!==f){var g=Object.clone(d.dynamicScriptParams),h=d.field.split(".",1)[0],i=c[h];if(!e||Array.isArray(e)&&e.isEmpty()||!Array.isArray(e)&&e.isBlank())return;Object.keys(g,function(a,b){try{g[a]=c.$eval(b),void 0===g[a]&&(g[a]=b)}catch(d){}}),Array.isArray(i.value)?(i.value=[],a(d.field).assign(c,[])):i.value="";var j=!i.disabled;i.disabled=!0,b.post({id:h},g).$promise.then(function(b){a(d.field).assign(c,b),j&&(i.disabled=!1)},function(){console.error("unable to fetch",h),a(d.field).assign(c,[]),j&&(i.disabled=!1)})}})})})}))})}}}]),angular.module("mppApp").directive("formLayout",[function(){return{templateUrl:"views/directives/formLayout.html",restrict:"E",require:"^form",scope:{layout:"=",showDetails:"=",displayClass:"=",level:"@?"},link:function(a,b,c,d){a.$watch(function(){return d.fields},function(){a.fields=d.fields})}}}]),angular.module("mppApp").controller("mppFieldSet",["$scope",function(a){a.layout.visible=!1,a.layout.hidden=!1,a.$watch(function(){return a.layout.layout?!!a.layout.layout.find(function(b){return b.fieldId?a.fields[b.fieldId].visible:b.visible}):!1},function(b){a.layout.visible=b},!0),a.$watch(function(){return a.layout.layout?a.layout.layout.all(function(b){return b.fieldId?a.fields[b.fieldId].hidden:b.hidden}):!1},function(b){a.layout.hidden=b},!0)}]).directive("mppFieldSet",function(){return{restrict:"E",scope:{layout:"=",showDetails:"=",index:"@?",level:"@?"},require:"^form",templateUrl:"views/directives/mppFieldSet.html",controller:"mppFieldSet",link:function(a,b,c,d){a.fields=d.fields,a.level=a.level?a.level.toNumber():0}}}),angular.module("mppApp").controller("mppField",["$scope","fieldWrapper","$filter",function(a,b,c){a.groupModel={value:"foo"};var d=b(a.field,a.layout);return Object.merge(a,d,!0,!1),a.validationData=a.getValidationData(),a.validationKey=a.getValidationMessageKey(),(a.isMultiList()||a.isList())&&a.$watch("field.availableValues",function(a){a.each(function(a){a.pricingName=c("propertyPrice")(a)})}),a.isMultiList()&&(a.field.value=a.field.availableValues.findAll(function(b){return a.field.value.find(function(a){return b.value===a})})),{name:function(){return a.field.name},visible:function(){return a.field.visible},required:function(){return a.isBoolean()||a.isRadio()?!1:a.field.required},pattern:function(){return a.field.pattern},min:function(){return a.field.minValue},max:function(){return a.field.maxValue},observeVisibility:function(b){a.$watch("field.visible",function(a){b(a)})},isInteger:a.isInteger,isString:a.isString,isConfidential:a.isConfidential,isText:a.isText,isTextArea:a.isTextArea,isList:a.isList,isMultiList:a.isMultiList,isBoolean:a.isBoolean,isRadio:a.isRadio,isDateTime:a.isDateTime,isDate:a.isDate,isTime:a.isTime,isDateIsh:a.isDateIsh}}]).directive("mppField",function(){return{restrict:"EA",scope:{layout:"=",field:"=",showDetails:"=",level:"@?"},require:"^form",templateUrl:"views/directives/mppField.html",link:function(a,b,c,d){a.fields=d.fields,a.form=d,a.level=a.level?a.level.toNumber():0},controller:"mppField"}}),angular.module("mppApp").directive("mppDateRange",["$timeout",function(a){return{templateUrl:"views/common/dateRange.html",restrict:"E",scope:{dateRangeInterval:"=",dateOptions:"=",endDate:"=",startDate:"="},link:function(b){function c(){b.endDate&&""!==b.endDate&&(b.tempEndDate=b.endDate,b.endDate="",b.dateOptions.maxStartDate=null)}b.dateOptions=b.dateOptions||{},b.startDateOpen=function(){a(function(){b.startDateOpened=!0})},b.endDateOpen=function(){a(function(){b.endDateOpened=!0})},b.dateRangeInterval&&(b.dateRangeInterval=1*b.dateRangeInterval),b.startDate||(b.startDate=Date.create("today")),b.endDate&&b.endDate<b.startDate&&(b.endDate=b.dateRangeInterval?Date.create(b.startDate).addMonths(b.dateRangeInterval):Date.create(b.startDate).addDays(1)),b.$watch("startDate",function(){var a,d;b.dateRangeInterval?(a=Date.create(b.startDate).addMonths(b.dateRangeInterval),a<Date.create("today")&&(a=Date.create("today").addMonths(b.dateRangeInterval)),(b.endDate>a||b.endDate<b.startDate)&&(b.endDate=Date.create(a)),b.dateOptions.maxEndDate=Date.create(a)):(d=Date.create(b.startDate).addDays(1),d<Date.create("today")&&(d=Date.create("today").addDays(1)),b.endDate<b.startDate&&(b.endDate=d,b.dateOptions.maxEndDate=Date.create(d))),b.dateOptions.minEndDate=Date.create(b.startDate).addDays(1),b.dateOptions.endDateDisabled&&c()}),b.$watch("endDate",function(){b.endDate&&""!==b.endDate&&(b.dateOptions.maxStartDate=Date.create(b.endDate).addDays(-1))}),b.$watch("dateOptions.endDateDisabled",function(a){a?c():b.tempEndDate&&(b.endDate=b.tempEndDate)})}}}]),angular.module("mppApp").directive("disableFields",function(){return{restrict:"A",require:["^ngModel"],scope:!0,link:function(a,b,c,d){var e=d[0];a.$watch(function(){return e.$modelValue},function(){e.$modelValue&&angular.forEach(e.$modelValue.fields,function(a){a.disabled=!0})})}}}),angular.module("mppApp").factory("pricingCalculatorSvc",function(){var a={totalInitialPrice:function(b,c){var d=0;return b&&(d=a.getPrice(b,"initPrice")),c&&c.length&&(d=[d].concat(c).reduce(function(b,c){return b+a.getPrice(c,"initPrice")})),d},totalRecurringPrice:function(b,c){var d=0;return b&&(d=a.getPrice(b,"recurringPrice")),c&&c.length&&(d=[d].concat(c).reduce(function(b,c){return b+a.getPrice(c,"recurringPrice")})),d},getPrice:function(a,b){b=b||"initPrice";var c=0;if(a)if(a.availableValues&&a.availableValues.length>0){var d=[];d.add(a.value);var e=a.availableValues.findAll(function(a){return[a.value].intersect(d).length>0});e.each(function(a){var d=a[b]?a[b].price||0:0;c+=d})}else c=a[b]?a[b].price||0:0;return c},hasPrice:function(a){return a?void 0===a.price||null===a.price?!1:!0:!1}};return a}),angular.module("mppApp").filter("selectedFields",["$filter",function(a){return function(b){return a("filter")(b,function(a){return a.visible&&(Object.isString(a.value)||Object.isNumber(a.value)||Object.isArray(a.value)||a.value)})}}]),angular.module("mppApp").filter("nonEmptyFields",["$filter",function(a){return function(b){return a("filter")(b,function(a){return Object.isString(a.value)?""!==a.value.compact():Object.isArray(a.value)?a.value.length:a.value})}}]),angular.module("mppApp").filter("fieldDisplayValue",["$filter","$translate",function(a,b){return function(c){if(Object.isBoolean(c.value))return c.displayName;if(c.availableValues){var d="",e={};if(c.availableValues.forEach(function(a){e[a.value]=a.displayName}),Object.isArray(c.value)){var f=[];c.value.forEach(function(a){f.push(e[a])}),d=f.join(b("request.detail.checkout.optionValueSeparator"))}else d=e[c.value];return b("request.detail.checkout.optionValue",{displayName:c.displayName,value:d})}return b("request.detail.checkout.optionValue",{displayName:c.displayName,value:c.confidential?a("confidential")(c.value):c.value})}}]),angular.module("mppApp").filter("confidential",["$filter",function(){return function(){return"[********]"}}]),angular.module("mppApp").filter("publicActions",[function(){return function(a){return"string"==typeof a?a.split("_").map("capitalize").join(" ").trim():""}}]),angular.module("mppApp").directive("mppDatepicker",function(){return{templateUrl:"views/common/datePicker.html",restrict:"E",scope:{date:"=",min:"=",max:"=",required:"=",disable:"="},link:function(a){a.visible=!1,a.show=function(){a.visible=!0},a.hide=function(){a.visible=!1},a.toggle=function(){a.visible=!a.visible}}}}).directive("mppDateFilter",["$filter",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){e.$formatters.unshift(function(b){return a("date")(b,"shortDate")}),e.$parsers.unshift(function(a){var b=new Date(a);return b.getFullYear()<1999&&b.setFullYear(b.getFullYear()+100),b})}}}]),angular.module("mppApp").constant("timepickerPopupConfig",{timepickerPopup:"hh:mm a",appendToBody:!1}).directive("timepickerPopup",["$compile","$parse","$document","$position","dateFilter","timepickerPopupConfig","compilePriorities",function(a,b,c,d,e,f,g){return{restrict:"EA",require:"ngModel",priority:g.low,link:function(b,g,h,i){function j(a){h.isOpen?b[h.isOpen]=a:m.isOpen=!!a}function k(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function l(a){if(a){if(angular.isDate(a)&&!isNaN(a))return i.$setValidity("time",!0),a;if(angular.isString(a)){var b=Date.create(a);return isNaN(b)?void i.$setValidity("time",!1):(i.$setValidity("time",!0),b)}return void i.$setValidity("time",!1)}return i.$setValidity("time",!0),null}var m=b.$new(),n=angular.isDefined(h.timepickerPopup)?m.$parent.$eval(h.timepickerPopup):f.timepickerPopup,o=angular.isDefined(h.timepickerAppendToBody)?m.$parent.$eval(h.timepickerAppendToBody):f.appendToBody;
h.$observe("timepickerPopup",function(a){n=a||f.timepickerPopup,i.$render()}),m.isOpen=!1,h.isOpen&&b.$watch(function(){return b[h.isOpen]},function(a){m.isOpen=!!a});var p=angular.element('<div timepicker-popup-wrap><div timepicker id="foo"></div></div>');p.attr({"ng-model":"time","ng-change":"timeSelection()"});var q=angular.element(p.children()[0]);h.timepickerOptions&&angular.forEach(b.$eval(h.timepickerOptions),function(a,b){q.attr(k(b),a)}),i.$parsers.unshift(l),m.timeSelection=function(){i.$setViewValue(m.time),i.$render()},g.bind("input change keyup",function(){m.$apply(function(){m.time=i.$modelValue})}),i.$render=function(){var a=i.$viewValue?e(i.$viewValue,n):"";g.val(a),m.time=l(i.$modelValue)};var r=function(a){m.isOpen&&a.target!==g[0]&&m.$apply(function(){j(!1)})},s=function(){m.$apply(function(){j(!0)})};m.$watch("isOpen",function(a){a?(m.position=o?d.offset(g):d.position(g),m.position.top=m.position.top+g.prop("offsetHeight"),c.bind("click",r),g.unbind("focus",s),g[0].focus()):(c.unbind("click",r),g.bind("focus",s))});var t=a(p)(m);o?c.find("body").append(t):g.after(t),b.$on("$destroy",function(){t.remove(),g.unbind("focus",s),c.unbind("click",r)})}}}]).directive("timepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"views/timepicker/popup.html",link:function(a,b){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}),angular.module("mppApp").directive("mppGroupedField",function(){return{require:"ngModel",scope:!0,restrict:"A",controller:["$scope","$rootScope",function(a,b){function c(){var c="group:change:"+a.layout.group;b.$broadcast(c,a.field.name)}a.$watch(function(){return a.ngModel.$modelValue},function(b,d){return b===d&&void 0===d?void(a.field.value&&c()):void(b&&b===a.field.name&&c())}),a.$watch("field.value",function(b){b?c():a.ngModel.$setViewValue(void 0)})}],link:function(a,b,c,d){a.ngModel=d,void 0!==c.resetInitialValue&&(a.field.value=!1);var e="group:change:"+a.layout.group;a.$on(e,function(b,c){a.field.value=c===a.field.name,d.$setViewValue(c)})}}}),angular.module("mppApp").directive("mppName",function(){return{restrict:"A",require:["^form","ngModel"],link:function(a,b,c,d){var e=d[0],f=d[1],g=a.$eval(c.mppName);f.$name!==g&&(e.$removeControl(f),f.$name=g,c.$set("name",g),e.$addControl(f))}}}),angular.module("mppApp").directive("mppBusy",function(){return{restrict:"A",transclude:!0,scope:{busy:"@mppBusy"},templateUrl:"views/directives/loader.html",controller:["$scope","$route","$timeout","promiseTracker",function(a,b,c,d){a.trackers=a.busy.replace(/\s+/g,"").split(","),a.indicators=[];for(var e in a.trackers)a.indicators.push(d(a.trackers[e]));a.activeTrackers=function(){return a.indicators.any(function(a){return a.active()})}}]}}),angular.module("mppApp").controller("errorCtrl",["$scope","$location","$translate","HelpService",function(a,b,c,d){a.helpService=d,a.showDetails=!1,a.toggleDetails=function(){a.showDetails=!a.showDetails},a.reload=function(){a.hasError=!1,a.retryCallback&&a.retryCallback()},a.close=function(){a.hasError=!1},a.getError=function(b){try{var d=["error",a.key,b].join("."),e=Object.merge(a.params||{},{key:a.key}),f=c(d,e);return f===d?c("error.UI.FallbackError."+b,e):f}catch(g){return c("error.UI.FallbackError."+b,e)}}}]).directive("mppErrorTile",function(){return{restrict:"E",scope:{hasError:"=",params:"=",key:"@",retryCallback:"&"},templateUrl:"views/directives/error/tile.html",controller:"errorCtrl",transclude:!0}}).directive("mppErrorPage",function(){return{restrict:"E",templateUrl:"views/directives/error/page.html",scope:{hasError:"=",params:"=",key:"@",retryCallback:"&"},controller:"errorCtrl"}}),angular.module("mppApp").directive("recursive",["$compile",function(a){return{restrict:"EACM",priority:1e5,compile:function(b){var c,d=b.contents().remove();return function(b,e){c||(c=a(d)),e.append(c(b,function(a){return a}))}}}}]),angular.module("mppApp").directive("integer",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){var b=a?a.toNumber().isInteger():!1;return b?(d.$setValidity("integer",!0),a):void d.$setValidity("integer",!1)};d.$parsers.unshift(e),d.$formatters.unshift(e)}}}),angular.module("mppApp").filter("currency2",["currencyFilter",function(a){var b=5,c=function(a){var b=/^-?[0-9]+\.([0-9]+)$/.exec(a);return null===b?0:b[1].length};return function(d,e){var f=c(d);return f>2?(f=f>b?b:f,a(d,e,f)):a(d,e)}}]),angular.module("mppApp").filter("propertyPrice",["currency2Filter","$translate",function(a,b){return function(c){var d,e,f,g="";return c.initPrice&&c.initPrice.price>0&&(g=c.initPrice.currency?a(c.initPrice.price,b("formats.currency.key.".concat(c.initPrice.currency))).trim():a(c.initPrice.price,b("formats.NUMBER_FORMATS.CURRENCY_SYM"))),c.recurringPrice&&c.recurringPrice.price>0&&(d=c.recurringPrice.currency?a(c.recurringPrice.price,b("formats.currency.key.".concat(c.recurringPrice.currency))).trim():a(c.recurringPrice.price,b("formats.NUMBER_FORMATS.CURRENCY_SYM")),e=b("period.short."+c.recurringPrice.basedOn.toUpperCase()),f=b("common.offeringRecurringPrice",{price:d,period:e}),g=g?b("common.priceWithRecurringCost",{initPrice:g,recurringPrice:f}):f),g?b("common.propertyPrice",{displayName:c.displayName,price:g}):c.displayName}}]),angular.module("mppApp").directive("pricingLabel",function(){return{templateUrl:"views/directives/pricingLabel.html",restrict:"E",transclude:!0,scope:{initPrice:"=",recurringPrice:"=",currency:"=",period:"=",priceClass:"@",labelClass:"@",initialLabel:"@",recurringLabel:"@"}}}).directive("pricingOffering",function(){return{templateUrl:"views/directives/pricingOffering.html",restrict:"E",transclude:!0,scope:{initPrice:"=",recurringPrice:"=",currency:"=",period:"="}}}),angular.module("mppApp").directive("widget",function(){return{templateUrl:"views/directives/widgets/widget.html",restrict:"E",scope:{widget:"=model"}}}).directive("featureWidget",function(){return{templateUrl:"views/directives/widgets/featureWidget.html",restrict:"E",scope:{widget:"=widget"}}}).directive("linkWidget",function(){return{templateUrl:"views/directives/widgets/linkWidget.html",restrict:"A",scope:{widget:"=widget"}}}).directive("mashUpWidget",function(){return{templateUrl:"views/directives/widgets/mashUpWidget.html",restrict:"E",scope:{widget:"=widget"},controller:["$scope","$sce",function(a,b){a.trustedHTML=b.trustAsHtml(a.widget.attributes.code_snippet)}]}}),angular.module("mppApp").directive("navbar",function(){return{templateUrl:"views/directives/navbar.html",restrict:"E",transclude:!0,scope:{hideSidebar:"=?",navTitle:"@",itemCount:"=",backUrl:"@",backLabel:"@",hideBackBtn:"=?",hasFooter:"=",backClick:"&"},link:function(){var a=angular.element(document.querySelector("#navbar")),b=angular.element(document.querySelector("#scrollbox"));b.bind("scroll",function(){b[0].scrollTop?a.addClass("navbar-shadow"):a.removeClass("navbar-shadow")})}}}),angular.module("mppApp").service("themeSvc",["$organization","$http","$translate","$session","$locale","rtlSvc","$rootScope",function(a,b,c,d,e,f,g){function h(a){return d.get(j(a))}function i(a,b){d.set(j(a),b)}function j(a){return e.id+":"+a}function k(){return angular.element("#styleLink").attr("href")}function l(a){angular.element("#styleLink").attr("href",a)}function m(a,b){var c=a+"/dist/main";return c+=b?"-rtl.css":".css"}function n(a){var b=s.find(function(b){return b.displayName===a});return b?b.value:a}function o(a){return a===k()}function p(a,c,d){d=d||function(){};var e=h(a);e?l(e):(e=m(a,c),o(e)?i(a,e):b.get(e,{tracker:"theme$get"}).success(function(){l(e),i(a,e)}).error(function(){d("Could not load theme "+a)}))}function q(){a.fetch().then(function(a){var b=a.themeName||"mpp-theme",c=n(b);p(c,f.isRtl(),function(a){console.error(a),f.isRtl()&&p(c,!1)})})}var r,s=[{displayName:"HP Simplified",value:"mpp-theme"},{displayName:"HP Playful",value:"mpp-pilot-theme"},{displayName:"HP Enterprise",value:"mpp-enterprise-theme"}];this.init=function(){r||(r=g.$on("rtl:changeSuccess",function(){q()}))}}]);var settings={DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:"3",lgSize:"3",macFrac:"0",maxFrac:"3",minFrac:"0",minInt:"1",negPre:"-",negSuf:" ",posPre:" ",posSuf:" "},{gSize:"3",lgSize:"3",macFrac:"0",maxFrac:"2",minFrac:"2",minInt:"1",negPre:"(",negSuf:")",posPre:"",posSuf:" "}]}};angular.module("mppApp").service("localeConfig",["$rootScope","$locale","$translate",function(a,b,c){this.init=function(){a.$on("$translateChangeSuccess",function(){b.setup(c),a.$broadcast("$locale:changeSuccess")})}}]).config(["$provide",function(a){function b(a,b,c){var d=a(b);return d===b?(a.loadErrors[c]=!0,!1):d}function c(a,c){a.DATETIME_FORMATS={AMPMS:[b(c,"formats.DATETIME_FORMATS.AMPMS.AM","DATETIME")||a.DATETIME_FORMATS.AMPMS[0],b(c,"formats.DATETIME_FORMATS.AMPMS.PM","DATETIME")||a.DATETIME_FORMATS.AMPMS[1]],DAY:[b(c,"formats.DATETIME_FORMATS.DAY.Sunday","DATETIME")||a.DATETIME_FORMATS.DAY[0],b(c,"formats.DATETIME_FORMATS.DAY.Monday","DATETIME")||a.DATETIME_FORMATS.DAY[1],b(c,"formats.DATETIME_FORMATS.DAY.Tuesday","DATETIME")||a.DATETIME_FORMATS.DAY[2],b(c,"formats.DATETIME_FORMATS.DAY.Wednesday","DATETIME")||a.DATETIME_FORMATS.DAY[3],b(c,"formats.DATETIME_FORMATS.DAY.Thursday","DATETIME")||a.DATETIME_FORMATS.DAY[4],b(c,"formats.DATETIME_FORMATS.DAY.Friday","DATETIME")||a.DATETIME_FORMATS.DAY[5],b(c,"formats.DATETIME_FORMATS.DAY.Saturday","DATETIME")||a.DATETIME_FORMATS.DAY[6]],MONTH:[b(c,"formats.DATETIME_FORMATS.MONTH.January","DATETIME")||a.DATETIME_FORMATS.MONTH[0],b(c,"formats.DATETIME_FORMATS.MONTH.February","DATETIME")||a.DATETIME_FORMATS.MONTH[1],b(c,"formats.DATETIME_FORMATS.MONTH.March","DATETIME")||a.DATETIME_FORMATS.MONTH[2],b(c,"formats.DATETIME_FORMATS.MONTH.April","DATETIME")||a.DATETIME_FORMATS.MONTH[3],b(c,"formats.DATETIME_FORMATS.MONTH.May","DATETIME")||a.DATETIME_FORMATS.MONTH[4],b(c,"formats.DATETIME_FORMATS.MONTH.June","DATETIME")||a.DATETIME_FORMATS.MONTH[5],b(c,"formats.DATETIME_FORMATS.MONTH.July","DATETIME")||a.DATETIME_FORMATS.MONTH[6],b(c,"formats.DATETIME_FORMATS.MONTH.August","DATETIME")||a.DATETIME_FORMATS.MONTH[7],b(c,"formats.DATETIME_FORMATS.MONTH.September","DATETIME")||a.DATETIME_FORMATS.MONTH[8],b(c,"formats.DATETIME_FORMATS.MONTH.October","DATETIME")||a.DATETIME_FORMATS.MONTH[9],b(c,"formats.DATETIME_FORMATS.MONTH.November","DATETIME")||a.DATETIME_FORMATS.MONTH[10],b(c,"formats.DATETIME_FORMATS.MONTH.December","DATETIME")||a.DATETIME_FORMATS.MONTH[11]],SHORTDAY:[b(c,"formats.DATETIME_FORMATS.SHORTDAY.Sun","DATETIME")||a.DATETIME_FORMATS.SHORTDAY[0],b(c,"formats.DATETIME_FORMATS.SHORTDAY.Mon","DATETIME")||a.DATETIME_FORMATS.SHORTDAY[1],b(c,"formats.DATETIME_FORMATS.SHORTDAY.Tue","DATETIME")||a.DATETIME_FORMATS.SHORTDAY[2],b(c,"formats.DATETIME_FORMATS.SHORTDAY.Wed","DATETIME")||a.DATETIME_FORMATS.SHORTDAY[3],b(c,"formats.DATETIME_FORMATS.SHORTDAY.Thu","DATETIME")||a.DATETIME_FORMATS.SHORTDAY[4],b(c,"formats.DATETIME_FORMATS.SHORTDAY.Fri","DATETIME")||a.DATETIME_FORMATS.SHORTDAY[5],b(c,"formats.DATETIME_FORMATS.SHORTDAY.Sat","DATETIME")||a.DATETIME_FORMATS.SHORTDAY[6]],SHORTMONTH:[b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Jan","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[0],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Feb","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[1],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Mar","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[2],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Apr","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[3],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.May","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[4],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Jun","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[5],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Jul","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[6],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Aug","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[7],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Sep","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[8],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Oct","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[9],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Nov","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[10],b(c,"formats.DATETIME_FORMATS.SHORTMONTH.Dec","DATETIME")||a.DATETIME_FORMATS.SHORTMONTH[11]],fullDate:b(c,"formats.DATETIME_FORMATS.fullDate","DATETIME")||a.DATETIME_FORMATS.fullDate,longDate:b(c,"formats.DATETIME_FORMATS.longDate","DATETIME")||a.DATETIME_FORMATS.longDate,medium:b(c,"formats.DATETIME_FORMATS.medium","DATETIME")||a.DATETIME_FORMATS.medium,mediumDate:b(c,"formats.DATETIME_FORMATS.mediumDate","DATETIME")||a.DATETIME_FORMATS.mediumDate,mediumTime:b(c,"formats.DATETIME_FORMATS.mediumTime","DATETIME")||a.DATETIME_FORMATS.mediumTime,"short":b(c,"formats.DATETIME_FORMATS.short","DATETIME")||a.DATETIME_FORMATS.short,shortDate:b(c,"formats.DATETIME_FORMATS.shortDate","DATETIME")||a.DATETIME_FORMATS.shortDate,shortTime:b(c,"formats.DATETIME_FORMATS.shortTime","DATETIME")||a.DATETIME_FORMATS.shortTime}}function d(a,c){a.NUMBER_FORMATS={CURRENCY_SYM:b(c,"formats.NUMBER_FORMATS.CURRENCY_SYM","NUMBER")||a.NUMBER_FORMATS.CURRENCY_SYM,DECIMAL_SEP:b(c,"formats.NUMBER_FORMATS.DECIMAL_SEP","NUMBER")||a.NUMBER_FORMATS.DECIMAL_SEP,GROUP_SEP:b(c,"formats.NUMBER_FORMATS.GROUP_SEP","NUMBER")||a.NUMBER_FORMATS.GROUP_SEP,PATTERNS:[{gSize:b(c,"formats.NUMBER_FORMATS.PATTERNS.1.gSize","NUMBER")||a.NUMBER_FORMATS.PATTERNS[0].gSize,lgSize:b(c,"formats.NUMBER_FORMATS.PATTERNS.1.lgSize","NUMBER")||a.NUMBER_FORMATS.PATTERNS[0].lgSize,macFrac:b(c,"formats.NUMBER_FORMATS.PATTERNS.1.macFrac","NUMBER")||a.NUMBER_FORMATS.PATTERNS[0].macFrac,maxFrac:b(c,"formats.NUMBER_FORMATS.PATTERNS.1.maxFrac","NUMBER")||a.NUMBER_FORMATS.PATTERNS[0].maxFrac,minFrac:b(c,"formats.NUMBER_FORMATS.PATTERNS.1.minFrac","NUMBER")||a.NUMBER_FORMATS.PATTERNS[0].minFrac,minInt:b(c,"formats.NUMBER_FORMATS.PATTERNS.1.minInt","NUMBER")||a.NUMBER_FORMATS.PATTERNS[0].minInt,negPre:b(c,"formats.NUMBER_FORMATS.PATTERNS.1.negPre","NUMBER")||a.NUMBER_FORMATS.PATTERNS[0].negPre,negSuf:b(c,"formats.NUMBER_FORMATS.PATTERNS.1.negSuf","NUMBER")||a.NUMBER_FORMATS.PATTERNS[0].negSuf,posPre:b(c,"formats.NUMBER_FORMATS.PATTERNS.1.posPre","NUMBER")||a.NUMBER_FORMATS.PATTERNS[0].posPre,posSuf:b(c,"formats.NUMBER_FORMATS.PATTERNS.1.posSuf","NUMBER")||a.NUMBER_FORMATS.PATTERNS[0].posSuf},{gSize:b(c,"formats.NUMBER_FORMATS.PATTERNS.2.gSize","NUMBER")||a.NUMBER_FORMATS.PATTERNS[1].gSize,lgSize:b(c,"formats.NUMBER_FORMATS.PATTERNS.2.lgSize","NUMBER")||a.NUMBER_FORMATS.PATTERNS[1].lgSize,macFrac:b(c,"formats.NUMBER_FORMATS.PATTERNS.2.macFrac","NUMBER")||a.NUMBER_FORMATS.PATTERNS[1].macFrac,maxFrac:b(c,"formats.NUMBER_FORMATS.PATTERNS.2.maxFrac","NUMBER")||a.NUMBER_FORMATS.PATTERNS[1].maxFrac,minFrac:b(c,"formats.NUMBER_FORMATS.PATTERNS.2.minFrac","NUMBER")||a.NUMBER_FORMATS.PATTERNS[1].minFrac,minInt:b(c,"formats.NUMBER_FORMATS.PATTERNS.2.minInt","NUMBER")||a.NUMBER_FORMATS.PATTERNS[1].minInt,negPre:b(c,"formats.NUMBER_FORMATS.PATTERNS.2.negPre","NUMBER")||a.NUMBER_FORMATS.PATTERNS[1].negPre,negSuf:b(c,"formats.NUMBER_FORMATS.PATTERNS.2.negSuf","NUMBER")||a.NUMBER_FORMATS.PATTERNS[1].negSuf,posPre:b(c,"formats.NUMBER_FORMATS.PATTERNS.2.posPre","NUMBER")||a.NUMBER_FORMATS.PATTERNS[1].posPre,posSuf:b(c,"formats.NUMBER_FORMATS.PATTERNS.2.posSuf","NUMBER")||a.NUMBER_FORMATS.PATTERNS[1].posSuf}]}}var e={setup:function(b){b.loadErrors={NUMBER:!1,DATETIME:!1},c(this,b),d(this,b),this.id=b.uses(),this.pluralCat=MessageFormat.locale[b.uses()],b.loadErrors.DATETIME&&console.error("There was an error loading the date time formats for your language, falling back where needed"),b.loadErrors.NUMBER&&console.error("There was an error loading the number formats for your language, falling back where needed"),a.value("$locale",settings)}};Object.merge(settings,e),a.value("$locale",settings)}]),angular.module("mppApp").service("$security",["$organization","$modal",function(a,b){this.showDisclaimer=function(){a.fetch().then(function(a){a.securityLevel&&b.securityBox([{label:"security.proceed",cssClass:"btn-primary",result:"proceed",id:"securityButton"}],a.securityLevel,a.disclaimerText).open()})}}]),angular.module("mppApp").directive("fileUpload",function(){return{scope:!0,link:function(a,b){b.bind("change",function(){for(var b=this.files,c=0;c<b.length;c++)a.$emit("fileSelected",{file:b[c]})})}}}),angular.module("mppApp").service("HelpService",[function(){var a;return{getHelpAlias:function(){return a},setHelpAlias:function(b){a=b},getCurrentHelpUrl:function(){return this.createHelpUrl(a)},createHelpUrl:function(b){b=b||a;var c="help/q/";return b&&(c+=b),c}}}]),angular.module("mppApp").directive("select",function(){return{restrict:"C",link:function(a,b){bowser.msie&&bowser.version<11&&(b.addClass("select-ie"),b.removeClass("select"))}}}),angular.module("mppApp").directive("loaderIcon",["$timeout",function(a){return{restrict:"C",link:function(b,c){var d;b.rotate=function(c,e,f,g){g=g||0,f=f||15,g+=f,c.css({"-webkit-transform":"rotate("+g+"deg)","-moz-transform":"rotate("+g+"deg)","-ms-transform":"rotate("+g+"deg)",transform:"rotate("+g+"deg)"}),d=a(function(){b.rotate(c,e,f,g)},f)},Modernizr.cssanimations?c.removeClass("ie"):(c.addClass("ie"),b.rotate(c,360)),b.$on("$destroy",function(){d&&a.cancel(d)})}}}]),angular.module("mppApp").directive("focus",["$timeout",function(a){return{link:function(b,c){var d=angular.element('<a href=""></a>');c.prepend(d),b.$watch(function(){return d.css("visibility")},function(b){"visible"===b&&a(function(){d[0].focus()},500)})}}}]).directive("focusOn",["$timeout","$parse",function(a,b){return{link:function(c,d,e){var f=b(e.focusOn);c.$watch(f,function(b){b===!0&&a(function(){d[0].focus()})}),d.bind("blur",function(){e.focusOn=!1})}}}]).directive("enforceFocus",["$document","$timeout",function(a,b){return{link:function(c,d){function e(a){var c=a.target;angular.element(d)[0]===c||angular.element(d).has(c).length||b(function(){f?f.focus():angular.element(c).blur()})}var f;b(function(){f=angular.element(d).find(":input,a")[0]}),a.off("focusin"),a.on("focusin",e),c.$on("$destroy",function(){a.off("focusin")}),b(function(){a.find(":focus").blur()})}}}]),angular.module("mppApp").directive("imgFallback",["$translate",function(a){return{restrict:"A",scope:{imgFallback:"@",imgFallbackShowMsg:"@"},link:function(b,c){c.bind("error",function(){this.onerror=null,b.imgFallback.isBlank()?c[0].outerHTML="true"===b.imgFallbackShowMsg||void 0===b.imgFallbackShowMsg?'<h3><i class="icon-alert"></i></h3><span>'+a("common.imgFailed")+"</span>":'<h3><i class="icon-alert"></i></h3>':(this.src=b.imgFallback,this.alt="Fallback Image"),b.$apply()}),b.$on("$destroy",function(){c.unbind("error")})}}}]),angular.module("mppApp").directive("placeholder",["$timeout",function(a){return{link:function(b,c,d){if("password"===d.type||Modernizr.input.placeholder)return{};var e=d.placeholder;a(function(){c.val(d.placeholder).addClass("placeholder").focus(function(){c.val()===e&&(c.val(""),c.removeClass("placeholder"))}).blur(function(){""===c.val()&&(c.val(e),c.addClass("placeholder"))})})}}}]),angular.module("mppApp").controller("WizardController",["$scope",function(){this.steps=[],this.addStep=function(a){var b=this;0===this.steps.length&&(a.thaw(),a.edit()),this.steps.push(a),a.$on("$destroy",function(){b.removeStep(a)})},this.removeStep=function(a){var b=this.steps.indexOf(a);-1!==b&&this.steps.splice(this.steps.indexOf(a),1)},this.nextStep=function(a){var b=this.steps.indexOf(a);if(b===this.steps.length-1)a.complete();else{a.complete();var c=this.steps[++b];c.thaw(),c.edit()}},this.closeCurrentStep=function(){var a=this.steps.find({opened:!0});a&&a.close()},this.resetTo=function(a,b){b=b||0;var c=this.steps.indexOf(a);b||a.resetStep(!0);for(var d=c+1;d<this.steps.length;++d)d>=c+b&&this.steps[d].resetStep(d===c+b)}}]).controller("WizardStepController",["$scope",function(a){this.addWizardPart=function(b){a.addWizardPart(b)}}]).directive("wizard",function(){return{restrict:"EA",transclude:!0,replace:!1,templateUrl:"views/directives/wizard/wizard.html",controller:"WizardController"}}).directive("wizardStep",["$animate",function(){return{restrict:"EA",require:"^wizard",transclude:!0,replace:!1,template:"<div ng-transclude></div>",controller:"WizardStepController",link:{pre:function(a,b,c,d){a.frozen=!0,a.opened=!1,a.hover=!1,a.completed=!1,a.wizardParts=[],a.updateShowHideFor=function(b){var c=Object.select(a,"frozen","opened","hover","completed");c.hover&&(c.completed=!1),b.showHidePart(c)},a.updateShowHide=function(){a.wizardParts.forEach(a.updateShowHideFor)},a.freeze=function(){a.frozen=!0,a.updateShowHide()},a.thaw=function(){a.frozen=!1,a.updateShowHide()},a.edit=function(){a.frozen||a.opened||(a.completed&&d.closeCurrentStep(),a.opened=!0,a.hover=!1,a.updateShowHide())},a.complete=function(){a.completed=!0,a.opened=!1,a.updateShowHide()},a.close=function(){a.opened=!1,a.updateShowHide()},a.resetStep=function(b){(a.completed||a.opened)&&(a.completed=!1,a.opened=b,a.frozen=!b,a.hover=!1,a.$emit("field:reset"),a.updateShowHide())},a.addWizardPart=function(b){a.wizardParts.push(b),a.updateShowHideFor(b),a.$on("$destroy",function(){a.removeWizardPart(b)})},a.removeWizardPart=function(b){var c=a.wizardParts.indexOf(b);-1!==c&&a.wizardParts.splice(c,1)},a.change=function(){d.resetTo(a,1)},a.next=function(){d.nextStep(a)},a.reset=function(){d.resetTo(a)}},post:function(a,b,c,d){d.addStep(a),b.on("mouseover",function(){a.completed&&(a.hover=!0,a.updateShowHide())}),b.on("mouseout",function(b){for(var c=b.relatedTarget;c&&c!==document.body;){if(c===b.currentTarget)return;c=c.parentElement}a.hover=!1,a.updateShowHide()}),a.updateShowHide()}}}}]).directive("showOn",["$animate",function(a){return{restrict:"A",require:"^wizardStep",scope:{},link:function(b,c,d,e){b.showOn=d.showOn.split(",").map(function(a){return a.trim()}),b.showHidePart=function(d){var e=!1;b.showOn.forEach(function(a){e=e||d[a]}),a[action=e?"removeClass":"addClass"](c,"ng-hide")},e.addWizardPart(b)}}}]),angular.module("mppApp").controller("ExpressWizardCtrl",["$scope","$q","$timeout","promiseTracker","$log",function(a){a.showDetails=!0,a.fields={},a.hashFields=function(){angular.forEach(a.model.fields,function(b){a.fields[b.id]=b})}}]).directive("expressWizard",function(){return{templateUrl:"views/directives/wizard/expressWizard.html",restrict:"E",require:["ngModel"],link:function(a,b,c,d){var e=d[0];e.$render=function(){e.$modelValue&&(a.model=e.$modelValue,a.hashFields(a.model.fields))}},controller:"ExpressWizardCtrl"}}),angular.module("mppApp").controller("wizardFieldSetCtrl",["$scope","$filter","$q","$timeout","promiseTracker","fieldWrapper",function(a,b,c,d,e,f){a.temp={},a.filter={text:""},a.updateFilter=function(){a.filter.text=a.temp.filterText},a.determineRenderingType=function(){var b=a.layout.layout[0];return"TILE"===b.displayType?"multi_option":"PROPERTY_LIST"===b.displayType?"properties":"TILE_WITH_ATTRIBUTES"===b.displayType?"option_with_attributes":void 0},a.$watch("selectedField",function(b){b||a.$broadcast("field:deselected"),a.change()}),a.$on("field:selected",function(b,c){b.stopPropagation(),a.selectedField=c,a.selectedFieldData=f(c,null),a.next()}),a.getSelectedFieldValue=function(){if(Object.isBoolean(a.selectedField.value))return a.selectedField.displayName;if(a.selectedField.availableValues){var b;return b=a.selectedField.value?a.selectedField.value:a.layout.displayName,a.selectedField.availableValues.forEach(function(c){a.selectedField.value==c.value&&(b=c.displayName)}),b}return a.selectedField.value},a.$on("field:reset",function(){a.selectedField=void 0})}]).directive("wizardFieldSet",function(){return{restrict:"EA",scope:{layout:"=model",fields:"=",index:"="},templateUrl:"views/directives/wizard/wizardFieldSet.html",link:function(a){a.renderType=a.determineRenderingType()},controller:"wizardFieldSetCtrl"}}),angular.module("mppApp").directive("wizardBlockField",function(){return{restrict:"EA",scope:{layout:"=",field:"=model",validation:"="},templateUrl:"views/directives/wizard/wizardBlockField.html",controller:"wizardCtrl"}}),angular.module("mppApp").directive("wizardAttributesField",function(){return{restrict:"EA",scope:{layout:"=",field:"=model",properties:"=subModels",validation:"=",fields:"="},templateUrl:"views/directives/wizard/wizardAttributesField.html",link:function(a){a.nameOrder=function(b){return a.fields[b.fieldId].name},a.select=function(){a.field.value=!0,a.next()}},controller:"wizardCtrl"}}),angular.module("mppApp").directive("multiOptionFieldSet",function(){return{restrict:"EA",scope:{layout:"=model",fields:"=",filterText:"="},require:"^form",templateUrl:"views/directives/wizard/multiOptionFieldSet.html",link:function(a,b,c,d){a.form=d}}}),angular.module("mppApp").directive("attributesOptionFieldSet",function(){return{restrict:"EA",scope:{layout:"=model",fields:"="},require:"^form",templateUrl:"views/directives/wizard/attributesOptionFieldSet.html",link:function(a,b,c,d){a.form=d},controller:["$scope",function(a){var b={};a.getPropertyContainersFor=function(c){if(b[c])return b[c];var d=a.layout.layout.findIndexFrom(function(a){return"FieldLayout"===a.type},c+1);return 0>d&&(d=void 0),b[c]=a.layout.layout.slice(c+1,d)}}]}}),angular.module("mppApp").directive("propertiesOptionFieldSet",function(){return{restrict:"EA",scope:{layout:"=model",fields:"="},require:"^form",templateUrl:"views/directives/wizard/propertiesOptionFieldSet.html",link:function(a,b,c,d){a.form=d},controller:["$scope","$filter",function(a,b){a.next=function(){var c=b("filter")(a.layout.layout,{type:"FieldSetLayout"})[0],d=b("filter")(c.layout,function(b){return"FieldLayout"===b.type&&!a.fields[b.fieldId].hidden})[0];a.$emit("field:selected",a.fields[d.fieldId])}}]}}),angular.module("mppApp").controller("wizardCtrl",["$scope","fieldWrapper","$timeout",function(a,b){var c=b(a.field,a.layout);Object.merge(a,c,!0,!1),a.$on("field:deselected",function(){a.field.value=!1}),a.next=function(){a.$emit("field:selected",a.field)},a.hasPricing=function(a){return!!a.initPrice.price||!!a.recurringPrice.price}}]),angular.module("mppApp").factory("fieldWrapper",["pricingCalculatorSvc","$filter",function(a,b){return function(c,d){return{name:function(){return c.name},visible:function(){return c.visible},required:function(){return this.isBoolean()||this.isRadio()?!1:c.required},pattern:new RegExp(c.pattern&&!Object.isRegExp(c.pattern)?c.pattern:""),min:function(){return c.minValue},max:function(){return c.maxValue},isInteger:function(){return"INTEGER"===d.displayType},isText:function(){return"TEXT"===d.displayType},isTextArea:function(){return"TEXTAREA"===d.displayType},isConfidential:function(){return"CONFIDENTIAL"===d.displayType},isString:function(){return this.isText()||this.isConfidential()||this.isTextArea()},isList:function(){return"LIST"===d.displayType},isMultiList:function(){return"MULTILIST"===d.displayType},isBoolean:function(){return"BOOLEAN"===d.displayType},isRadio:function(){return"RADIO"===d.displayType},isTile:function(){return"TILE"===d.displayType},isTileWithAttributes:function(){return"TILE_WITH_ATTRIBUTES"===d.displayType},isDateTime:function(){return"DATETIME"===d.displayType},isDate:function(){return"DATE"===d.displayType},isTime:function(){return"TIME"===d.displayType},isDateIsh:function(){return this.isDate()||this.isTime()||this.isDateTime()},getValidationData:function(){return{min:c.minValue,max:c.maxValue,pattern:c.pattern,minDate:b("date")(c.minValue,"short"),maxDate:b("date")(c.maxValue,"short")}},getValidationMessageKey:function(){if(c.validationType||c.pattern)switch(c.validationType){case"EMAIL_VALUE_CONSTRAINT":return"email";case"URL_VALUE_CONSTRAINT":return"url";case"NON_NUMERIC_VALUE_CONSTRAINT":return"nonNumeric";case"IP_VERSION_4":return"ipv4";case"IP_VERSION_6":return"ipv6";case"URL_VALUE_CONSTRAINT":return"email";default:return"patternField"}},hasPricing:function(){return a.hasPrice(c.initPrice)&&a.hasPrice(c.recurringPrice)}}}}]),angular.module("mppApp").factory("toggleSvc",["$session",function(a){function b(b,c){this.key=b,this.state=a.get(b),null===this.state&&(this.state=c,a.set(b,this.state))}return b.prototype.flick=function(){this.state=!this.state,this.key&&a.set(this.key,this.state)},function(a,c){return new b(a,void 0!==c?c:!0)}}]),angular.module("mppApp").directive("securityBanner",function(){return{templateUrl:"views/directives/securityBanner.html",restrict:"E",replace:!0,scope:!0,controller:["$scope","$organization",function(a,b){b.fetch().then(function(b){a.org=b})}]}}),angular.module("mppApp").controller("HomeCtrl",["$scope","$organization","$user","$location","userSvc",function(a,b,c,d,e){c.fetch().then(function(b){b&&b.name?e.get({},function(b){b&&b.name?a.user=b:d.url("/expired")}):a.user=null}),b.fetch().then(function(b){a.org=b},function(){d.url("/error/unavailable")})}]),angular.module("mppApp").directive("parentForm",function(){return{require:"form",link:function(a,b,c,d){a.$watch("dirty",function(a){1>a&&d.$setPristine()})},controller:["$scope",function(a){a.dirty=0,a.isDirty=function(){return a.dirty>0};var b=[];return{addChild:function(c){b.push(c),a.$watch(function(){return c.dirty},function(b,c){b!==c&&(b?a.dirty++:a.dirty--)})}}}]}}),angular.module("mppApp").directive("childForm",function(){return{scope:!0,require:["^parentForm","form"],link:function(a,b,c,d){a.dirty=!1;var e=d[0],f=d[1];e.addChild(a),a.$watch(function(){return f.$dirty},function(b){a.dirty=b})}}}),angular.module("mppApp").service("rtlSvc",["$translate","$rootScope",function(a,b){function c(){var c=a("rtl"),e=c&&"rtl"!==c?"true"===c:!1;e!==d&&(d=e,b.$broadcast("rtl:changeSuccess"))}var d;this.init=function(){b.$on("$translateChangeSuccess",function(){c()})},this.isRtl=function(){return d||!1}}]),angular.module("mppApp").directive("mppDir",["rtlSvc",function(a){return{restrict:"A",link:function(b,c){function d(a){return a?"rtl":"ltr"}b.$on("rtl:changeSuccess",function(){var b=a.isRtl();c.attr("dir",d(b))})}}}]),angular.module("mppApp").directive("ngHotkeys",[function(){var a=function(a,b){return void 0===b?!1:""===b?!0:a.$eval(b)};return{restrict:"A",link:function(b,c,d){var e,f=d.ngHotkeys;if(f){f=f.split("|");var g=function(a){return function(){c.trigger(a)}};a(b,d.ngHotkeysClick)&&(e=g("click")),e&&f.forEach(function(a){Mousetrap.bind(a,e),b.$on("$destroy",function(){Mousetrap.unbind(a)})})}}}}]),angular.module("mppApp").factory("about",["$modal",function(a){return{show:function(){a.open({templateUrl:"views/common/dialog/about.html",controller:"AboutDialogCtrl"})}}}]).controller("AboutDialogCtrl",["$scope","$modalInstance","versionSvc",function(a,b,c){a.close=function(){b.dismiss()},a.serverInfo=c.server(),a.uiInfo=c.ui()}]),angular.module("mppApp").factory("versionSvc",["$resource",function(a){return a("api/versioninfo",{},{server:{method:"GET",tracker:"versioninfo$get"},ui:{method:"GET",url:"versioninfo.json",tracker:"versioninfo$get",transformResponse:function(a){try{a=angular.fromJson(a)}catch(b){a={version:"unknown"}}return a}}})}]),angular.module("mppApp").directive("carouselScroll",function(){return{templateUrl:"views/directives/carouselScroll.html",restrict:"E",replace:!0,transclude:!0,link:function(a,b){function c(){var a=0;e=d.children().filter(":visible"),angular.forEach(e,function(b){a+=angular.element(b).outerWidth(!0)}),d.css("width",a)}var d,e;d=b.find(".horizontal-scrollbox-row"),a.$watch(function(){return d.children().filter(":visible").length
},function(){c()})}}}),angular.module("mppApp").filter("wizardTileFilter",["$filter",function(a){return function(b,c,d){return a("filter")(b,function(a){var b=d[a.fieldId];return b.displayName.toLowerCase().has(c.toLowerCase())})}}]),angular.module("mppApp").service("styleSvc",[function(){return{getBackgroundImage:function(a){return a?{"background-image":"url('"+a+"')"}:{}}}}]),angular.module("mppApp").service("utilSvc",[function(){var a=0;return{uniqueId:function(b){var c=++a+"";return b?b+c:c}}}]),angular.module("mppApp").controller("mppBanner",["$scope","$session","styleSvc",function(a,b,c){a.bgImage=c.getBackgroundImage(a.bgUrl)}]).directive("mppBanner",function(){return{restrict:"EA",transclude:!0,scope:{toggle:"=",bgClassName:"@",bgUrl:"@",id:"@"},templateUrl:"views/common/mppBanner.html",controller:"mppBanner"}}),angular.module("mppApp").controller("mppSection",["$scope","$session","translateSvc","toggleSvc",function(a,b,c,d){a.toggle=d(a.data._id,!0),a.tryKeyOrLabel=c.tryKeyOrLabel}]).directive("mppSection",function(){return{restrict:"EA",transclude:!0,scope:{data:"=",last:"@"},templateUrl:"views/common/mppSection.html",controller:"mppSection"}}),angular.module("mppApp").controller("mppTile",["$scope","$session","$http","styleSvc",function(a,b,c,d){var e,f;a.$watch(function(){return a.data.count},function(){a.data.count&&(e=a.data._id,f=b.get(e),a.data._count=f?f._count:0,c({method:"GET",url:a.data.count.url||a.data.count}).success(function(c){a.data._count=Object.has(c,"count")?c.count:0,b.set(e,a.data)}).error(function(){console.error("Unable to fetch count for",a.data.label)}))}),a.background=d.getBackgroundImage(a.data.backgroundImage)}]).directive("mppTile",function(){return{restrict:"EA",transclude:!0,scope:{data:"="},templateUrl:"views/common/mppTile.html",controller:"mppTile"}}),angular.module("mppApp").controller("mppSimpleList",["$scope","translateSvc","toggleSvc",function(a,b,c){a.toggle=c(a.id,!0),a.getLink=function(b){return a.link?a.link.assign(b):null}}]).directive("mppSimpleList",function(){return{restrict:"EA",transclude:!0,scope:{data:"=",title:"@",id:"@",field:"@",link:"@"},templateUrl:"views/directives/mppSimpleList.html",controller:"mppSimpleList"}}),angular.module("mppApp").directive("mppTerm",["$translate","$filter",function(a,b){return{templateUrl:"views/directives/mppTerm.html",restrict:"E",scope:{endDate:"=",altEnd:"@",startDate:"=",altStart:"@",format:"@"},link:function(c){c.getTerm=function(){var d={};return d.start=c.startDate?b("date")(c.startDate,c.format||"mediumDate"):a(c.altStart||"common.noStartDate"),d.end=c.endDate?b("date")(c.endDate,c.format||"mediumDate"):a(c.altEnd||"common.noEndDate"),a("common.term",d)}}}}]),angular.module("mppApp").directive("switch",function(){return{templateUrl:"views/directives/switch.html",restrict:"E",scope:{ngModel:"=ngModel"},link:function(a,b){b.bind("keydown keypress",function(b){(37===b.which||39===b.which)&&a.$apply(function(){a.ngModel=!a.ngModel})})}}}),angular.module("mppApp").directive("jsDateFix",["compilePriorities",function(a){return{restrict:"A",require:"^ngModel",priority:a.high,link:function(a,b,c,d){function e(a){if(a){if(angular.isDate(a)&&!isNaN(a))return a;if(angular.isString(a)){var b=Date.create(a);return isNaN(b)?void 0:b}return void 0}return null}d.$parsers.unshift(e)}}}]),angular.module("mppApp").directive("dateRange",function(){return{require:"ngModel",link:function(a,b,c,d){var e=a.$parent.$eval(c.min,a),f=a.$parent.$eval(c.max,a);e&&(e=Date.create(e).beginningOfDay()),f&&(f=Date.create(f).beginningOfDay());var g=function(a){if(a){var b=Date.create(a).beginningOfDay();e&&d.$setValidity("minDate",!e.isAfter(b)),f&&d.$setValidity("maxDate",!f.isBefore(b))}return a};d.$parsers.unshift(g),d.$formatters.unshift(g)}}}),angular.module("mppApp").directive("timeRange",function(){function a(a,b){return Date.create(a).beginningOfDay().advance({minutes:Date.create(b).minutesSince(Date.create(b).beginningOfDay())})}return{require:"ngModel",link:function(b,c,d,e){var f=b.$parent.$eval(d.min,b),g=b.$parent.$eval(d.max,b);f&&(f=a(f,f)),g&&(g=a(g,g));var h=function(b){if(b){var c;f&&(c=a(f,b),e.$setValidity("minTime",!f.isAfter(c))),g&&(c=a(g,b),e.$setValidity("maxTime",!g.isBefore(c)))}return b};e.$parsers.unshift(h),e.$formatters.unshift(h)}}}),angular.module("mppApp").directive("dateTimeRange",function(){return{require:"ngModel",link:function(a,b,c,d){var e=a.$parent.$eval(c.min,a),f=a.$parent.$eval(c.max,a);e&&(e=Date.create(e).reset("seconds")),f&&(f=Date.create(f).reset("seconds"));var g=function(a){if(a){var b=Date.create(a).reset("seconds");e&&d.$setValidity("minDateTime",!e.isAfter(b)),f&&d.$setValidity("maxDateTime",!f.isBefore(b))}return a};d.$parsers.unshift(g),d.$formatters.unshift(g)}}});