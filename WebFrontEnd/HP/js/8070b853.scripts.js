"use strict";angular.module("mppUI",["ui.bootstrap","ui.utils","mppInfiniteScroll"]).run(["$modal",function(a){a.messageBox=function(b,c,d,e){var f={templateUrl:"views/common/dialog/message.html",controller:"MessageBoxCtrl",resolve:{model:function(){return{title:b,message:c,buttons:d}}}};return"object"==typeof e&&Object.merge(f,e),{open:a.open.fill(f)}},a.ListActionsMessageBox=function(b,c,d,e,f){var g={templateUrl:"views/common/dialog/listActionsMessage.html",controller:"ListActionsMessageBoxCtrl",resolve:{model:function(){return{title:b,message:c,buttons:f,type:d,num:e}}}};return{open:a.open.fill(g)}},a.ListActionsBox=function(b,c,d,e){var f={templateUrl:"views/common/dialog/listActions.html",controller:"ListActionsBoxCtrl",resolve:{model:function(){return{type:b,title:c,message:d,actions:e}}}};return{open:a.open.fill(f)}},a.commentBox=function(b,c,d,e,f,g){var h={templateUrl:"views/common/dialog/comment.html",controller:"CommentBoxCtrl",resolve:{model:function(){return{title:b,message:c,buttons:d,placeholder:e,error:f,maxChars:g}}}};return{open:a.open.fill(h)}},a.securityBox=function(b,c,d){var e={templateUrl:"views/common/dialog/securityModal.html",controller:"SecurityBoxCtrl",resolve:{model:function(){return{buttons:b,securityLevel:c,disclaimerText:d}}}};return{open:a.open.fill(e)}},a.imageCarousel=function(b,c){var d=a.open({templateUrl:"views/common/dialog/imageCarousel.html",controller:"ImageCarouselCtrl",resolve:{images:function(){return b},index:function(){return c}}});return d}}]),function(){function a(a){return{request:function(b){return a.when(b)},response:function(b){return a.when(b)},responseError:function(b){return console.error(b.status+" Error: ",b),0===b.status&&(b.data={messageKey:"UI.NoResponse"}),a.reject(b)}}}angular.module("globalErrorHandler",[]),angular.module("globalErrorHandler").config(["$httpProvider",function(b){b.interceptors&&b.interceptors.push(a)}]),a.$inject=["$q"]}(),angular.module("mppInfiniteScroll",[]).directive("infiniteScroll",["$rootScope","$window","$timeout",function(a,b,c){return{link:function(d,e,f){var g,h,i,j,k,l;return k=f.infiniteScrollContainerElementId?document.getElementById(f.infiniteScrollContainerElementId):b,i=0,void 0!==f.infiniteScrollDistance&&d.$watch(f.infiniteScrollDistance,function(a){return i=0>a||!a?0:a}),j=!0,g=!1,void 0!==f.infiniteScrollDisabled&&d.$watch(f.infiniteScrollDisabled,function(a){return j=!a,j&&g?(g=!1,h()):void 0}),h=function(){var c,h,k,l,m;return m=e[0],l=b.innerHeight+(b.scrollY||b.document.documentElement.scrollTop||b.document.body.scrollTop),c=m.getBoundingClientRect().top+m.offsetHeight,h=c-l,k=h<=b.innerHeight*i+1,k&&j?a.$$phase?d.$eval(f.infiniteScroll):d.$apply(f.infiniteScroll):k?g=!0:void 0},k.addEventListener?k.addEventListener("scroll",h,!1):k.attachEvent("onscroll",h),d.$on("$destroy",function(){k.removeEventListener?k.removeEventListener("scroll",h,!1):k.detachEvent("onscroll",h)}),l=function(){return f.infiniteScrollImmediateCheck?d.$eval(f.infiniteScrollImmediateCheck)?h():void 0:h()},c(l,0)}}}]),angular.module("dforms.iterator",[]),angular.module("dforms.iterator").directive("dfIterator",["$compile",function(a){return{restrict:"E",require:"ngModel",scope:{renderer:"=?"},link:function(b,c,d,e){b.$watch(function(){return e.$modelValue},function(){if(e.$modelValue){angular.forEach(e.$modelValue.fields,function(a){b[a.id]=a});var d=b.layouts=e.$modelValue.layout;d&&d.length>0&&(d.each(function(a,b){c.append("FieldSetLayout"===a.type?'<df-iterator-field-set model="layouts['+b+']"></df-iterator-field-set>':'<df-iterator-field model="layouts['+b+']"></df-iterator-field>')}),a(c.contents())(b))}})},controller:["$scope",function(a){return{getField:function(b){return a[b]},getFieldTemplate:function(b){return a.renderer.getFieldTemplate(b)},getFieldSetTemplate:function(b){return a.renderer.getFieldSetTemplate(b)}}}]}}]).directive("dfIteratorFieldSet",["$compile",function(a){return{restrict:"E",require:"^dfIterator",scope:{layout:"=model"},link:function(b,c,d,e){var f=angular.element(e.getFieldSetTemplate(b.layout.displayType||b.layout.displayClass)).appendTo(c),g=b.layout.layout;g&&g.length>0&&(g.each(function(a,b){f.append("FieldSetLayout"===a.type?'<df-iterator-field-set model="layout.layout['+b+']"></df-iterator-field-set>':'<df-iterator-field model="layout.layout['+b+']"></df-iterator-field>')}),a(c.contents())(b))}}}]).directive("dfIteratorField",["$compile",function(a){return{restrict:"E",require:"^dfIterator",scope:{layout:"=model"},link:function(b,c,d,e){b.field=e.getField(b.layout.fieldId),c.append(e.getFieldTemplate(b.layout.displayType)),a(c.contents())(b)}}}]),angular.module("dforms.summary",[]).factory("dforms.summary.valueSeparator",["$translate",function(a){return a("request.detail.checkout.optionValueSeparator")}]).factory("dforms.summary.localizer",["$translate",function(a){return function(b){return a("request.detail.checkout.optionValue",b)}}]),angular.module("dforms.summary").controller("dfFieldSetSummary",["$scope",function(a){a.layout.visible=!1,a.layout.hidden=!1,a.$watch(function(){return a.layout.layout?!!a.layout.layout.find(function(b){return b.fieldId?a.ctrl.getField([b.fieldId]).visible:b.visible}):!1},function(b){a.layout.visible=b},!0),a.$watch(function(){return a.layout.layout?a.layout.layout.all(function(b){return b.fieldId?a.ctrl.getField([b.fieldId]).hidden:b.hidden}):!1},function(b){a.layout.hidden=b},!0)}]).directive("dfFieldSetSummary",function(){return{template:'<div class="field-set" ng-if="layout.visible && !layout.hidden"><small class="text-info">{{layout.displayName}}</small><div ng-transclude></div><hr></div>',transclude:!0,require:"^dfIterator",restrict:"E",scope:{layout:"="},link:function(a,b,c,d){a.ctrl=d},controller:"dfFieldSetSummary"}}).directive("dfFieldSummary",function(){return{template:'<div ng-if="field.visible && !field.hidden && field.value"><span>{{field.displayName}}</span></div>',restrict:"E",scope:{field:"=",layout:"="}}}).directive("dfTextFieldSummary",function(){return{template:'<div ng-if="field.visible && !field.hidden && field.value"><span>{{ field | dfSummaryFieldFilter:layout.displayType }}</span></div>',restrict:"E",scope:{field:"=",layout:"="}}}).directive("dfDateFieldSummary",function(){return{template:'<div ng-if="field.visible && !field.hidden && hasValue()"><span>{{ field | dfSummaryFieldFilter:layout.displayType }}</span></div>',restrict:"E",scope:{field:"=",layout:"="},controller:["$scope",function(a){a.hasValue=function(){return Object.isDate(a.field.value)&&!isNaN(a.field.value)||!isNaN(Date.create(a.field.value))}}]}}).directive("dfNumberFieldSummary",function(){return{template:'<div ng-if="field.visible && !field.hidden && hasValue()"><span>{{ field | dfSummaryFieldFilter:layout.displayType }}</span></div>',restrict:"E",scope:{field:"=",layout:"="},controller:["$scope",function(a){a.hasValue=function(){return Object.isNumber(a.field.value)&&!isNaN(a.field.value)}}]}}).directive("dfListFieldSummary",function(){return{template:'<div ng-if="field.visible && !field.hidden && hasValue()"><span>{{ field | dfSummaryFieldFilter:layout.displayType }}</span><hr></div>',restrict:"E",scope:{field:"=",layout:"="},controller:["$scope",function(a){a.hasValue=function(){return Object.isArray(a.field.value)&&a.field.value.length||a.field.value}}]}}),angular.module("dforms.summary").factory("dfSummaryRenderer",[function(){return{getFieldTemplate:function(a){switch(a){case"TEXT":case"CONFIDENTIAL":return'<df-text-field-summary field="field" layout="layout"></df-text-field-summary>';case"DATE":case"TIME":case"DATETIME":return'<df-date-field-summary field="field" layout="layout"></df-date-field-summary>';case"INTEGER":return'<df-number-field-summary field="field" layout="layout"></df-number-field-summary>';case"LIST":case"MULTILIST":return'<df-list-field-summary field="field" layout="layout"></df-list-field-summary>';default:return'<df-field-summary field="field" layout="layout"></df-field-summary>'}},getFieldSetTemplate:function(){return'<df-field-set-summary layout="layout"></df-field-set-summary>'}}}]),angular.module("dforms.summary").filter("dfSummaryFieldFilter",["$filter","dforms.summary.valueSeparator","dforms.summary.localizer",function(a,b,c){return function(d,e){var f;if(d.confidential)f=a("confidential")(d.value);else if(d.availableValues){var g={};if(d.availableValues.forEach(function(a){g[a.value]=a.displayName}),Object.isArray(d.value)){var h=[];d.value.forEach(function(a){h.push(g[a])}),f=h.join(b)}else f=g[d.value]}else f="DATETIME"===e?a("date")(d.value,"short"):"DATE"===e?a("date")(d.value,"shortDate"):"TIME"===e?a("date")(d.value,"shortTime"):d.value;return c({displayName:d.displayName,value:f})}}]),angular.module("mppApp",["ngRoute","ngResource","ngCookies","ngSanitize","mppUI","ajoslin.promise-tracker","globalErrorHandler","pascalprecht.translate","dibari.angular-ellipsis","currencyFilter","dforms.iterator","dforms.summary"]).constant("compilePriorities",{hack:500,high:300,mid:200,low:100}).service("$flash",["$rootScope",function(a){this.show=function(b){a.flash=b},this.clear=function(){a.flash=""}}]).factory("$session",function(){return{get:function(a){return angular.fromJson(sessionStorage.getItem(a))},set:function(a,b){return sessionStorage.setItem(a,angular.toJson(b))},unset:function(a){return sessionStorage.removeItem(a)},clear:function(){return sessionStorage.clear()}}}).service("SessionMgmtService",["$session",function(a){this.cleanup=function(){a.clear()}}]).factory("AuthenticationHttpInterceptor",["$q","$session","$location",function(a,b,c){return{responseError:function(b){return 401!==b.status?a.reject(b):void c.path("/expired")}}}]).factory("NullUserOnErrorInterceptor",["$q","$session","$location",function(a){return{responseError:function(b){return b.config.url.match("api/user")?(b.data=null,b):a.reject(b)}}}]).factory("IgnoreUnauthorizedCart",["$q","$session","$location",function(a){return{responseError:function(b){return b.config.url.match("api/cart")&&401===b.status?b:a.reject(b)}}}]).config(["$httpProvider",function(a){a.interceptors.push("AuthenticationHttpInterceptor"),a.interceptors.push("NullUserOnErrorInterceptor"),a.interceptors.push("IgnoreUnauthorizedCart")}]).run(["$rootScope",function(a){a.encodeURIComponent=function(a){return encodeURIComponent(a)}}]).run(["$session",function(a){a.get("user")&&!Object.size(a.get("user"))&&a.clear()}]).run(["cart",function(a){a.getCart()}]).run(["$rootScope","$location","$route","$organization",function(a,b,c,d){a.$on("$routeChangeSuccess",function(e,f){var g,h;f.originalPath&&("/"===f.originalPath||f.originalPath.match("/org/"))?(h=a.$on("$locationChangeSuccess",function(a,b){b.match("/org/")&&(c.current=g),h()}),d.fetch().then(function(a){a.name!==f.params.name&&b.path("/org/"+encodeURIComponent(a.name)).replace()})):f.originalPath.match("/org/")&&f.params.name&&(h=a.$on("$locationChangeSuccess",function(a,b){b.match("/org/")&&(c.current=g),h()}),d.fetch().then(function(a){a.name!==f.params.name&&(console.log("redirecting"),b.path("/org/"+encodeURIComponent(a.name)).replace())}))})}]).run(["$rootScope","$translate",function(a,b){a.$on("$routeChangeSuccess",function(c,d){if(b(d.title)===d.title)var e=a.$on("$translateChangeSuccess",function(){e(),document.title=b(d.title)});else document.title=b(d.title)})}]).run(["$rootScope","$translate","HelpService",function(a,b,c){a.$on("$routeChangeSuccess",function(a,b){c.setHelpAlias(b.helpAlias?b.helpAlias:null)})}]).config(["$routeProvider","$locationProvider",function(a,b){b.html5Mode(!0),a.when("/",{title:"home.title",templateUrl:"views/home.html",controller:"HomeCtrl",helpAlias:"dashboard"}).when("/org/:name",{title:"home.title",templateUrl:"views/home.html",controller:"HomeCtrl",helpAlias:"dashboard"}).when("/shop",{title:"shop.title",templateUrl:"views/dashboard/shop.html",controller:"ShopCtrl",helpAlias:"shop_dashboard"}).when("/approval",{title:"approvals.list.title",templateUrl:"views/approval/list.html",controller:"ApprovalListCtrl",reloadOnSearch:!1,helpAlias:"review_requests"}).when("/approval/:id",{title:"approvals.detail.title",templateUrl:"views/approval/detail.html",controller:"ApprovalDetailCtrl",helpAlias:"review_requests"}).when("/subscription",{title:"subscription.title",templateUrl:"views/subscription/list.html",controller:"SubscriptionListCtrl",reloadOnSearch:!1,helpAlias:"subscriptions"}).when("/subscription/:id",{title:"subscription.detail.title",templateUrl:"views/subscription/detail.html",controller:"SubscriptionDetailCtrl",helpAlias:"subscriptions"}).when("/subscription/:id/modify",{title:"subscription.modify.title",templateUrl:"views/subscription/modify.html",controller:"ModifySubscriptionCtrl",helpAlias:"subscriptions"}).when("/service",{title:"services.title",templateUrl:"views/service/list.html",controller:"ServiceListCtrl",reloadOnSearch:!1,helpAlias:"browse_catalog"}).when("/catalog/:catalogId/category/:category/service/:id",{title:"services.detail.title",templateUrl:"views/service/item.html",controller:"ServiceDetailCtrl",helpAlias:"browse_catalog"}).when("/request",{title:"request.count",templateUrl:"views/request/list.html",controller:"requestCtrl",reloadOnSearch:!1,helpAlias:"requests"}).when("/request/:id",{title:"request.detail.title",templateUrl:"views/request/detail.html",controller:"RequestDetailCtrl",helpAlias:"requests"}).when("/featuredServices/new_releases",{title:"services.NEW_RELEASES",templateUrl:"views/service/featured-list.html",controller:"SpecialCategoryCtrl",reloadOnSearch:!1,helpAlias:"browse_catalog"}).when("/featuredServices/most_requested",{title:"services.MOST_REQUESTED",templateUrl:"views/service/featured-list.html",controller:"SpecialCategoryCtrl",reloadOnSearch:!1,helpAlias:"browse_catalog"}).when("/featuredSubscriptions/expiring_soon",{title:"subscription.EXPIRING_SOON",templateUrl:"views/subscription/featured-list.html",controller:"SpecialCategoryCtrl",reloadOnSearch:!1,helpAlias:"browse_catalog"}).when("/myservice",{title:"myservice.list.title",templateUrl:"views/myservice/list.html",controller:"MyServiceListCtrl",reloadOnSearch:!1,helpAlias:"my_services"}).when("/myservice/:id/catalog/:catalogId",{title:"myservice.detail.title",templateUrl:"views/myservice/detail.html",controller:"MyServiceDetailCtrl",helpAlias:"my_services"}).when("/notification",{title:"notification.list.title",templateUrl:"views/notification/list.html",controller:"NotificationListCtrl",reloadOnSearch:!1,helpAlias:"notifications"}).when("/notification/:id",{title:"notification.list.title",templateUrl:"views/notification/detail.html",controller:"NotificationDetailCtrl",helpAlias:"notifications"}).when("/wizard/:id",{title:"wizard.title",templateUrl:"views/wizard/detail.html",controller:"WizardCtrl",helpAlias:"mpp_intro"}).when("/cart",{title:"cart.title",templateUrl:"views/cart/cart.html",controller:"CartCtrl",helpAlias:"shopping_cart"}).when("/cart/item/:id",{title:"cart.detail.title",templateUrl:"views/cart/item-detail.html",controller:"CartItemCtrl",helpAlias:"shopping_cart"}).when("/expired",{title:"logout.title",templateUrl:"views/expired.html",controller:"ExpiredCtrl",helpAlias:"mpp_intro"}).when("/404",{title:"404.title",templateUrl:"views/404.html",controller:"NavigationCtrl",helpAlias:"mpp_intro"}).when("/error/unavailable",{templateUrl:"views/error/unavailable.html",title:"serviceUnavailable.title"}).when("/error/unauthorized",{templateUrl:"views/error/unauthorized.html",title:"accessDenied.title"}).when("/error/404",{templateUrl:"views/error/404nosession.html",title:"404.title"}).otherwise({redirectTo:"/404"})}]).config(["$translateProvider",function(a){a.useStaticFilesLoader({prefix:"locales/",suffix:"/rb.json"}),a.addInterpolation("$translateMessageFormatInterpolation"),a.fallbackLanguage("en")}]).run(["themeSvc","rtlSvc","localeConfig",function(a,b,c){a.init(),b.init(),c.init()}]).run(["$translate","$cookies","$rootScope",function(a,b,c){var d=b.LOCALE;c.$on("$translateChangeError",function(){d.indexOf("-")>0?(d=d.split("-")[0],a.uses(d)):a.fallbackLanguage()!==d?a.uses(a.fallbackLanguage()):console.error("Could not load default locale")}),a.uses(d),c.$on("$translateChangeSuccess",function(){MessageFormat.locale[a.uses()]=function(a){return 1===a?"one":"other"}})}]).run(["$rootScope",function(a){$(window).load(function(){a.loaded=!0})}]);